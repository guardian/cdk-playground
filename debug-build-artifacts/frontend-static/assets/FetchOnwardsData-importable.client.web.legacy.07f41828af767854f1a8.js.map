{"version":3,"file":"FetchOnwardsData-importable.client.web.legacy.07f41828af767854f1a8.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/components/FetchOnwardsData.importable.tsx","webpack://@guardian/dotcom-rendering/./src/components/Placeholder.tsx","webpack://@guardian/dotcom-rendering/./src/lib/decideTrail.ts","webpack://@guardian/dotcom-rendering/./src/lib/getDataLinkName.ts"],"sourcesContent":["import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { isNonNullable } from '@guardian/libs';\nimport { ArticleDesign } from '../lib/articleFormat';\nimport { decideTrail } from '../lib/decideTrail';\nimport { useApi } from '../lib/useApi';\nimport { addDiscussionIds } from '../lib/useCommentCount';\nimport { palette } from '../palette';\nimport { Carousel } from './Carousel.importable';\nimport { Placeholder } from './Placeholder';\nconst minHeight = css `\n\tmin-height: 300px;\n`;\nexport const FetchOnwardsData = ({ url, limit, onwardsSource, format, discussionApiUrl, absoluteServerTimes, }) => {\n    const { data, error } = useApi(url);\n    const buildTrails = (trails, trailLimit) => {\n        return trails.slice(0, trailLimit).map(decideTrail);\n    };\n    if (error) {\n        // Send the error to Sentry and then prevent the element from rendering\n        window.guardian.modules.sentry.reportError(error, 'onwards-lower');\n        return null;\n    }\n    if (!data?.trails) {\n        return (_jsx(Placeholder, { height: 340, shouldShimmer: false, backgroundColor: palette('--article-background') }));\n    }\n    addDiscussionIds(data.trails\n        .map((trail) => trail.discussion?.discussionId)\n        .filter(isNonNullable));\n    return (_jsx(\"div\", { css: minHeight, children: _jsx(Carousel, { heading: data.heading || data.displayname, trails: buildTrails(data.trails, limit), description: data.description, onwardsSource: onwardsSource, format: format, leftColSize: format.design === ArticleDesign.LiveBlog ||\n                format.design === ArticleDesign.DeadBlog\n                ? 'wide'\n                : 'compact', discussionApiUrl: discussionApiUrl, absoluteServerTimes: absoluteServerTimes }) }));\n};\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css, keyframes } from '@emotion/react';\nimport { isUndefined } from '@guardian/libs';\nimport { palette, space } from '@guardian/source/foundations';\nconst BACKGROUND_COLOUR = palette.neutral[93];\nconst shimmer = keyframes `\n  0% {\n    background-position: -1500px 0;\n  }\n  100% {\n    background-position: 1500px 0;\n  }\n`;\nconst shimmerStyles = (backgroundColor) => css `\n\tanimation: ${shimmer} 2s infinite linear;\n\tbackground: linear-gradient(\n\t\tto right,\n\t\t${backgroundColor} 4%,\n\t\twhite 25%,\n\t\t${backgroundColor} 36%\n\t);\n\tbackground-size: 1500px 100%;\n`;\nexport const Placeholder = ({ height, rootId, width, spaceBelow, spaceLeft, shouldShimmer = true, backgroundColor = BACKGROUND_COLOUR, }) => (_jsx(\"div\", { id: rootId, css: css `\n\t\t\tflex-grow: 1;\n\t\t`, \"data-name\": \"placeholder\", children: _jsx(\"div\", { css: css `\n\t\t\t\tmin-height: ${height}px;\n\t\t\t\twidth: ${!isUndefined(width) ? `${width}px` : '100%'};\n\t\t\t\tmargin-bottom: ${spaceBelow && space[spaceBelow]}px;\n\t\t\t\tmargin-left: ${spaceLeft && space[spaceLeft]}px;\n\t\t\t\tbackground-color: ${backgroundColor};\n\n\t\t\t\t${shouldShimmer && shimmerStyles(backgroundColor)}\n\t\t\t` }) }));\n","import { decideFormat } from './articleFormat';\nimport { getDataLinkNameCard } from './getDataLinkName';\nexport const decideTrail = (trail, index = 0) => {\n    const format = decideFormat(trail.format);\n    const image = trail.image\n        ? {\n            src: trail.image,\n            altText: '', // TODO: Do we get this from frontend?\n        }\n        : undefined;\n    return {\n        ...trail,\n        image,\n        format,\n        dataLinkName: getDataLinkNameCard(format, '0', index),\n    };\n};\n","import { ArticleDesign, ArticleSpecial, } from './articleFormat';\n/**\n * TODO: missing \"podcast\"\n */\nconst getLinkType = ({ theme, design }, cardStyle) => {\n    if (cardStyle === 'ExternalLink')\n        return 'external';\n    if (cardStyle === 'Feature')\n        return 'feature';\n    switch (theme) {\n        case ArticleSpecial.SpecialReport:\n            return 'special-report';\n        default:\n            switch (design) {\n                case ArticleDesign.Analysis:\n                    return 'analysis';\n                case ArticleDesign.LiveBlog:\n                    return 'live';\n                case ArticleDesign.DeadBlog:\n                    return 'dead';\n                case ArticleDesign.Feature:\n                    return 'feature';\n                case ArticleDesign.Editorial:\n                    return 'editorial';\n                case ArticleDesign.Comment:\n                    return 'comment';\n                case ArticleDesign.Gallery:\n                case ArticleDesign.Audio:\n                case ArticleDesign.Video:\n                    return 'media';\n                case ArticleDesign.Review:\n                    return 'review';\n                case ArticleDesign.Letter:\n                    return 'letters';\n                default:\n                    return 'news';\n            }\n    }\n};\n/**\n * Get the `data-link-name` attribute for a card.\n * Used by Ophan for understanding reader journeys. E.g:\n * - `feature | card-2+ | card-@1`\n * - `news | group-0 | card-@5`\n *\n * @see {JSX.IntrinsicAttributes}\n */\nexport const getDataLinkNameCard = (format, group, index, cardStyle) => [\n    getLinkType(format, cardStyle),\n    `group-${group}`,\n    `card-@${Math.max(index + 1, 1)}`,\n].join(' | ');\n"],"names":["minHeight","name","styles","FetchOnwardsData","_ref","trails","trailLimit","url","limit","onwardsSource","format","discussionApiUrl","absoluteServerTimes","_useApi","useApi","data","error","window","guardian","modules","sentry","reportError","addDiscussionIds","map","trail","_trail$discussion","discussion","discussionId","filter","isNonNullable","_jsx","css","children","Carousel","heading","displayname","slice","decideTrail","description","leftColSize","design","ArticleDesign","LiveBlog","DeadBlog","Placeholder","height","shouldShimmer","backgroundColor","palette","BACKGROUND_COLOUR","neutral","shimmer","keyframes","_templateObject","_taggedTemplateLiteral","shimmerStyles","_ref2","rootId","width","spaceBelow","spaceLeft","_ref2$shouldShimmer","_ref2$backgroundColor","id","isUndefined","concat","space","index","arguments","length","undefined","decideFormat","image","src","altText","_objectSpread","dataLinkName","getDataLinkNameCard","getLinkType","cardStyle","theme","ArticleSpecial","SpecialReport","Analysis","Feature","Editorial","Comment","Gallery","Audio","Video","Review","Letter","group","Math","max","join"],"sourceRoot":""}