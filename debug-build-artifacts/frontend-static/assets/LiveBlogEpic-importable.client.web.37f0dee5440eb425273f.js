"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[2992],{62556:(e,t,n)=>{n.r(t),n.d(t,{LiveBlogEpic:()=>I});var r=n(50484),o=n(24017),i=n(18411),a=n(60439),c=n(61082),l=n(9474),s=n(96378),u=n(29995),d=n(67400),g=n(50026),p=n(99952),w=n(36226),m=n(14374),f=n(75747),y=n(53994);var v=n(15593);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){h(e,t,n[t])}))}return e}function O(){const e=(t=["\n\t\t\t\tmargin-bottom: ","px;\n\t\t\t"],n||(n=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})));var t,n;return O=function(){return e},e}const P=e=>{let{name:t,props:i}=e;const{Epic:c}=(e=>{let{name:t}=e;const[r,o]=(0,d.useState)();return(0,d.useEffect)((()=>{Promise.all([n.e(4684),n.e(8920),n.e(6398),n.e(3789),n.e(1076),n.e(5721),n.e(1262),n.e(6627),n.e(1477)]).then(n.bind(n,91052)).then((e=>{o((()=>e.ContributionsLiveblogEpic))})).catch((e=>{const t="Error importing LiveBlog epic: ".concat(String(e));window.guardian.modules.sentry.reportError(new Error(t),"liveblog-epic")}))}),[t]),{Epic:r}})({name:t});return(0,l.b)(c)?null:((0,a.Rm)("dotcom","LiveBlogEpic has the Epic"),(0,r.jsx)("aside",{css:(0,o.css)(O(),s.x[3]),children:(0,r.jsx)(c,b({},i))}))},E=e=>{let{payload:t,contributionsServiceUrl:n}=e;const o=((e,t)=>((e,t)=>{const{data:n,error:r}=(0,y.A)(e,t,{revalidateOnFocus:!1});return r&&window.guardian.modules.sentry.reportError(r,"rr-epic"),n})("liveblog-epic",(()=>(0,u.qY)(e,t))))(n,t),{renderingTarget:i}=(0,v.U)();if(!(null==o?void 0:o.data)||0===Object.keys(o).length)return null;(0,a.Rm)("dotcom","LiveBlogEpic has a module");const c=(l=b({},o.data.module.props),s=null!=(s={submitComponentEvent:e=>(0,g.u_)(e,i)})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(s)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(s)).forEach((function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(s,e))})),l);var l,s;return(0,r.jsx)(P,{name:o.data.module.name,props:c})};function C(e,t){var n;null===(n=e.parentNode)||void 0===n||n.insertBefore(t,e.nextSibling)}const I=e=>{let{sectionId:t,shouldHideReaderRevenue:n,isPaidContent:o,tags:l,contributionsServiceUrl:s,pageId:g,keywordIds:y}=e;(0,a.Rm)("dotcom","LiveBlogEpic started");const v=(e=>{let{shouldHideReaderRevenue:t,sectionId:n,isPaidContent:r,tags:o,pageId:l}=e;const s=(0,p.af)(l,o,"LiveBlog"),g=(0,w.mG)(),y=(0,f.F)("liveblog-epic"),v=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const[t,n]=(0,d.useState)(0);return(0,d.useEffect)((()=>{const e=(0,i.R)({name:"GU_mvt_id",shouldMemoize:!0});if(null===e)return;const t=Number(e)||0;n(t)}),[e]),t}(),h=(0,m.T)();if("Pending"===h)return;const b=(0,w.h3)(h);return"Pending"!==b&&"Pending"!==s&&"Pending"!==g&&((0,a.Rm)("dotcom","LiveBlogEpic has consent state"),y)?((0,a.Rm)("dotcom","LiveBlogEpic has countryCode"),{tracking:{ophanPageId:window.guardian.config.ophan.pageViewId,platformId:"GUARDIAN_WEB",clientName:"dcr",referrerUrl:window.location.origin+window.location.pathname},targeting:{contentType:"LiveBlog",sectionId:n,shouldHideReaderRevenue:t,isMinuteArticle:!0,isPaidContent:r,tags:o,showSupportMessaging:!b,mvtId:v,countryCode:y,epicViewLog:(0,u.DS)(c.I.local),weeklyArticleHistory:null==s?void 0:s.weeklyArticleHistory,hasOptedOutOfArticleCount:g,url:window.location.origin+window.location.pathname}}):void 0})({shouldHideReaderRevenue:n,sectionId:t,isPaidContent:o,tags:l,pageId:g,keywordIds:y});if(!v)return null;const h=document.createElement("article");if(window.location.href.includes("#block-")){h.classList.add("pending");const e=window.location.hash.slice(1),t=document.getElementById(e);t&&C(t,h),h.classList.add("reveal"),h.classList.remove("pending")}else{const e=Math.floor(3*Math.random())+1,t=document.querySelectorAll("article.block")[e];t&&C(t,h)}return(0,d.createPortal)((0,r.jsx)(E,{payload:v,contributionsServiceUrl:s}),h)}},99952:(e,t,n)=>{n.d(t,{af:()=>u,r2:()=>s});var r=n(61082),o=n(29995),i=n(67400),a=n(36226),c=n(15901);const l=e=>["article","liveblog","gallery","video","interactive","audio"].includes(e.toLowerCase()),s=async(e,t,n)=>{var i,s;return(e=>{window.guardian.dailyArticleCount||(l(e)&&(0,c.Q_)(),window.guardian.dailyArticleCount=(0,c.L3)()),window.guardian.dailyArticleCount})(n),await(async(e,t,n)=>{if(!await(0,a.yw)()){if(!window.guardian.weeklyArticleCount){if(l(n)){const n=t.filter((e=>["tone","keyword"].includes(e.type.toLowerCase()))).map((e=>e.id));(0,o.sB)(r.I.local,e,n)}window.guardian.weeklyArticleCount=(0,o.sQ)(r.I.local)}return window.guardian.weeklyArticleCount}})(e,t,n),{dailyArticleHistory:null!==(i=window.guardian.dailyArticleCount)&&void 0!==i?i:[],weeklyArticleHistory:null!==(s=window.guardian.weeklyArticleCount)&&void 0!==s?s:[]}},u=(e,t,n)=>{const[r,o]=(0,i.useState)("Pending");return(0,i.useEffect)((()=>{s(e,t,n).then(o).catch((()=>o(void 0)))}),[n,e,t]),r}},36226:(e,t,n)=>{n.d(t,{Jj:()=>y,Pp:()=>s,VF:()=>u,Vi:()=>l,Xr:()=>b,_f:()=>P,h3:()=>g,mG:()=>h,mV:()=>f,n8:()=>O,q6:()=>C,tZ:()=>E,yw:()=>v});var r=n(18411),o=n(9474),i=n(61082),a=n(9092),c=n(67400);const l="gu_hide_support_messaging",s="gu_recurring_contributor",u="gu.contributions.contrib-timestamp",d="gu.noRRBanner",g=e=>{const t=(e=>{switch((0,r.R)({name:l})){case"true":return!0;case"false":return!1;default:return!!e&&"Pending"}})(e);return"Pending"===t?"Pending":t||(()=>{const e=(()=>{const e=(0,r.R)({name:u});if(e)return(e?parseInt(e,10):0)||void 0})();return!(0,o.b)(e)&&((e,t)=>{const n=Date.now()-e;return Math.floor(n/864e5)})(e)<=90})()},p=[1,3,7],w=[1,3,5,7],m=()=>null!==(0,r.R)({name:"gu_article_count_opt_out"}),f=()=>new Promise((e=>{(0,r.R)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,a.Ym)((t=>{let{usnat:n,tcfv2:r,aus:o}=t;if(null!=n?n:o)e(!0);else if(r){const t=p.every((e=>r.consents[e]));t||i.I.local.remove("gu.history.weeklyArticleCount"),e(t)}}))})),y=async()=>!await f()||m(),v=async()=>!await f()||m(),h=()=>{const[e,t]=(0,c.useState)("Pending");return(0,c.useEffect)((()=>{y().then(t).catch((()=>t(!0)))}),[]),e},b=()=>new Promise((e=>{(0,r.R)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,a.Ym)((t=>{let{usnat:n,tcfv2:r,aus:o}=t;if(null!=n?n:o)e(!0);else if(r){const t=w.every((e=>r.consents[e]));e(t)}}))})),O=()=>!!i.I.local.get(d),P=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return i.I.local.set(d,!0,e+12e5)},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return!!e&&t-new Date(e).getTime()<36e5},C=()=>{const e=(0,r.R)({name:"GU_CO_COMPLETE",shouldMemoize:!0});if(!e)return;let t;try{t=JSON.parse(decodeURIComponent(e))}catch(e){}return t}},15901:(e,t,n)=>{n.d(t,{Gq:()=>c,L3:()=>a,Q_:()=>l});var r=n(85770),o=n(61082);const i="gu.history.dailyArticleCount",a=()=>{try{const t=o.I.local.get(i);if(e=t,!Array.isArray(e)||!e.every((e=>(0,r.G)(e)&&"day"in e&&"count"in e&&"number"==typeof e.day&&"number"==typeof e.count)))throw new Error("Invalid gu.history.dailyArticleCount value");return t}catch(e){return void o.I.local.remove(i)}var e},c=()=>Math.floor(Date.now()/864e5),l=()=>{var e,t;const n=null!==(t=a())&&void 0!==t?t:[],r=c();if((null===(e=n[0])||void 0===e?void 0:e.day)===r)n[0].count+=1;else{n.unshift({day:r,count:1});const e=r-60,t=n.findIndex((t=>t.day&&t.day<e));t>0&&n.splice(t)}o.I.local.set(i,n)}},14374:(e,t,n)=>{n.d(t,{T:()=>i,w:()=>a});var r=n(67400),o=n(97656);const i=()=>{switch(a().kind){case"Pending":return"Pending";case"SignedInWithCookies":case"SignedInWithOkta":return!0;case"SignedOutWithCookies":case"SignedOutWithOkta":return!1}},a=()=>{const[e,t]=(0,r.useState)({kind:"Pending"});return(0,r.useEffect)((()=>{(0,o.kU)((e=>{t((0,o.dx)(e))}),(()=>t((0,o.Hn)()))).catch((e=>{console.error(e)}))}),[]),e}},75747:(e,t,n)=>{n.d(t,{F:()=>a});var r=n(9786),o=n(67400),i=n(2899);const a=e=>{const[t,n]=(0,o.useState)();return(0,o.useEffect)((()=>{(0,i.C)().then((e=>{(0,r.R)(e)&&n(e)})).catch((t=>{const n="Error fetching country code: ".concat(String(t));window.guardian.modules.sentry.reportError(new Error(n),e)}))}),[e]),t}}}]);
//# sourceMappingURL=LiveBlogEpic-importable.client.web.37f0dee5440eb425273f.js.map