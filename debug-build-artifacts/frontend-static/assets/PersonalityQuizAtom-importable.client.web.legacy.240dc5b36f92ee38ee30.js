"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[729],{16369:(e,t,n)=>{n.r(t),n.d(t,{MissingAnswers:()=>z,PersonalityQuizAtom:()=>S,Result:()=>B,findMostReferredToBucketId:()=>A});var r=n(62335),s=n(22820),i=n(50484),o=n(24017),a=n(65656),l=n(71653),c=n(50641),u=n(59648),d=n(28673),f=n(58486),b=n(45699),m=n(67400),h=n(95644),p=n(27719),y=n(3010);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,s=function(){};return{s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var j=function(e){return(0,o.css)("margin-bottom:12px;border:0px;padding:0px;",e===h.A$.Labs?l.NA0:l.Ni,";label{width:inherit;}")},A=function(e){var t,n,r=e.selectedGlobalAnswers,s=e.questions,i={},o=x(Object.keys(r).map((function(e){var t=s.find((function(t){return t.id===e})),n=r[e];return null==t?void 0:t.answers.find((function(e){return e.id===n}))})).filter((function(e){return!(0,a.b)(e)})));try{for(o.s();!(t=o.n()).done;){var l,c=x(t.value.answerBuckets);try{for(c.s();!(l=c.n()).done;){var u=l.value;"number"==typeof i[u]?i[u]+=1:i[u]=1}}catch(e){c.e(e)}finally{c.f()}}}catch(e){o.e(e)}finally{o.f()}for(var d=0,f=Object.keys(i);d<f.length;d++){var b=f[d];if(n){var m=i[b],h=i[n];(0,a.b)(m)||(0,a.b)(h)||(n=m>h?b:n)}else n=b}return n},k={name:"5v8zb2",styles:"display:flex;flex-direction:row;button{margin-right:10px;}"},S=function(e){var t=e.id,n=e.questions,o=e.resultBuckets,a=e.sharingUrls,l=e.theme,c=(0,m.useState)({}),u=(0,s.A)(c,2),f=u[0],b=u[1],h=(0,m.useState)(!1),p=(0,s.A)(h,2),y=p[0],g=p[1],x=(0,m.useState)(!1),w=(0,s.A)(x,2),j=w[0],S=w[1],O=(0,m.useState)(),q=(0,s.A)(O,2),C=q[0],M=q[1],U=function(e){e.preventDefault(),n.some((function(e){return!(e.id in f)}))?S(!0):g(!0)};return(0,m.useEffect)((function(){if(y&&Object.keys(f).length){var e=A({selectedGlobalAnswers:f,questions:n});M(o.find((function(t){return t.id===e})))}else M(null)}),[y,f,M,o,n]),(0,i.jsxs)("form",{"data-atom-id":t,"data-atom-type":"personalityquiz",children:[y&&C&&(0,i.jsx)("div",{"data-testid":"quiz-results-block-top",children:(0,i.jsx)(B,{resultBuckets:C,sharingUrls:a})}),(0,i.jsx)("ol",{"data-ignore":"global-ol-styling",children:n.map((function(e,t){return(0,i.jsx)(P,{id:e.id,questionNumber:t+1,text:e.text,imageUrl:e.imageUrl,imageAlt:e.imageAlt,answers:e.answers,updateSelectedAnswer:function(t){S(!1),b(v(v({},f),{},(0,r.A)({},e.id,t)))},globallySelectedAnswer:e.id in f?f[e.id]:void 0,hasSubmittedAnswers:y,theme:l},e.id)}))}),j&&(0,i.jsx)(z,{}),y&&C&&(0,i.jsx)("div",{"data-testid":"quiz-results-block-bottom",children:(0,i.jsx)(B,{resultBuckets:C,sharingUrls:a})}),(0,i.jsxs)("div",{css:k,children:[(0,i.jsx)(d.$,{type:"submit",onClick:U,onKeyDown:function(e){var t;(null!==(t=32===e.keyCode)&&void 0!==t?t:13===e.keyCode)&&U(e)},"data-testid":"submit-quiz",children:"Submit"}),(0,i.jsx)(d.$,{priority:"secondary",onClick:function(){b({}),g(!1),M(null)},onKeyDown:function(e){var t;(null!==(t=32===e.keyCode)&&void 0!==t?t:13===e.keyCode)&&(b({}),g(!1),M(null))},"data-testid":"reset-quiz",children:"Reset"})]})]})},O={name:"1d3w5wq",styles:"width:100%"},q={name:"1k4fewv",styles:"padding-right:12px"},C={name:"cn3xcj",styles:"margin-bottom:12px"},P=function(e){var t=e.id,n=e.questionNumber,r=e.text,o=e.imageUrl,a=e.imageAlt,l=e.answers,c=e.updateSelectedAnswer,u=e.globallySelectedAnswer,d=e.hasSubmittedAnswers,f=e.theme,b=(0,m.useState)(),h=(0,s.A)(b,2),p=h[0],y=h[1];return(0,m.useEffect)((function(){p&&p!==u&&c(p)}),[c,p,u]),(0,m.useEffect)((function(){u||y(void 0)}),[u,y]),(0,i.jsx)("li",{css:j(f),children:(0,i.jsxs)("fieldset",{children:[(0,i.jsxs)("legend",{css:C,children:[(0,i.jsx)("span",{css:q,children:"".concat(n,".")}),r]}),!!o&&(0,i.jsx)("img",{css:O,src:o,alt:null!=a?a:""}),(0,i.jsx)(M,{hasSubmittedAnswers:d,questionId:t,answers:l,selectedAnswer:p,setSelectedAnswers:y,theme:f})]})})},M=(0,m.memo)((function(e){var t=e.hasSubmittedAnswers,n=e.questionId,r=e.answers,s=e.selectedAnswer,a=e.setSelectedAnswers,l=e.theme;return(0,i.jsx)("div",{css:[(0,p.bP)(l),(0,o.css)("label{:hover{background-color:",t?c.M.neutral[97]:c.M.neutral[86],";}}")],children:(0,i.jsx)(f.z,{name:n,children:r.map((function(e){return(0,i.jsx)(b.s,{value:e.text,label:e.text,"data-testid":e.id,"data-answer-type":s===e.id?"selected-enabled-answer":"unselected-enabled-answer",disabled:t,onChange:function(){return a(e.id)},checked:s===e.id},e.id)}))})})}));M.displayName="AnswersGroup";var U=(0,o.css)(l.keT," padding-bottom:",u.x[3],"px;color:",c.M.error[500],";"),z=function(){return(0,i.jsx)("div",{css:U,children:"You have not answered all the questions."})},I=(0,o.css)("background-color:",c.M.neutral[93],";margin-top:",u.x[3],"px;margin-bottom:",u.x[3],"px;padding:",u.x[2],"px;"),D=(0,o.css)(l.keT," color:",c.M.neutral[20],";padding-bottom:",u.x[1],"px;"),N=(0,o.css)(l.NA0," color:",c.M.neutral[46],";"),B=function(e){var t=e.resultBuckets,n=e.sharingUrls;return(0,i.jsxs)("div",{css:I,children:[(0,i.jsx)("div",{css:D,children:t.title}),(0,i.jsx)("div",{css:N,children:t.description}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{css:D,children:"Challenge your friends"}),(0,i.jsx)(y.N,{sharingUrls:n,displayIcons:["facebook","twitter","email","whatsApp","messenger","linkedIn","pinterest"]})]})}}}]);
//# sourceMappingURL=PersonalityQuizAtom-importable.client.web.legacy.240dc5b36f92ee38ee30.js.map