"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[5676],{5676:(e,r,t)=>{t.d(r,{d:()=>Pn});var n=t(31880),s=t(62335),o=t(22820),i=t(50484),c=t(24017),a=t(296),d=t(65656),u=t(59648),l=t(32437),m=t(67400),p=t(26124),x=t(73771),f=t(5240),h=t(57364),g=["collapsed","expanded","unthreaded"],b=[25,50,100],v=t(1954),y=t(71653),j=t(7693),k=t(95279),w=(0,m.createContext)((function(){(0,k.Y)("dotcom","The 'dispatch' function in discussion is not defined! Did you remember to include a context provider for it?")})),C=function(e){var r=e.value,t=e.children;return(0,i.jsx)(w.Provider,{value:r,children:t})},P=t(18247),M=t(57820),S=t.n(M),I=t(81477),O=t(56297),E=t(6155),A=t(28673),T=t(83416),R=t(16346),F=t(69010),U=t(59708),z=t(89417),D=t(73598),L=t(73499),N=t(60646),B=t(6569);function Y(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Y(Object(t),!0).forEach((function(r){(0,s.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Y(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var H=(0,c.css)("z-index:1;border:1px solid ",(0,v.M)("--discussion-border"),";position:absolute;width:300px;top:0;right:0;display:flex;flex-direction:column;padding:",u.x[3],"px;background-color:",(0,v.M)("--discussion-report-background"),";",y.Ikj,";"),q=(0,v.M)("--discussion-report-label-text"),K=(0,v.M)("--discussion-report-error-text"),G=(0,c.css)("background-color:",(0,v.M)("--discussion-report-button"),";"),V=(0,c.css)("select,input,textarea{border:1px solid ",(0,v.M)("--discussion-report-error-text"),";}"),$=(0,c.css)("select,input,textarea{border:1px solid ",(0,v.M)("--discussion-report-border"),";}"),W=(0,c.css)("display:flex;flex-direction:column;margin-bottom:",u.x[2],"px;label{display:block;}select,input,textarea{background-color:",(0,v.M)("--discussion-report-background"),";min-height:",u.x[5],"px;width:75%;color:inherit;}"),J=(0,c.css)("div{svg{right:80px;fill:",q,";}}"),X=(0,c.css)("span[role='alert']{svg{fill:",K,";}}"),Z=function(e){var r=e.commentId,t=e.toggleSetShowForm,n=e.reportAbuse,s=(0,m.useRef)(null),a=null,d=null;(0,m.useEffect)((function(){s.current&&(a=s.current.querySelector('select[name="category"]'),d=s.current.querySelector('button[custom-guardian="close-modal"]'))}),[s]),(0,m.useEffect)((function(){var e;null===(e=a)||void 0===e||e.focus()}),[a]),(0,m.useEffect)((function(){document.addEventListener("mousedown",(function(e){s.current&&!s.current.contains(e.target)&&t()}))}),[s,t]),(0,m.useEffect)((function(){var e=function(e){if("Escape"===e.code)t();else if("Tab"===e.code){if(!a||!d)return;e.shiftKey||document.activeElement!==d||(a.focus(),e.preventDefault()),e.shiftKey&&document.activeElement===a&&(d.focus(),e.preventDefault())}};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}));var l=(0,m.useState)({categoryId:0,reason:"",email:""}),p=(0,o.A)(l,2),x=p[0],f=p[1],h={categoryId:"",reason:"",email:"",response:""},g=(0,m.useState)(h),b=(0,o.A)(g,2),y=b[0],j=b[1],k=(0,m.useState)(),w=(0,o.A)(k,2),C=w[0],P=w[1],M=9===x.categoryId||3===x.categoryId;return(0,i.jsx)("div",{"aria-modal":"true",ref:s,children:(0,i.jsxs)("form",{css:H,onSubmit:function(e){e.preventDefault();var t=x.categoryId,s=x.reason,o=x.email;j(h),t?n({categoryId:t,reason:s,email:o,commentId:r}).then((function(e){"error"===e.kind?j(_(_({},y),{},{response:e.error})):P("Report submitted")})).catch((function(){(0,R.Rm)("dotcom","Discussion: error reporting abuse")})):j(_(_({},y),{},{categoryId:"You must select a category before submitting"}))},children:[(0,i.jsx)("div",{css:[W,J,X,y.categoryId?V:$],children:(0,i.jsxs)(F.l,{label:"Category",onChange:function(e){f(_(_({},x),{},{categoryId:Number(e.target.value)})),y.categoryId="",j(y)},value:x.categoryId,theme:{textLabel:q,textOptional:q,textError:K,borderError:K},error:y.categoryId?y.categoryId:void 0,children:[(0,i.jsx)(U.c,{value:"0",children:"Please select"}),(0,i.jsx)(U.c,{value:"1",children:"Personal abuse"}),(0,i.jsx)(U.c,{value:"2",children:"Off topic"}),(0,i.jsx)(U.c,{value:3,children:"Legal issue"}),(0,i.jsx)(U.c,{value:"4",children:"Trolling"}),(0,i.jsx)(U.c,{value:"5",children:"Hate speech"}),(0,i.jsx)(U.c,{value:"6",children:"Offensive/Threatening language"}),(0,i.jsx)(U.c,{value:"7",children:"Copyright"}),(0,i.jsx)(U.c,{value:"8",children:"Spam"}),(0,i.jsx)(U.c,{value:9,children:"Other"})]})}),(0,i.jsx)("div",{css:[W,J,X,y.reason?V:$],children:(0,i.jsx)(z.f,{id:"reason",size:"medium",label:"Reason",optional:!M,onChange:function(e){return f(_(_({},x),{},{reason:e.target.value}))},value:x.reason,required:M,theme:{textLabel:q,textOptional:q,textError:K,borderError:K},error:y.reason?y.reason:void 0})}),(0,i.jsx)("div",{css:[W,J,X,y.email?V:$],children:(0,i.jsx)(D.k,{label:"Email",optional:!0,id:"email",type:"email",onChange:function(e){return f(_(_({},x),{},{email:e.target.value}))},value:x.email,theme:{textLabel:q,textOptional:q,textError:K,borderError:K},error:y.email?y.email:void 0})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(A.$,{type:"submit",size:"small","data-link-name":"Post report abuse",cssOverrides:G,children:"Report"}),!!y.response&&(0,i.jsx)(L.W,{cssOverrides:(0,c.css)("color:",K,";padding-top:",u.x[2],"px;"),children:y.response}),!!C&&(0,i.jsx)(N.H,{cssOverrides:(0,c.css)("color:",(0,v.M)("--discussion-report-success-text"),";padding-top:",u.x[2],"px;"),children:C})]}),(0,i.jsx)("div",{css:(0,c.css)("position:absolute;right:",u.x[3],"px;top:",u.x[3],"px;"),children:(0,i.jsx)(A.$,{"custom-guardian":"close-modal",size:"small",iconSide:"right",icon:(0,i.jsx)(B.F,{}),onClick:t,"data-link-name":"cancel-report-abuse",hideLabel:!0,cssOverrides:G,children:"close report abuse modal"})})]})})},Q=function(e){return(0,c.css)("border-radius:",e+10,"px;width:",e,"px;height:",e,"px;")},ee=function(e){var r=e.imageUrl,t=void 0===r?"https://avatar.guim.co.uk/no-user-image.gif":r,n=e.displayName;switch(e.size){case"small":return(0,i.jsx)("img",{src:t,alt:n,css:Q(36)});case"large":return(0,i.jsx)("img",{src:t,alt:n,css:Q(60)});default:return(0,i.jsx)("img",{src:t,alt:n,css:Q(48)})}},re={name:"fhxb3m",styles:"display:flex;flex-direction:row;align-items:center"},te={name:"1g57i33",styles:"display:inline-block;width:15px;height:15px"},ne=(0,c.css)("display:inline-block;line-height:15px;margin:0 0 0 ",u.x[1],"px;",y.rDY,";"),se=(0,c.css)("color:",(0,v.M)("--discussion-staff-label-text"),";"),oe=(0,c.css)("color:",(0,v.M)("--discussion-pick-label-text"),";"),ie=function(){return(0,i.jsxs)("div",{css:re,children:[(0,i.jsxs)("svg",{width:"36",height:"36",viewBox:"0 0 36 36",css:te,fill:(0,v.M)("--staff-contributor-badge"),children:[(0,i.jsx)("path",{d:"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36"}),(0,i.jsx)("path",{fill:(0,v.M)("--staff-contributor-badge-text"),d:"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z"})]}),(0,i.jsx)("p",{css:[ne,se],children:"Staff"})]})},ce=function(){return(0,i.jsxs)("div",{css:re,children:[(0,i.jsxs)("svg",{width:"36",height:"36",viewBox:"0 0 36 36",css:te,fill:(0,v.M)("--staff-contributor-badge"),children:[(0,i.jsx)("path",{d:"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36"}),(0,i.jsx)("path",{fill:(0,v.M)("--staff-contributor-badge-text"),d:"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z"})]}),(0,i.jsx)("p",{css:[ne,se],children:"Contributor"})]})},ae=function(){return(0,i.jsxs)("div",{css:re,children:[(0,i.jsxs)("svg",{width:"36",height:"36",viewBox:"0 0 36 36",css:te,fill:(0,v.M)("--staff-pick-badge"),children:[(0,i.jsx)("path",{d:"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36"}),(0,i.jsx)("path",{fill:(0,v.M)("--staff-pick-badge-text"),d:"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z"})]}),(0,i.jsx)("p",{css:[ne,oe],children:"Guardian Pick"})]})},de={name:"1fttcpj",styles:"display:flex;flex-direction:column"},ue=function(e){var r=e.children;return(0,i.jsx)("div",{css:de,children:r})},le=t(91839),me={name:"ho1qnd",styles:"display:flex;flex-direction:row"},pe=function(e){var r=e.children,t=e.wrap,n=void 0!==t&&t,s=e.cssOverrides;return(0,i.jsx)("div",{css:[me,s],style:{flexWrap:n?"wrap":void 0},children:r})},xe=(0,c.css)(y.Ikj,";font-weight:300;min-width:0.75rem;color:",(0,v.M)("--discussion-subdued"),";margin-right:0.3125rem;"),fe=function(e,r){return(0,c.css)("cursor:",e||!r?"default":"pointer",";width:1.1875rem;height:1.1875rem;background-color:",e?(0,v.M)("--recommendation-count-selected"):(0,v.M)("--recommendation-count"),";border-radius:62.5rem;border:none;")},he=function(e){return(0,c.css)("display:flex;flex-direction:column;align-items:center;svg{fill:",e?(0,v.M)("--recommendation-count-arrow-selected"):(0,v.M)("--recommendation-count-arrow"),";height:15px;width:15px;}")},ge=function(e){var r=e.commentId,t=e.initialCount,n=e.alreadyRecommended,s=e.user,c=e.userMadeComment,a=e.isClosedForRecommendations,d=(0,m.useState)(t),u=(0,o.A)(d,2),l=u[0],p=u[1],x=(0,m.useState)(n),f=(0,o.A)(x,2),h=f[0],g=f[1];return(0,i.jsxs)(pe,{children:[(0,i.jsx)("div",{css:xe,children:l}),(0,i.jsx)("button",{css:fe(h,!!s),onClick:function(){if(s){var e=l+1;p(e),g(!0),s.onRecommend(r).then((function(r){r||(p(e-1),g(n))})).catch((function(){}))}},disabled:h||!s||c||a,"data-link-name":"Recommend comment","aria-label":"Recommend comment",type:"button",children:(0,i.jsx)("div",{css:he(h),children:(0,i.jsx)(le.B,{})})})]})},be=t(25995),ve=function(e){var r=new Date(e);return function(e){var r=Math.round((new Date).getTime()/1e3)-86400;return e.getTime()>=new Date(1e3*r).getTime()}(r)?(0,be.f)(r.getTime(),{verbose:!0,daysUntilAbsolute:1}):"".concat(r.getDate()," ").concat(function(e){switch(e){case 0:return"Jan";case 1:return"Feb";case 2:return"Mar";case 3:return"Apr";case 4:return"May";case 5:return"Jun";case 6:return"Jul";case 7:return"Aug";case 8:return"Sep";case 9:return"Oct";case 10:return"Nov";case 11:return"Dec";default:return""}}(r.getMonth())," ").concat(r.getFullYear()," ").concat(r.getHours(),".").concat(String(r.getMinutes()).padStart(2,"0"))},ye=(0,c.css)("color:",(0,v.M)("--discussion-subdued"),";text-decoration:none;:hover,:focus{text-decoration:underline;}"),je=(0,c.css)(y.Ikj,";font-weight:300;min-width:0.75rem;margin-right:0.3125rem;white-space:nowrap;"),ke=function(e){var r,t,n=e.isoDateTime,s=e.webUrl,c=e.commentId,a=e.onPermalinkClick,d=(0,m.useState)(ve(n)),u=(0,o.A)(d,2),l=u[0],p=u[1];return r=function(){p(ve(n))},15e3,t=(0,m.useRef)(),(0,m.useEffect)((function(){t.current=r}),[r]),(0,m.useEffect)((function(){var e=setInterval((function(){var e=t.current;e&&e()}),15e3);return function(){return clearInterval(e)}}),[15e3]),(0,i.jsx)("a",{href:s,css:ye,"data-link-name":"jump-to-comment-timestamp",onClick:function(e){a(c),e.preventDefault()},rel:"nofollow",children:(0,i.jsx)("time",{dateTime:n.toString(),css:je,children:l})})},we=(0,c.css)("margin-top:-2px;a{",y.yui," margin-right:",u.x[2],"px;color:",(0,v.M)("--discussion-accent-text"),";:hover{text-decoration:none;text-decoration-color:none;span{color:",(0,v.M)("--discussion-accent-text"),";text-decoration:underline;text-decoration-color:",(0,v.M)("--discussion-accent-text"),";}}}"),Ce={name:"1eoy87d",styles:"display:flex;justify-content:space-between"},Pe=(0,c.css)("display:block;clear:left;",y.PSs," margin-top:",u.L[2],";margin-bottom:",u.L[3],";word-break:break-word;p{margin-top:0;margin-bottom:",u.x[3],"px;}blockquote{margin-top:",u.x[3],"px;margin-bottom:",u.x[3],"px;margin-left:",u.x[5],"px;margin-right:",u.x[5],"px;padding-left:",u.x[2],"px;color:",(0,v.M)("--discussion-subdued"),";}i{font-style:italic;}b{font-weight:bold;}code{font-family:monospace;font-size:1em;}"),Me=(0,c.css)("color:",(0,v.M)("--discussion-subdued"),";",y.Ikj,";"),Se=(0,c.css)("a{color:",(0,v.M)("--discussion-link"),";text-decoration-color:",(0,v.M)("--discussion-comment-underline"),";:hover{text-decoration:underline;}}"),Ie=(0,c.css)("border-top:1px solid ",(0,v.M)("--discussion-border"),";display:flex;padding:",u.x[2],"px 0;"),Oe=(0,c.css)("background-color:",(0,v.M)("--discussion-selected-background"),";margin-left:-",u.x[2],"px;padding-left:",u.x[2],"px;margin-right:-",u.x[2],"px;padding-right:",u.x[2],"px;"),Ee=(0,c.css)("margin-right:",u.x[2],"px;",I.TG.mobileLandscape,"{display:none;}"),Ae=(0,c.css)("a{color:",(0,v.M)("--discussion-accent-text"),";text-decoration-color:",(0,v.M)("--discussion-accent-text"),";:hover{color:",(0,v.M)("--discussion-accent-text"),";text-decoration-color:",(0,v.M)("--discussion-accent-text"),";}}"),Te=(0,c.css)("a{",y.yui,";}"),Re=(0,c.css)("a{",y.PSs,";}"),Fe=(0,c.css)("svg{fill:",(0,v.M)("--discussion-subdued"),"!important;}"),Ue={name:"yr9n6z",styles:"flex-grow:1;width:100%"},ze={name:"4c6dm7",styles:"display:flex;flex-direction:row;justify-content:space-between"},De={name:"n6f5a6",styles:"padding:2px;white-space:nowrap"},Le=(0,c.css)("margin-left:",u.x[2],"px;display:flex;flex-direction:column;justify-content:center;"),Ne=(0,c.css)(I.TG.mobileLandscape,"{display:none;}"),Be=(0,c.css)(I.HT.mobileLandscape,"{display:none;}"),Ye={name:"w1bd1c",styles:"margin-top:0px;margin-bottom:-6px"},_e={name:"1h52dri",styles:"overflow:hidden;text-overflow:ellipsis;white-space:nowrap"},He=(0,c.css)(I.TG.mobileLandscape,"{padding-right:10px;width:calc(100% - 35px);box-sizing:border-box;}"),qe=(0,c.css)("button{color:",(0,v.M)("--discussion-accent-text"),";background-color:transparent;height:18px;min-height:18px;border-radius:0;:hover{text-decoration:underline;text-decoration-color:",(0,v.M)("--discussion-accent-text"),";}}"),Ke=(0,c.css)("button{color:",(0,v.M)("--discussion-subdued"),";background-color:transparent;height:18px;min-height:18px;border-radius:0;:hover{text-decoration:underline;text-decoration-color:",(0,v.M)("--discussion-subdued"),";}}"),Ge={name:"g65o95",styles:"text-decoration:none"},Ve=(0,c.css)(I.TG.mobileLandscape,"{",_e," width:100%;max-width:fit-content;}"),$e=(0,c.css)("margin-top:-2px;",I.TG.mobileLandscape,"{",_e," min-width:40%;flex-grow:1;}"),We=(0,c.css)("display:flex;flex-direction:column;gap:",u.x[1],"px;"),Je=function(e){var r=e.amount;return(0,i.jsx)("div",{css:(0,c.css)("width:",u.x[r],"px;")})},Xe={name:"bjn8wh",styles:"position:relative"},Ze={name:"hwfcu5",styles:"color:red"},Qe=function(e){var r=e.comment,t=e.isClosedForComments,n=e.isClosedForRecommendations,s=e.setCommentBeingRepliedTo,a=e.user,d=e.isReply,l=e.wasScrolledTo,p=e.isMuted,x=e.toggleMuteStatus,f=e.onPermalinkClick,h=e.reportAbuse,g=e.isExpanded,b=(0,m.useState)(r.isHighlighted),v=(0,o.A)(b,2),j=v[0],k=v[1],w=(0,m.useState)(!1),C=(0,o.A)(w,2),M=C[0],I=C[1],R=(0,m.useState)(""),F=(0,o.A)(R,2),U=F[0],z=F[1],D=function(){I(!M)},L=function(){var e=(0,P.A)(S().mark((function e(t){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(""),e.next=3,t.onPick(r.id);case 3:"error"===(n=e.sent).kind?z(n.error):k(n.value);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),N=function(){var e=(0,P.A)(S().mark((function e(t){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(""),e.next=3,t.onUnpick(r.id);case 3:"error"===(n=e.sent).kind?z(n.error):k(n.value);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),B=r.userProfile.badge.some((function(e){return"Staff"===e.name})),Y="blocked"!==r.status&&j,_=r.userProfile.badge.some((function(e){return"Contributor"===e.name}));return(0,i.jsxs)(i.Fragment,{children:[!!U&&(0,i.jsx)("span",{css:Ze,children:U}),(0,i.jsxs)("div",{id:"comment-".concat(r.id),"data-testid":r.id,css:[Ie,l&&Oe],children:[(0,i.jsx)("div",{css:Ee,children:(0,i.jsx)(ee,{imageUrl:r.userProfile.avatar,displayName:r.userProfile.displayName,size:d?"small":"medium"})}),(0,i.jsxs)("div",{css:Ue,children:[(0,i.jsxs)("header",{css:ze,children:[(0,i.jsx)("div",{css:He,children:(0,i.jsxs)(ue,{children:[(0,i.jsx)("div",{css:[r.responseTo&&Ne,Be],children:(0,i.jsxs)(pe,{children:[(0,i.jsx)("div",{css:(0,c.css)("margin-right:",u.x[2],"px;"),children:(0,i.jsx)(ee,{imageUrl:r.userProfile.avatar,displayName:"",size:"small"})}),(0,i.jsxs)("div",{css:We,children:[(0,i.jsx)("div",{css:[Ae,Te,Ye],children:(0,i.jsx)(O.N,{href:r.userProfile.webUrl,cssOverrides:Ge,rel:"nofollow",children:r.userProfile.displayName})}),(0,i.jsx)(ke,{isoDateTime:r.isoDateTime,webUrl:r.webUrl,commentId:r.id,onPermalinkClick:f})]})]})}),(0,i.jsxs)("div",{css:[!r.responseTo&&Ne],children:[(0,i.jsxs)(pe,{children:[(0,i.jsx)("div",{css:[Ae,Te,Ve],children:(0,i.jsx)(O.N,{href:r.userProfile.webUrl,cssOverrides:Ge,rel:"nofollow",children:r.userProfile.displayName})}),r.responseTo?(0,i.jsx)("div",{css:[Ae,Re,Fe,$e],children:(0,i.jsx)(O.N,{href:"#comment-".concat(r.responseTo.commentId),cssOverrides:Ge,icon:(0,i.jsx)(E.Z,{}),iconSide:"left",rel:"nofollow",children:r.responseTo.displayName})}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)("div",{css:[Le,r.responseTo&&Ne],children:(0,i.jsx)(ke,{isoDateTime:r.isoDateTime,webUrl:r.webUrl,commentId:r.id,onPermalinkClick:f})})]}),(0,i.jsxs)(pe,{children:[B&&(0,i.jsx)("div",{css:De,children:(0,i.jsx)(ie,{})}),_&&!B&&(0,i.jsx)("div",{css:De,children:(0,i.jsx)(ce,{})}),Y&&(0,i.jsx)("div",{css:De,children:(0,i.jsx)(ae,{})})]})]})]})}),"blocked"!==r.status&&(0,i.jsx)(ge,{commentId:r.id,initialCount:r.numRecommends,alreadyRecommended:!1,user:a,userMadeComment:(null==a?void 0:a.profile.userId)===r.userProfile.userId,isClosedForRecommendations:n})]}),(0,i.jsx)("div",{css:[r.responseTo&&Ne,Be],children:(0,i.jsxs)(pe,{children:[B&&(0,i.jsx)("div",{css:De,children:(0,i.jsx)(ie,{})}),_&&!B&&(0,i.jsx)("div",{css:De,children:(0,i.jsx)(ce,{})}),Y&&(0,i.jsx)("div",{css:De,children:(0,i.jsx)(ae,{})})]})}),p&&(0,i.jsx)("p",{css:Me,children:(0,i.jsxs)(pe,{children:[(0,i.jsx)(i.Fragment,{children:"All posts from this user have been muted on this device."}),(0,i.jsx)(Je,{amount:1}),(0,i.jsx)("div",{css:[Ke,(0,c.css)("button{",y.rDY,";}")],children:(0,i.jsx)(A.$,{priority:"subdued",size:"xsmall",onClick:function(){return x(r.userProfile.userId)},"data-link-name":"unmute-user",children:"Unmute?"})})]})}),!p&&"blocked"===r.status&&(0,i.jsx)("p",{css:[Me,Se],dangerouslySetInnerHTML:{__html:r.body}}),!p&&"blocked"!==r.status&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{css:[Pe,Se],dangerouslySetInnerHTML:{__html:r.body}}),(0,i.jsxs)("div",{css:Ce,children:[(0,i.jsxs)(pe,{children:[!t&&(0,i.jsxs)(i.Fragment,{children:[a?(0,i.jsx)("div",{css:[Fe,qe,(0,c.css)("button{",y.yui,";}")],children:(0,i.jsx)(A.$,{priority:"subdued",onClick:function(){return s(r)},icon:(0,i.jsx)(E.Z,{}),iconSide:"left","data-link-name":"reply to comment",children:"Reply"})}):(0,i.jsx)("div",{css:[Fe,we],children:(0,i.jsx)(O.N,{href:"https://profile.theguardian.com/signin?returnUrl=".concat(r.webUrl,"&").concat((0,T.h)("signin_to_reply_comment")),cssOverrides:Ge,icon:(0,i.jsx)(E.Z,{}),iconSide:"left",rel:"nofollow",children:(0,i.jsx)("span",{"data-link-name":"reply to comment",children:"Reply"})})}),(0,i.jsx)(Je,{amount:4})]}),(0,i.jsx)(Je,{amount:4}),"Staff"===(null==a?void 0:a.kind)&&a.profile.userId!==r.userProfile.userId&&(0,i.jsx)("div",{css:[qe,(0,c.css)("button{",y.yui,";}")],children:(0,i.jsx)(A.$,{priority:"subdued",onClick:j?function(){return N(a)}:function(){return L(a)},"data-link-name":j?"unpick-comment":"pick-comment",children:j?"Unpick":"Pick"})})]}),(0,i.jsxs)(pe,{children:[a&&r.userProfile.userId!==a.profile.userId?(0,i.jsx)("div",{css:[Ke,(0,c.css)("button{",y.Ikj,";}")],children:(0,i.jsx)(A.$,{priority:"subdued",size:"small",onClick:function(){return x(r.userProfile.userId)},"data-link-name":"mute-user",children:"Mute"})}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)(Je,{amount:4}),g&&(0,i.jsx)("div",{css:[Ke,(0,c.css)("button{",y.Ikj,";}")],children:(0,i.jsx)(A.$,{priority:"subdued",size:"small",onClick:D,"data-link-name":"Open report abuse",children:"Report"})}),M&&(0,i.jsx)("div",{css:Xe,children:(0,i.jsx)(Z,{toggleSetShowForm:D,commentId:r.id,reportAbuse:h})})]})]})]})]})]})]})},er=t(21849),rr=function(e){switch(e){case"primary":return(0,c.css)("button{",y.yui," background-color:",(0,v.M)("--discussion-primary-button-background"),";color:",(0,v.M)("--discussion-button-text"),";:hover{background-color:",(0,v.M)("--discussion-button-background-hover"),";}}");case"secondary":return(0,c.css)("button{",y.yui," background-color:transparent;border:1px solid ",(0,v.M)("--discussion-accent-text"),";color:",(0,v.M)("--discussion-accent-text"),";:hover{background-color:",(0,v.M)("--discussion-button-background-hover"),";border:1px solid ",(0,v.M)("--discussion-button-background-hover"),";color:",(0,v.M)("--discussion-button-text"),";}}");case"subdued":return(0,c.css)("button{",y.yui," background-color:transparent;color:",(0,v.M)("--discussion-accent-text"),";border-radius:0;}")}},tr=function(e){var r=e.onClick,t=e.type,n=e.priority,s=void 0===n?"primary":n,o=e.children,c=e.icon,a=e.iconSide,d=e.linkName,u=e.size,l=void 0===u?"default":u;return(0,i.jsx)("div",{css:rr(s),children:(0,i.jsx)(A.$,{priority:s,size:l,onClick:r,type:t,icon:c,iconSide:a,"data-link-name":d,children:o})})},nr=(0,c.css)(y.PSs," padding:",u.x[2],"px ",u.x[4],"px;background-color:",(0,v.M)("--discussion-preview-background"),";border-radius:5px;margin-top:0;margin-bottom:",20,"px;word-break:break-word;blockquote{margin-top:",u.x[3],"px;margin-bottom:",u.x[3],"px;margin-left:",u.x[5],"px;margin-right:",u.x[5],"px;padding-left:",u.x[2],"px;color:",(0,v.M)("--discussion-subdued"),";}i{font-style:italic;}b{font-weight:bold;}code{font-family:monospace;font-size:1em;}p{margin-top:0;margin-bottom:",u.x[3],"px;}"),sr=(0,c.css)("display:block;left:0;width:0;height:0;border-right:1rem solid transparent;border-bottom:1rem solid ",(0,v.M)("--discussion-preview-background"),";margin-left:12.5rem;border-right-style:inset;"),or=function(e){var r=e.previewHtml,t=e.showSpout;return(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsx)("div",{css:sr}),(0,i.jsx)("div",{css:nr,dangerouslySetInnerHTML:{__html:r||""}})]})},ir=(0,c.css)(y.PSs,";"),cr=(0,c.css)("color:",(0,v.M)("--discussion-link"),";"),ar=function(e){var r=e.children;return(0,i.jsx)("p",{css:ir,children:r})},dr={name:"1m5rhmv",styles:">label{>*{color:inherit;}}"},ur={name:"flb614",styles:"background-color:transparent;color:inherit"},lr=(0,c.css)(y.aal,";"),mr=function(e){var r=e.error,t=void 0===r?"":r,n=e.submitForm,s=e.cancelSubmit,a=e.previewBody,d=(0,j.U)().renderingTarget,l=(0,m.useState)(""),p=(0,o.A)(l,2),x=p[0],f=p[1];return"Apps"===d?(0,i.jsxs)("div",{css:(0,c.css)("padding:",u.x[2],"px;"),children:[(0,i.jsx)("h3",{css:lr,children:"Welcome, you’re about to make your first comment!"}),(0,i.jsx)(ar,{children:"Before you can post, you need to choose a username. Please do this in your profile settings."})]}):(0,i.jsx)("div",{css:(0,c.css)("padding:",u.x[2],"px;"),children:(0,i.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n(x)},children:[(0,i.jsx)("h3",{css:lr,children:"Welcome, you’re about to make your first comment!"}),(0,i.jsx)(ar,{children:"Before you post, we’d like to thank you for joining the debate - we’re glad you’ve chosen to participate and we value your opinions and experiences."}),(0,i.jsx)(ar,{children:"Please choose your username under which you would like all your comments to show up. You can only set your username once."}),(0,i.jsx)("div",{css:dr,children:(0,i.jsx)(D.k,{label:"Username:",supporting:"Must be 6-20 characters, letters and/or numbers only, no spaces.",value:x,onChange:function(e){return f(e.target.value)},width:30,error:t,cssOverrides:ur})}),(0,i.jsx)(ar,{children:(0,i.jsxs)(i.Fragment,{children:["Please keep your posts respectful and abide by the"," ",(0,i.jsx)(O.N,{href:"/community-standards",priority:"primary",subdued:!0,rel:"nofollow",cssOverrides:cr,children:(0,i.jsx)("span",{css:ir,children:"community guidelines"})})," -"," and if you spot a comment you think doesn’t adhere to the guidelines, please use the ‘Report’ link next to it to let us know."]})}),(0,i.jsx)(ar,{children:"Please preview your comment below and click ‘post’ when you’re happy with it."}),(0,i.jsx)(or,{previewHtml:a,showSpout:!1}),(0,i.jsxs)(pe,{children:[(0,i.jsx)(tr,{onClick:function(){n(x)},linkName:"post comment",size:"small",children:"Post your comment"}),(0,i.jsx)("div",{css:(0,c.css)("width:",u.x[3],"px;")}),(0,i.jsx)(tr,{priority:"subdued",onClick:s,linkName:"cancel-post-comment",size:"small",children:"Cancel"})]})]})})},pr=function(e){return"<b>".concat(e,"</b>")},xr=function(e){return"<i>".concat(e,"</i>")},fr=function(e){return"<del>".concat(e,"</del>")},hr=function(e){return"<code>".concat(e,"</code>")},gr=function(e){return"<blockquote>".concat(e,"</blockquote>")},br=(0,c.css)("display:flex;flex-wrap:wrap;margin-bottom:",u.x[5],"px;"),vr=(0,c.css)("width:100%;margin-bottom:",u.x[3],"px;padding:8px 10px 10px 8px;",y.PSs,";border-color:",(0,v.M)("--discussion-border"),";:focus{border-color:",(0,v.M)("--discussion-subdued"),";outline:none;}color:inherit;background-color:",(0,v.M)("--comment-form-input-background"),";"),yr=(0,c.css)("::placeholder{color:",(0,v.M)("--discussion-subdued"),";}"),jr={name:"1evczql",styles:"::placeholder{font-weight:bold;opacity:1;color:inherit;}"},kr=(0,c.css)("margin:0 0 10px 0;",y.Ikj,";"),wr=(0,c.css)("a{color:",(0,v.M)("--discussion-link"),";text-decoration:none;:hover,:focus{text-decoration:underline;}}"),Cr=(0,c.css)("background-color:",(0,v.M)("--comment-form-header-background"),";padding:8px 10px 10px 8px;width:100%;margin-top:8px;margin-bottom:2px;"),Pr=(0,c.css)("height:22px;font-size:13px;line-height:17px;border:1px solid ",(0,v.M)("--discussion-background"),";background-color:",(0,v.M)("--discussion-background"),";color:inherit;text-align:center;cursor:pointer;margin-left:4px;padding:2px 5px 0px 5px;min-width:11px;list-style-type:none;"),Mr=(0,c.css)("& div{color:inherit;",y.rDY,";svg{fill:",(0,v.M)("--discussion-pre-mod"),";}}"),Sr=(0,c.css)("color:",(0,v.M)("--discussion-pre-mod"),";",y.rDY,";"),Ir=(0,c.css)("width:100%;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;align-items:stretch;align-content:space-between;gap:",u.x[3],"px;",I.TG.wide,"{flex-direction:column-reverse;}"),Or=function(e){var r=e.amount;return(0,i.jsx)("div",{css:(0,c.css)("width:",u.x[r],"px;")})},Er=function(e,r,t){return{id:e,body:r,date:Date(),isoDateTime:(new Date).toISOString(),status:"visible",webUrl:"https://discussion.theguardian.com/comment-permalink/".concat(e),apiUrl:"https://discussion.guardianapis.com/discussion-api/comment/".concat(e),numRecommends:0,isHighlighted:!1,userProfile:t,responses:[]}},Ar=function(e,r,t,n){return{id:e,body:r,date:Date(),isoDateTime:(new Date).toISOString(),status:"visible",webUrl:"https://discussion.theguardian.com/comment-permalink/".concat(e),apiUrl:"https://discussion.guardianapis.com/discussion-api/comment/".concat(e),numRecommends:0,isHighlighted:!1,userProfile:t,responseTo:{displayName:n.userProfile.displayName,commentApiUrl:"https://discussion.guardianapis.com/discussion-api/comment/".concat(n.id),isoDateTime:n.isoDateTime,date:n.date,commentId:String(n.id),commentWebUrl:"https://discussion.theguardian.com/comment-permalink/".concat(n.id)}}},Tr=function(e){var r,t=e.shortUrl,n=e.onAddComment,s=e.user,a=e.setCommentBeingRepliedTo,d=e.commentBeingRepliedTo,u=e.onPreview,l=e.error,p=e.setError,f=e.userNameMissing,h=e.setUserNameMissing,g=e.previewBody,b=e.setPreviewBody,v=(0,m.useState)(!1),y=(0,o.A)(v,2),j=y[0],k=y[1],w=(0,m.useState)(!1),C=(0,o.A)(w,2),M=C[0],I=C[1],E=(0,m.useState)(0),A=(0,o.A)(E,2),T=A[0],R=A[1],F=(0,m.useState)(0),U=(0,o.A)(F,2),D=U[0],L=U[1],N=(0,m.useState)(""),B=(0,o.A)(N,2),Y=B[0],_=B[1],H=function(e){_(e)};(0,m.useEffect)((function(){var e,r;d&&(null===(e=document.getElementById("comment-".concat(d.id)))||void 0===e||e.scrollIntoView(),null===(r=document.querySelector("#comment-reply-form-".concat(d.id," textarea")))||void 0===r||r.focus())}),[d]);var q=function(){var e=Y;return{startString:e.substring(0,T),highlightedString:e.substring(T,D),endString:e.substring(D,e.length)}},K=function(e){var r=q();if(r){var t=r.startString,n=r.highlightedString,s=r.endString;H(t.concat(e(n),s))}},G=function(){var e=(0,P.A)(S().mark((function e(){var r,t,n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Y){e.next=3;break}return e.abrupt("return");case 3:return t=null!=u?u:x.VH,e.next=6,t(r);case 6:if("error"!==(n=e.sent).kind){e.next=11;break}return p("Preview request failed, please try again"),b(""),e.abrupt("return");case 11:b(n.value);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(e){switch(e){case"USERNAME_MISSING":return h(!0);case"EMPTY_COMMENT_BODY":return p("Please write a comment.");case"COMMENT_TOO_LONG":return p("Your comment must be fewer than 5000 characters long.");case"USER_BANNED":return p('Commenting has been disabled for this account (<a href="/community-faqs#321a">why?</a>).');case"IP_THROTTLED":return p('Commenting has been temporarily blocked for this IP address (<a href="/community-faqs">why?</a>).');case"DISCUSSION_CLOSED":return p("Sorry your comment can not be published as the discussion is now closed for comments.");case"PARENT_COMMENT_MODERATED":return p("Sorry the comment can not be published as the comment you replied to has been moderated since.");case"COMMENT_RATE_LIMIT_EXCEEDED":return p("You can only post one comment every minute. Please try again in a moment.");case"INVALID_PROTOCOL":return p("Sorry your comment can not be published as it was not sent over\n\t\t\t\t\ta secure channel. Please report us this issue using the technical issue link\n\t\t\t\t\tin the page footer.");case"AUTH_COOKIE_INVALID":return p("Sorry, your comment was not published as you are no longer signed in. Please sign in and try again.");case"READ-ONLY-MODE":return p("Sorry your comment can not currently be published as\n\t\t\t\t\tcommenting is undergoing maintenance but will be back shortly. Please try\n\t\t\t\t\tagain in a moment.");case"API_CORS_BLOCKED":return p("Could not post due to your internet settings, which might be\n\t\t\t\t   controlled by your provider. Please contact your administrator\n\t\t\t\t   or disable any proxy servers or VPNs and try again.");case"API_ERROR":return p("Sorry, there was a problem posting your comment. Please try\n\t\t\t\t\tanother browser or network connection.  Reference code ");case"EMAIL_NOT_VALIDATED":return p('Please confirm your email address to comment.<br />\n\t\t\t\t\tIf you can\'t find the email, we can\n\t\t\t\t\t<a href="#">\n\t\t\t\t\t<strong>resend the verification email</strong></a> to your email\n\t\t\t\t\taddress.');default:return p("Sorry, there was a problem posting your comment.")}},$=function(){p(""),H(""),b(""),k(!1),null==a||a()},W=function(){var e=(0,P.A)(S().mark((function e(){var r,o;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!M){e.next=2;break}return e.abrupt("return");case 2:if(I(!0),p(""),!(r=Y)){e.next=17;break}if(!d){e.next=12;break}return e.next=9,s.onReply(t,r,d.id);case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,s.onComment(t,r);case 14:e.t0=e.sent;case 15:"error"===(o=e.t0).kind?V(o.error):(n(d?Ar(o.value,r,s.profile,d):Er(o.value,r,s.profile)),$());case 17:I(!1);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=(0,P.A)(S().mark((function e(r){var t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p(""),r){e.next=4;break}return p("Username field cannot be empty"),e.abrupt("return");case 4:return e.next=6,s.addUsername(r);case 6:"ok"===(t=e.sent).kind?(W(),h(!1)):p(t.error);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return j&&f?(0,i.jsx)(mr,{error:l,submitForm:J,cancelSubmit:function(){return h(!1)},previewBody:g}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{css:br,onSubmit:function(e){e.preventDefault(),W()},children:[j&&(0,i.jsxs)("div",{css:Cr,children:[(0,i.jsxs)("p",{css:[kr,wr],children:["Please keep comments respectful and abide by the"," ",(0,i.jsx)("a",{href:"/community-standards",children:"community guidelines"}),"."]}),(null===(r=s.profile.privateFields)||void 0===r?void 0:r.isPremoderated)&&(0,i.jsx)(er.P,{message:"Your comments are currently being pre-moderated",context:(0,i.jsx)(O.N,{href:"/community-faqs#311",target:"_blank",rel:"nofollow",cssOverrides:Sr,children:"(why?)"}),cssOverrides:Mr})]}),(0,i.jsx)(z.f,{"data-testid":"comment-input",placeholder:d||!j?"Join the discussion":"",cssOverrides:(0,c.css)([vr,d&&j&&yr,!d&&!j&&jr],""),style:{height:j?"132px":"50px"},onFocus:function(){return k(!0)},value:Y,onChange:function(e){_(e.target.value)},onSelect:function(e){R(e.target.selectionStart),L(e.target.selectionEnd)},label:"",error:l}),(0,i.jsxs)("div",{css:Ir,children:[(0,i.jsx)(pe,{wrap:!0,children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tr,{type:"submit",linkName:"post comment",size:"small",children:"Post your comment"}),j&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Or,{amount:3}),(0,i.jsx)(tr,{onClick:G,priority:"secondary",linkName:"preview-comment",size:"small",children:"Preview"}),(0,i.jsx)(Or,{amount:3}),(0,i.jsx)(tr,{onClick:$,priority:"subdued",linkName:"cancel-post-comment",size:"small",children:"Cancel"})]})]})}),j&&(0,i.jsxs)(pe,{wrap:!0,children:[(0,i.jsx)("button",{onClick:function(e){e.preventDefault(),K(pr)},css:Pr,style:{fontWeight:"bold"},"data-link-name":"formatting-controls-bold",type:"button",title:"Bold",children:"bold"}),(0,i.jsx)("button",{onClick:function(e){e.preventDefault(),K(xr)},css:Pr,style:{fontStyle:"italic"},"data-link-name":"formatting-controls-italic",type:"button",title:"Italic",children:"italic"}),(0,i.jsx)("button",{onClick:function(e){e.preventDefault(),K(fr)},css:Pr,style:{textDecoration:"line-through"},"data-link-name":"formatting-controls-strikethrough",type:"button",title:"Strikethrough",children:"strikethrough"}),(0,i.jsx)("button",{onClick:function(e){e.preventDefault(),K(hr)},css:Pr,style:{fontFamily:"monospace"},"data-link-name":"formatting-controls-code",type:"button",title:"Code",children:"<code>"}),(0,i.jsx)("button",{onClick:function(e){e.preventDefault(),K(gr)},css:Pr,"data-link-name":"formatting-controls-quote",type:"button",title:"Quote",children:'"quote"'}),(0,i.jsx)("button",{onClick:function(e){e.preventDefault(),function(){var e=prompt("Your URL:","http://www.");if(null!==e){var r=q();if(r){var t=r.startString,n=r.highlightedString,s=r.endString;H(t.concat(function(e,r){return'<a href="'.concat(e,'" rel="nofollow">').concat(r||e,"</a>")}(e,n),s))}}}()},css:Pr,style:{textDecoration:"underline"},"data-link-name":"formatting-controls-link",type:"button",title:"Link",children:"Link"})]})]})]}),""!==g.trim()&&(0,i.jsx)(or,{previewHtml:g,showSpout:!0})]})},Rr=function(e){var r=e.amount;return(0,i.jsx)("div",{css:(0,c.css)("width:",u.x[r],"px;")})},Fr=(0,c.css)("width:18px;svg{fill:",(0,v.M)("--discussion-subdued"),"!important;}"),Ur=(0,c.css)(y.PSs,";line-height:19px;"),zr=(0,c.css)(y.yui,";margin-top:0px;margin-bottom:",u.x[2],"px;"),Dr=(0,c.css)("padding-top:",u.x[3],"px;padding-bottom:",u.x[3],"px;padding-left:",u.x[5],"px;padding-right:",u.x[5],"px;background-color:",(0,v.M)("--discussion-top-pick-background"),";margin-top:",15,"px;margin-bottom:",20,"px;position:relative;display:flex;flex-direction:column;:before{content:'';position:absolute;border-left:",15,"px solid ",(0,v.M)("--discussion-top-pick-background"),";border-top:",15,"px solid transparent;top:-",14,"px;margin-left:",u.x[9],"px;}"),Lr=(0,c.css)("p{",y.PSs,";margin-top:0px;margin-bottom:",u.x[3],"px;}"),Nr=(0,c.css)("color:",(0,v.M)("--discussion-link"),";"),Br=(0,c.css)("button{color:",(0,v.M)("--discussion-accent-text"),";background-color:transparent;height:18px;min-height:18px;border-radius:0;:hover{text-decoration:underline;text-decoration-color:",(0,v.M)("--discussion-accent-text"),";}}"),Yr=(0,c.css)("button{color:",(0,v.M)("--discussion-subdued"),";background-color:transparent;height:18px;min-height:18px;border-radius:0;:hover{text-decoration:underline;text-decoration-color:",(0,v.M)("--discussion-subdued"),";}}"),_r=function(e){var r=e.commentBeingRepliedTo,t=(0,m.useState)(!1),n=(0,o.A)(t,2),s=n[0],a=n[1];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(pe,{children:[(0,i.jsx)("div",{css:Fr,children:(0,i.jsx)(E.Z,{})}),(0,i.jsx)(Rr,{amount:1}),(0,i.jsx)("div",{css:Ur,children:r.userProfile.displayName}),(0,i.jsx)(Rr,{amount:3}),(0,i.jsx)("div",{css:[Br,(0,c.css)("button{",y.yui,";}")],children:(0,i.jsx)(A.$,{priority:"subdued",onClick:function(){return a(!s)},"data-link-name":s?"reply-comment-hide":"reply-comment-show",children:s?"Hide Comment":"Show comment"})})]}),s&&(0,i.jsx)(Hr,{commentBeingRepliedTo:r,setDisplayReplyComment:a,displayReplyComment:s})]})},Hr=function(e){var r=e.commentBeingRepliedTo,t=e.setDisplayReplyComment,n=e.displayReplyComment;return(0,i.jsxs)("div",{css:Dr,children:[(0,i.jsxs)("p",{css:zr,children:[r.userProfile.displayName," @"," ",r.date," said:"]}),(0,i.jsx)("div",{css:Lr,dangerouslySetInnerHTML:{__html:r.body||""}}),(0,i.jsx)("div",{css:[Yr,(0,c.css)("button{",y.PSs,";}")],children:(0,i.jsx)(A.$,{priority:"subdued",onClick:function(){return t(!n)},"data-link-name":"hide-comment",children:(0,i.jsx)("span",{css:Nr,children:"Hide Comment"})})})]})},qr=(0,c.css)("list-style-type:none;padding-left:",u.x[2],"px;margin-left:",u.x[12],"px;"),Kr=(0,c.css)("border-top:1px solid ",(0,v.M)("--discussion-border"),";"),Gr={name:"1nr1hck",styles:"list-style-type:none;padding-left:0"},Vr=(0,c.css)("background-color:",(0,v.M)("--discussion-selected-background"),";margin-left:-",u.x[2],"px;padding-left:",u.x[2],"px;margin-right:-",u.x[2],"px;padding-right:",u.x[2],"px;"),$r={name:"cfjpzu",styles:"margin:0px"},Wr=function(e){var r,t,s,a=e.comment,d=e.isClosedForComments,p=e.isClosedForRecommendations,f=e.user,h=e.shortUrl,g=e.threads,b=e.commentBeingRepliedTo,v=e.setCommentBeingRepliedTo,y=e.commentToScrollTo,j=e.mutes,k=e.toggleMuteStatus,w=e.onPermalinkClick,C=e.onPreview,P=e.error,M=e.setError,S=e.userNameMissing,I=e.setUserNameMissing,O=e.previewBody,E=e.setPreviewBody,A=e.reportAbuse,T=e.expandCommentReplies,R=e.isExpanded,F=a.responses?a.responses:[],U=null!==(r=null===(t=a.metaData)||void 0===t?void 0:t.responseCount)&&void 0!==r?r:0,z=F.length>=U,D=(0,m.useState)(!1),L=(0,o.A)(D,2),N=L[0],B=L[1],Y="unthreaded"!==g&&F.length>0;return(0,i.jsxs)("div",{css:[y===a.id&&Vr],children:[(0,i.jsx)(Qe,{comment:a,isClosedForComments:d,isClosedForRecommendations:p,setCommentBeingRepliedTo:v,user:f,isReply:!1,isMuted:j.includes(a.userProfile.userId),toggleMuteStatus:k,onPermalinkClick:w,reportAbuse:A,isExpanded:R}),(0,i.jsxs)(i.Fragment,{children:[Y&&F.length>0&&(0,i.jsxs)("div",{css:qr,children:[(0,i.jsx)("ul",{css:[Gr,$r],children:F.map((function(e){return(0,i.jsx)("li",{children:(0,i.jsx)(Qe,{comment:e,isClosedForComments:d,isClosedForRecommendations:p,setCommentBeingRepliedTo:v,user:f,isReply:!0,wasScrolledTo:y===e.id,isMuted:j.includes(e.userProfile.userId),toggleMuteStatus:k,onPermalinkClick:w,reportAbuse:A,isExpanded:R})},e.id)}))}),!z&&(0,i.jsx)("div",{css:[Kr,(0,c.css)("padding-top:",u.x[3],"px;padding-bottom:",u.x[3],"px;")],children:(0,i.jsx)(tr,{priority:"secondary",icon:(0,i.jsx)(l.D,{}),iconSide:"left",linkName:"Show more replies",onClick:function(){return e=a.id,B(!0),void(0,x.EE)(e).then((function(r){"error"!==r.kind?T(e,r.value):console.error(r.error)})).catch((function(){})).finally((function(){B(!1)}));var e},size:"xsmall",children:N?"loading...":(s=U-F.length,1===s?"Show 1 more reply":"Show ".concat(s," more replies"))})})]}),b&&(b.id===a.id||F.find((function(e){return e.id===b.id})))&&f&&(0,i.jsxs)("div",{id:"comment-reply-form-".concat(b.id),css:qr,children:[(0,i.jsx)(_r,{commentBeingRepliedTo:b}),(0,i.jsx)(Tr,{shortUrl:h,onAddComment:function(e){"responses"in e||function(e,r){T(e,[].concat((0,n.A)(F),[r]))}(a.id,e)},user:f,setCommentBeingRepliedTo:v,commentBeingRepliedTo:b,onPreview:C,error:P,setError:M,userNameMissing:S,setUserNameMissing:I,previewBody:O,setPreviewBody:E})]})]})]})},Jr={name:"bjn8wh",styles:"position:relative"},Xr=(0,c.css)("z-index:2;list-style:none;border:1px solid ",(0,v.M)("--discussion-border"),";margin-left:-8px;padding:0px;display:none;background-color:",(0,v.M)("--discussion-background"),";position:absolute;",I.TG.tablet,"{margin-top:4px;border-radius:0;overflow:auto;}",I.HT.tablet,"{margin-top:12px;border-radius:3px;}"),Zr={name:"4zleql",styles:"display:block"},Qr={name:"1i9vogi",styles:"margin-top:0"},et=(0,c.css)("font-weight:bold;:after{content:'';border:2px solid ",(0,v.M)("--discussion-accent-text"),";border-top:0px;border-right:0px;position:absolute;top:12px;right:12px;width:8px;height:4px;transform:rotate(-45deg);}"),rt=(0,c.css)(y.PSs,";font-weight:500;display:block;cursor:pointer;background:none;border:none;line-height:1.2;color:",(0,v.M)("--discussion-subdued"),";transition:color 80ms ease-out;padding:0px 10px 6px 0px;margin:1px 0 0;text-decoration:none;:hover{:after{transform:translateY(0) rotate(45deg);}}:after{content:'';display:inline-block;width:5px;height:5px;transform:translateY(-2px) rotate(45deg);border:1px solid currentColor;border-left:transparent;border-top:transparent;margin-left:5px;vertical-align:middle;transition:transform 250ms ease-out;}"),tt={name:"1baa2f8",styles:":hover:after{transform:translateY(-1px) rotate(-135deg);}:after{transform:translateY(1px) rotate(-135deg);}"},nt=(0,c.css)(y.yui,";color:",(0,v.M)("--discussion-subdued"),";"),st=function(e){var r=e.id,t=e.label,n=e.options,s=e.onSelect,a=(0,m.useState)(!1),d=(0,o.A)(a,2),u=d[0],l=d[1];(0,m.useEffect)((function(){var e=function(e){u&&"Escape"===e.code&&l(!1)};return document.addEventListener("keydown",e,!1),function(){return document.removeEventListener("keydown",e)}}),[u]),(0,m.useEffect)((function(){var e=function(e){u&&(e.stopPropagation(),l(!1))};return document.addEventListener("click",e,!1),function(){return document.removeEventListener("click",e)}}),[u]);var p="dropbox-id-".concat(r),x=n.find((function(e){return e.isActive}));return(0,i.jsxs)("div",{css:Jr,children:[(0,i.jsxs)("div",{css:nt,children:[t,(0,i.jsx)("button",{onClick:function(){return l(!u)},css:[rt,u&&tt],"aria-controls":p,"aria-expanded":u?"true":"false",type:"button",children:x?x.title:"Please select"})]}),(0,i.jsx)("ul",{id:p,css:[Xr,u&&Zr],children:n.map((function(e,r){return(0,i.jsx)("li",{children:(0,i.jsx)("button",{onClick:function(){return s(e.value)},css:[(t=!!e.disabled,(0,c.css)(y.PSs,";text-align:left;color:",t?(0,v.M)("--discussion-text"):(0,v.M)("--discussion-subdued"),";position:relative;text-decoration:none;margin-top:1px;padding-top:8px;padding-right:30px;padding-bottom:8px;padding-left:8px;width:100%;cursor:",t?"default":"pointer",";background-color:white;border:none;",!t&&"\n    :hover {\n      background-color: ".concat((0,v.M)("--discussion-background"),";\n      text-decoration: underline;\n    }\n\n    :focus {\n      text-decoration: underline;\n    }\n  "),";")),e.isActive&&et,0===r&&Qr],disabled:!!e.isActive||!!e.disabled,type:"button",children:e.title})},e.title);var t}))})]})};function ot(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function it(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ot(Object(t),!0).forEach((function(r){(0,s.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ot(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ct,at=(0,c.css)("padding-top:",u.x[1],"px;padding-bottom:",u.x[2],"px;border-top:1px solid ",(0,v.M)("--discussion-border"),";display:flex;flex-direction:row;"),dt=(0,c.css)("position:relative;margin-left:",u.x[2],"px;:after{content:'';display:block;width:1px;background-color:",(0,v.M)("--discussion-border"),";position:absolute;top:-",u.x[1],"px;bottom:",u.x[1],"px;left:-",u.x[2],"px;}"),ut=(0,c.css)("padding-right:",u.x[3],"px;"),lt=function(e){var r=e.filters,t=e.onFilterChange,n=e.topLevelCommentCount;return(0,i.jsxs)("div",{id:"comment-filters",css:at,children:[(0,i.jsx)("div",{css:ut,children:(0,i.jsx)(st,{id:"order-by-dropdown",label:"Sort by",options:[{title:"Newest",value:"newest",isActive:"newest"===r.orderBy},{title:"Oldest",value:"oldest",isActive:"oldest"===r.orderBy},{title:"Recommendations",value:"recommendations",isActive:"recommendations"===r.orderBy}],onSelect:function(e){return t(it(it({},r),{},{orderBy:e}))}})}),(0,i.jsx)("div",{css:dt}),(0,i.jsx)("div",{css:ut,children:(0,i.jsx)(st,{id:"page-size-dropdown",label:"Per page",options:[{title:"25",value:"25",disabled:n<=25,isActive:25===r.pageSize},{title:"50",value:"50",disabled:n<=50,isActive:50===r.pageSize},{title:"100",value:"100",disabled:n<=100,isActive:100===r.pageSize}],onSelect:function(e){return t(it(it({},r),{},{pageSize:parseInt(e)}))}})}),(0,i.jsx)("div",{css:dt}),(0,i.jsx)("div",{css:ut,children:(0,i.jsx)(st,{id:"threads-dropdown",label:"Display threads",options:[{title:"Collapsed",value:"collapsed",isActive:"collapsed"===r.threads},{title:"Expanded",value:"expanded",isActive:"expanded"===r.threads},{title:"Unthreaded",value:"unthreaded",isActive:"unthreaded"===r.threads}],onSelect:function(e){return t(it(it({},r),{},{threads:e}))}})})]})},mt=t(34660),pt=(0,v.M)("--discussion-loading-background"),xt=(0,c.keyframes)(ct||(ct=(0,mt.A)(["\n  0% {\n    background-position: -1500px 0;\n  }\n  100% {\n    background-position: 1500px 0;\n  }\n"]))),ft=(0,c.css)("animation:",xt," 2s infinite linear;background:linear-gradient(\n\t\tto right,\n\t\t",pt," 4%,\n\t\t",(0,v.M)("--discussion-loading-shimmer")," 25%,\n\t\t",pt," 36%\n\t);background-size:1500px 100%;"),ht=(0,c.css)("border-bottom:1px solid ",(0,v.M)("--discussion-border"),";width:620px;display:flex;padding:",u.x[2],"px 0;"),gt=function(e){var r=e.height,t=e.width,n=e.spaceBelow,s=e.spaceLeft;return(0,i.jsx)("div",{css:(0,c.css)("height:",r,"px;width:",(0,d.b)(t)||0===t||isNaN(t)?"100%":"".concat(t,"px"),";margin-bottom:",n&&u.x[n],"px;margin-left:",s&&u.x[s],"px;background-color:",pt,";",ft,";")})},bt=function(){return(0,i.jsxs)("div",{css:ht,"data-testid":"loading-comments",children:[(0,i.jsx)("div",{css:(48,(0,c.css)("border-radius:",58,"px;width:",48,"px;height:",48,"px;background-color:",pt,";margin-right:",u.x[2],"px;",ft,";"))}),(0,i.jsxs)(ue,{children:[(0,i.jsxs)(pe,{children:[(0,i.jsx)(gt,{height:20,width:140,spaceBelow:9}),(0,i.jsx)(gt,{height:15,width:100,spaceBelow:9,spaceLeft:2})]}),(0,i.jsx)(gt,{height:20,spaceBelow:1}),(0,i.jsx)(gt,{height:20,spaceBelow:1}),(0,i.jsx)(gt,{height:20,width:200,spaceBelow:5}),(0,i.jsxs)(pe,{children:[(0,i.jsx)(gt,{height:15,width:40}),(0,i.jsx)(gt,{height:15,width:40,spaceLeft:6})]})]})]})},vt=t(30526),yt=t(73951),jt=function(e){return(0,c.css)("cursor:pointer;",y.yui," text-decoration:none;border-radius:62.5rem;box-sizing:border-box;color:",e?(0,v.M)("--discussion-pagination-background"):(0,v.M)("--discussion-pagination-text"),";background-color:",e?(0,v.M)("--discussion-pagination-text"):"transparent",";border:none;:hover{border-width:0.0625rem;border-style:solid;border-color:",(0,v.M)("--discussion-pagination-text"),";}margin-right:2px;padding:0 0.125rem;min-width:1.5rem;text-align:center;height:1.5rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;")},kt={borderTertiary:(0,v.M)("--discussion-pagination-border"),backgroundTertiaryHover:(0,v.M)("--discussion-pagination-background"),textTertiary:(0,v.M)("--discussion-pagination-text")},wt={name:"2pxq96",styles:"line-height:26px;margin-right:2px"},Ct=(0,c.css)(y.PSs,";color:",(0,v.M)("--discussion-pagination-text"),";display:flex;flex-direction:row;justify-content:space-between;padding:",u.x[2],"px 0;border-top:1px solid ",(0,v.M)("--discussion-pagination-border"),";",I.TG.mobileLandscape,"{flex-direction:column;}"),Pt=(0,c.css)("display:flex;flex-direction:row;height:25px;button:hover{border-color:",(0,v.M)("--discussion-pagination-border-hover"),";}"),Mt=(0,c.css)(y.PSs,";margin-left:5px;",I.TG.mobileLandscape,"{padding-top:10px;}"),St=function(e){var r=e.currentPage,t=e.setCurrentPage;return(0,i.jsx)(A.$,{onClick:function(){return t(r+1)},"data-link-name":"Pagination view page ".concat(r+1),size:"xsmall",priority:"tertiary",theme:kt,cssOverrides:(0,c.css)("background-color:",(0,v.M)("--discussion-pagination-background"),";svg{transform:translateX(1px);}"),icon:(0,i.jsx)(vt.s,{theme:{fill:(0,v.M)("--discussion-pagination-text")}}),hideLabel:!0,children:"Previous discussion page"})},It=function(e){var r=e.currentPage,t=e.setCurrentPage;return(0,i.jsx)(A.$,{onClick:function(){return t(r-1)},"data-link-name":"Pagination view page ".concat(r-1),size:"xsmall",priority:"tertiary",theme:kt,cssOverrides:(0,c.css)("background-color:",(0,v.M)("--discussion-pagination-background"),";svg{transform:translateX(-1px);}"),icon:(0,i.jsx)(yt.P,{theme:{fill:(0,v.M)("--discussion-pagination-text")}}),hideLabel:!0,children:"Previous discussion page"})},Ot=function(e){var r=e.currentPage,t=e.setCurrentPage,n=e.isSelected;return(0,i.jsx)("button",{css:jt(n),onClick:function(){return t(r)},"data-link-name":"Pagination view page ".concat(r),type:"button",children:r},r)},Et=function(e,r){return r<=6?[1,2,3,4,5,6].filter((function(e){return e<=r})):e<=3?[1,2,3,4,"…",r]:e<=r-3?[1,"…",e-1,e,e+1,"…",r]:[1,"…",r-3,r-2,r-1,r]},At=function(e){var r=e.currentPage,t=e.setCurrentPage,n=e.topLevelCommentCount,s=e.filters,o=Math.ceil(n/s.pageSize),c=o>4&&r>1,a=o>4&&r!==o,d=s.pageSize,u=1+d*(r-1),l=Math.min(d*r,n);return(0,i.jsxs)("div",{css:Ct,children:[(0,i.jsxs)("div",{css:Pt,children:[c&&(0,i.jsx)(It,{currentPage:r,setCurrentPage:t}),Et(r,o).map((function(e,n){return"…"===e?(0,i.jsx)("div",{css:wt,children:"…"},1===n?"first-ellipsis":"last-ellipsis"):(0,i.jsx)(Ot,{currentPage:e,setCurrentPage:t,isSelected:e===r},"page-".concat(e))})),a&&(0,i.jsx)(St,{currentPage:r,setCurrentPage:t})]}),(0,i.jsx)("div",{css:Mt,children:"Displaying ".concat("unthreaded"===s.threads?"comments":"threads"," ").concat(u," to ").concat(l," of ").concat(n)})]})},Tt=(0,c.css)("display:flex;flex-direction:column;width:100%;min-width:250px;margin-bottom:",u.x[5],"px;",y.PSs,";blockquote{margin-top:",u.x[3],"px;margin-bottom:",u.x[3],"px;margin-left:",u.x[5],"px;margin-right:",u.x[5],"px;padding-left:",u.x[2],"px;color:",(0,v.M)("--discussion-subdued"),";}"),Rt=(0,c.css)("margin-top:3px;margin-bottom:-6px;font-weight:bold;color:",(0,v.M)("--discussion-accent-text"),";"),Ft=(0,c.css)("margin-right:",u.x[2],"px;"),Ut=(0,c.css)("a{",y.PSs,";}"),zt=(0,c.css)("color:",(0,v.M)("--discussion-top-pick-link"),";text-decoration:none;:hover{text-decoration:underline;color:",(0,v.M)("--discussion-top-pick-link"),";}"),Dt=(0,c.css)("color:",(0,v.M)("--discussion-top-pick-link"),";:hover{color:",(0,v.M)("--discussion-top-pick-link"),";}"),Lt=(0,c.css)("a{color:",(0,v.M)("--discussion-top-pick-link"),";text-decoration:none;:hover{text-decoration:underline;}}"),Nt=(0,c.css)(y.PSs,";font-weight:bold;margin:0px;margin-bottom:",u.x[1],"px;"),Bt={name:"opde7s",styles:"color:inherit"},Yt={name:"1sdjnkx",styles:"word-break:break-word"},_t=function(e){var r=e.children;return(0,i.jsx)("div",{css:(0,c.css)("display:flex;flex-direction:column;justify-content:space-between;padding:",u.x[3],"px;background-color:",(0,v.M)("--discussion-top-pick-background"),";border-radius:15px;margin-bottom:",30,"px;position:relative;",I.HT.tablet,"{min-height:150px;}:before{content:'';margin-left:",u.x[6],"px;position:absolute;border-right:",25,"px solid transparent;border-top:",25,"px solid ",(0,v.M)("--discussion-top-pick-background"),";bottom:-",24,"px;}p{margin-top:0;margin-bottom:",u.x[3],"px;}"),children:r})},Ht=function(e){var r=e.children;return(0,i.jsx)("div",{children:r})},qt=function(e){var r=e.children;return(0,i.jsx)("div",{children:r})},Kt=function(e){var r=e.children;return(0,i.jsx)("div",{css:(0,c.css)("display:flex;justify-content:space-between;padding-top:",u.x[1],"px;"),children:r})},Gt=function(e){var r,t=e.comment,n=e.user,s=e.userMadeComment,o=e.onPermalinkClick,c=e.isClosedForRecommendations,a=t.userProfile.badge.some((function(e){return"Staff"===e.name})),d=t.userProfile.badge.some((function(e){return"Contributor"===e.name}));return(0,i.jsxs)("div",{css:Tt,children:[(0,i.jsxs)(_t,{children:[(0,i.jsxs)(Ht,{children:[(0,i.jsx)("h3",{css:Nt,children:"Guardian Pick"}),(0,i.jsx)("p",{css:[Yt,Lt],dangerouslySetInnerHTML:{__html:(r=t.body,450,r.length>450?r.substr(0,450)+"&#8230;":r)}})]}),(0,i.jsx)(qt,{children:(0,i.jsx)("div",{css:Ut,children:(0,i.jsx)(O.N,{priority:"primary",href:t.webUrl,cssOverrides:Dt,onClick:function(e){o(t.id),e.preventDefault()},rel:"nofollow",children:"Jump to comment"})})})]}),(0,i.jsxs)(Kt,{children:[(0,i.jsxs)(pe,{children:[(0,i.jsx)("div",{css:Ft,children:(0,i.jsx)(ee,{imageUrl:t.userProfile.avatar,displayName:"",size:"medium"})}),(0,i.jsxs)(ue,{children:[(0,i.jsx)("span",{css:Rt,children:(0,i.jsx)("a",{href:t.userProfile.webUrl,css:[zt,Bt],rel:"nofollow",children:t.userProfile.displayName})}),(0,i.jsx)(ke,{isoDateTime:t.isoDateTime,webUrl:t.webUrl,commentId:t.id,onPermalinkClick:o}),a&&(0,i.jsx)(ie,{}),d&&!a&&(0,i.jsx)(ce,{})]})]}),(0,i.jsx)(ge,{commentId:t.id,initialCount:t.numRecommends,alreadyRecommended:!1,user:n,userMadeComment:s,isClosedForRecommendations:c})]})]})};function Vt(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var $t={name:"1vpe7s3",styles:"width:50%;display:flex;flex-direction:column"},Wt={name:"qzmnd2",styles:"padding-right:10px"},Jt={name:"vnst0l",styles:"padding-left:10px"},Xt={name:"798ujy",styles:"width:100%;display:flex;flex-wrap:wrap"},Zt=(0,c.css)("width:100%;display:flex;flex-direction:row;",I.TG.tablet,"{display:none;}"),Qt=(0,c.css)("width:100%;",I.HT.tablet,"{display:none;}"),en=function(e){var r,t=e.user,n=e.comments,s=e.onPermalinkClick,c=e.isClosedForRecommendations,a=[],d=[],u=function(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return Vt(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Vt(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,s=function(){};return{s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}(n.entries());try{for(u.s();!(r=u.n()).done;){var l=(0,o.A)(r.value,2),m=l[0],p=l[1];m%2==0?a.push(p):d.push(p)}}catch(e){u.e(e)}finally{u.f()}return(0,i.jsxs)("div",{css:Xt,children:[(0,i.jsxs)("div",{css:Zt,children:[(0,i.jsx)("div",{css:[$t,Wt],children:a.map((function(e){return(0,i.jsx)(Gt,{comment:e,user:t,userMadeComment:(null==t?void 0:t.profile.userId)===e.userProfile.userId,onPermalinkClick:s,isClosedForRecommendations:c},e.id)}))}),(0,i.jsx)("div",{css:[$t,Jt],children:d.map((function(e){return(0,i.jsx)(Gt,{comment:e,user:t,userMadeComment:(null==t?void 0:t.profile.userId)===e.userProfile.userId,onPermalinkClick:s,isClosedForRecommendations:c},e.id)}))})]}),(0,i.jsx)("div",{css:Qt,children:n.map((function(e){return(0,i.jsx)(Gt,{comment:e,userMadeComment:(null==t?void 0:t.profile.userId)===e.userProfile.userId,onPermalinkClick:s,isClosedForRecommendations:c},e.id)}))})]})},rn={name:"skgbeu",styles:"display:flex;justify-content:flex-end"},tn={name:"x3a67h",styles:"display:flex;flex-direction:column;max-width:100%"},nn={name:"fexp4f",styles:"display:flex;flex-direction:column;list-style-type:none;padding-left:0;margin:0"},sn={name:"1f3egm3",styles:"display:flex;flex-wrap:wrap;justify-content:space-between"},on=function(){return(0,i.jsx)("div",{css:(0,c.css)("color:",(0,v.M)("--discussion-subdued"),";",y.PSs," padding-top:",u.x[5],"px;padding-left:",u.x[1],"px;padding-bottom:",u.x[9],"px;"),children:"No comments found"})},cn=function(){return document.dispatchEvent(new CustomEvent("comments-state-change"))},an=function(e){var r=e.baseUrl,t=e.shortUrl,s=e.isClosedForComments,c=e.isClosedForRecommendations,u=e.commentToScrollTo,l=e.user,p=e.additionalHeaders,h=e.expanded,g=e.onPermalinkClick,b=e.apiKey,v=e.onPreview,y=e.idApiUrl,k=e.page,C=e.filters,P=e.topLevelCommentCount,M=e.loading,S=e.comments,I=e.topForm,O=e.replyForm,E=e.bottomForm,A=e.reportAbuse,T=(0,m.useState)([]),R=(0,o.A)(T,2),F=R[0],U=R[1],z=(0,m.useState)(),D=(0,o.A)(z,2),L=D[0],N=D[1],B=(0,m.useState)(function(){var e,r=null!==(e=a.I.local.get("gu.prefs.discussion.mutes"))&&void 0!==e?e:[];return Array.isArray(r)&&r.every(f.K)?r:[]}()),Y=(0,o.A)(B,2),_=Y[0],H=Y[1],q="Web"===(0,j.U)().renderingTarget,K=(0,m.useContext)(w),G=function(e,r){K({type:"filterChange",filters:e,commentPage:r})},V=function(e){return K({type:"setReplyFormUserMissing",userNameMissing:e})},$=function(e){return K({type:"setReplyFormError",error:e})},W=function(e){return K({type:"setReplyFormPreviewBody",previewBody:e})},J=function(e,r){return K({type:"expandCommentReplies",commentId:e,responses:r})};(0,m.useEffect)((function(){if(q&&h&&!M){var e=new CustomEvent("comments-loaded");document.dispatchEvent(e)}}),[q,h,M]),(0,m.useEffect)((function(){(0,x.tn)(t).then((function(e){"error"!==e.kind?U(e.value):console.error(e.error)}))}),[t]),(0,m.useEffect)((function(){var e;(0,d.b)(u)||M||null===(e=document.getElementById("comment-".concat(u)))||void 0===e||e.scrollIntoView()}),[u,M]);var X=function(e){var r=Math.ceil(P/e.pageSize);k>r?G(e,r):G(e),q&&cn()};(0,m.useEffect)((function(){var e=document.getElementById("comment-filters");null==e||e.scrollIntoView()}),[k]),(0,m.useEffect)((function(){!function(e){a.I.local.set("gu.prefs.discussion.mutes",e)}(_)}),[_]);var Z=function(e){var r=_.includes(e)?_.filter((function(r){return r!==e})):[].concat((0,n.A)(_),[e]);H(r)},Q=function(e){e.responses?function(e){K({type:"addComment",comment:e})}(e):function(e){K({type:"addReply",comment:e})}(e);var r=document.getElementById("comment-".concat(e.id));null==r||r.scrollIntoView()},ee=function(e){K({type:"updateCommentPage",commentPage:e}),q&&cn()};(0,x.cU)({additionalHeaders:p,baseUrl:r,apiKey:b,idApiUrl:y});var re=P>C.pageSize;return!h&&M?(0,i.jsx)("span",{"data-testid":"loading-comments"}):h?(0,i.jsxs)("div",{"data-component":"discussion",css:tn,children:[l&&!s&&(0,i.jsx)(Tr,{shortUrl:t,onAddComment:Q,user:l,onPreview:v,error:I.error,setError:function(e){return K({type:"setTopFormError",error:e})},userNameMissing:I.userNameMissing,setUserNameMissing:function(e){return K({type:"setTopFormUserMissing",userNameMissing:e})},previewBody:I.previewBody,setPreviewBody:function(e){return K({type:"setTopFormPreviewBody",previewBody:e})}}),!!F.length&&(0,i.jsx)(en,{comments:F,user:l,onPermalinkClick:g,isClosedForRecommendations:c}),(0,i.jsx)(lt,{filters:C,onFilterChange:X,topLevelCommentCount:P}),re&&(0,i.jsx)(At,{currentPage:k,setCurrentPage:ee,topLevelCommentCount:P,filters:C}),M?(0,i.jsx)(bt,{}):S.length?(0,i.jsx)("ul",{css:[nn],"data-commercial-id":"comments-column",children:S.map((function(e){return(0,i.jsx)("li",{children:(0,i.jsx)(Wr,{comment:e,isClosedForComments:s,isClosedForRecommendations:c,shortUrl:t,user:l,threads:C.threads,commentBeingRepliedTo:L,setCommentBeingRepliedTo:N,commentToScrollTo:u,mutes:_,toggleMuteStatus:Z,onPermalinkClick:g,error:O.error,setError:$,userNameMissing:O.userNameMissing,setUserNameMissing:V,previewBody:O.previewBody,setPreviewBody:W,reportAbuse:A,expandCommentReplies:J,isExpanded:h})},e.id)}))}):(0,i.jsx)(on,{}),re&&(0,i.jsx)("footer",{css:rn,children:(0,i.jsx)(At,{currentPage:k,setCurrentPage:ee,topLevelCommentCount:P,filters:C})}),l&&!s&&S.length>10&&(0,i.jsx)(Tr,{shortUrl:t,onAddComment:Q,user:l,onPreview:v,error:E.error,setError:function(e){return K({type:"setBottomFormError",error:e})},userNameMissing:E.userNameMissing,setUserNameMissing:function(e){return K({type:"setBottomFormUserMissing",userNameMissing:e})},previewBody:E.previewBody,setPreviewBody:function(e){return K({type:"setBottomFormPreviewBody",previewBody:e})}})]}):(0,i.jsx)("div",{"data-component":"discussion",css:nn,children:0!==F.length?(0,i.jsx)("div",{css:sn,children:(0,i.jsx)(en,{comments:F.slice(0,2),user:l,onPermalinkClick:g,isClosedForRecommendations:c})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(lt,{filters:C,onFilterChange:X,topLevelCommentCount:P}),re&&(0,i.jsx)(At,{currentPage:k,setCurrentPage:ee,topLevelCommentCount:P,filters:C}),S.length?(0,i.jsx)("ul",{css:nn,children:S.slice(0,2).map((function(e){return(0,i.jsx)("li",{children:(0,i.jsx)(Wr,{comment:e,isClosedForComments:s,isClosedForRecommendations:c,shortUrl:t,user:l,threads:C.threads,commentBeingRepliedTo:L,setCommentBeingRepliedTo:N,mutes:_,toggleMuteStatus:Z,onPermalinkClick:g,error:O.error,setError:$,userNameMissing:O.userNameMissing,setUserNameMissing:V,previewBody:O.previewBody,setPreviewBody:W,reportAbuse:A,expandCommentReplies:J,isExpanded:h})},e.id)}))}):(0,i.jsx)(on,{})]})})},dn=t(18644),un=t(39841);function ln(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function mn(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ln(Object(t),!0).forEach((function(r){(0,s.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ln(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var pn,xn,fn,hn,gn=(0,c.css)("background-image:linear-gradient(\n\t\t0deg,\n\t\t",(0,v.M)("--discussion-section-background"),",\n\t\t",(0,v.M)("--discussion-section-background")," 40%,\n\t\ttransparent\n\t);height:80px;position:absolute;bottom:0;right:0;width:100%;display:block;"),bn={name:"xdxtqc",styles:"max-height:280px;min-height:280px;overflow:hidden"},vn={name:"bjn8wh",styles:"position:relative"},yn=function(e,r){return r?"collapsed"!==e.threads?e:mn(mn({},e),{},{threads:"expanded"}):e},jn=function(e){return function(r){return r.id===e.commentId?mn(mn({},r),{},{responses:e.responses}):r}},kn={isActive:!1,userNameMissing:!1,error:"",showPreview:!1,previewBody:"",body:""},wn={comments:[],isClosedForComments:!1,isClosedForRecommendation:!1,isExpanded:!1,commentPage:1,commentCount:void 0,topLevelCommentCount:0,filters:(pn=a.I.local.get("gu.prefs.discussion.order"),xn=(0,f.K)(pn)&&(0,h.E)(["newest","oldest","recommendations"])(pn)?pn:"newest",fn=function(e){return(0,f.K)(e)&&(0,h.E)(g)(e)?e:"collapsed"}(a.I.local.get("gu.prefs.discussion.threading")),hn=function(e){return"number"==typeof e&&(0,h.E)(b)(e)?e:25}(a.I.local.get("gu.prefs.discussion.pagesize")),{orderBy:xn,threads:fn,pageSize:hn}),hashCommentId:void 0,loading:!0,topForm:kn,replyForm:kn,bottomForm:kn},Cn=function(e,r){var t;switch(r.type){case"commentsLoaded":return mn(mn({},e),{},{comments:r.comments,isClosedForComments:r.isClosedForComments,isClosedForRecommendation:r.isClosedForRecommendation,commentCount:r.commentCount,topLevelCommentCount:r.topLevelCommentCount,loading:!1});case"addComment":return mn(mn({},e),{},{comments:[r.comment].concat((0,n.A)(e.comments)),isExpanded:!0});case"addReply":return mn(mn({},e),{},{comments:e.comments.map((function(e){return e.responses&&e.id===r.comment.responseTo.commentId?mn(mn({},e),{},{responses:[].concat((0,n.A)(e.responses),[r.comment])}):e})),isExpanded:!0});case"expandComments":return mn(mn({},e),{},{isExpanded:!0});case"updateCommentPage":return mn(mn({},e),{},{commentPage:r.commentPage,isExpanded:!0});case"filterChange":return mn(mn({},e),{},{filters:r.filters,hashCommentId:void 0,isExpanded:!0,commentPage:null!==(t=r.commentPage)&&void 0!==t?t:e.commentPage});case"setLoading":return mn(mn({},e),{},{loading:r.loading});case"updateHashCommentId":return mn(mn({},e),{},{hashCommentId:r.hashCommentId,isExpanded:!0});case"setTopFormUserMissing":return mn(mn({},e),{},{topForm:mn(mn({},e.topForm),{},{userNameMissing:r.userNameMissing})});case"setReplyFormUserMissing":return mn(mn({},e),{},{replyForm:mn(mn({},e.replyForm),{},{userNameMissing:r.userNameMissing})});case"setBottomFormUserMissing":return mn(mn({},e),{},{bottomForm:mn(mn({},e.bottomForm),{},{userNameMissing:r.userNameMissing})});case"setTopFormPreviewBody":return mn(mn({},e),{},{topForm:mn(mn({},e.topForm),{},{previewBody:r.previewBody})});case"setReplyFormPreviewBody":return mn(mn({},e),{},{replyForm:mn(mn({},e.replyForm),{},{previewBody:r.previewBody})});case"setBottomFormPreviewBody":return mn(mn({},e),{},{bottomForm:mn(mn({},e.bottomForm),{},{previewBody:r.previewBody})});case"setTopFormError":return mn(mn({},e),{},{topForm:mn(mn({},e.topForm),{},{error:r.error})});case"setReplyFormError":return mn(mn({},e),{},{replyForm:mn(mn({},e.replyForm),{},{error:r.error})});case"setBottomFormError":return mn(mn({},e),{},{bottomForm:mn(mn({},e.bottomForm),{},{error:r.error})});case"expandCommentReplies":return mn(mn({},e),{},{isExpanded:!0,comments:e.comments.map(jn(r))});default:return(0,p.d)(r),e}},Pn=function(e){var r=e.discussionApiUrl,t=e.shortUrlId,n=e.discussionD2Uid,s=e.discussionApiClientHeader,p=e.enableDiscussionSwitch,f=e.user,h=e.idApiUrl,g=e.reportAbuseUnauthenticated,b=(0,m.useReducer)(Cn,wn),v=(0,o.A)(b,2),y=v[0],j=y.comments,k=y.isClosedForComments,w=y.isClosedForRecommendation,P=y.isExpanded,M=y.commentPage,S=y.filters,I=y.hashCommentId,O=y.loading,E=y.topForm,A=y.replyForm,T=y.bottomForm,R=y.topLevelCommentCount,F=y.commentCount,U=v[1];(0,m.useEffect)((function(){var e=function(){var e=window.location.hash;if(e.includes("comment")){var r=e.split("-"),t=(0,o.A)(r,2)[1];if(t)return t}}();(0,d.b)(e)||U({type:"updateHashCommentId",hashCommentId:e})}),[]),(0,m.useEffect)((function(){U({type:"setLoading",loading:!0});var e=new AbortController;return(0,x.Pu)({shortUrl:t,page:M,filters:yn(S,I),signal:e.signal}).then((function(e){if("error"!==e.kind){var r=e.value.discussion;U({type:"commentsLoaded",comments:r.comments,isClosedForComments:r.isClosedForComments,isClosedForRecommendation:r.isClosedForRecommendation,topLevelCommentCount:r.topLevelCommentCount,commentCount:r.commentCount})}else"AbortedSignal"!==e.error&&console.error("getDiscussion - error: ".concat(e.error))})).catch((function(){})),function(){return e.abort()}}),[M,S,I,t]);var z=yn(S,I);return(0,m.useEffect)((function(){!function(e){var r=e.threads,t=e.pageSize,n=e.orderBy;a.I.local.set("gu.prefs.discussion.threading",r),a.I.local.set("gu.prefs.discussion.pagesize",t),a.I.local.set("gu.prefs.discussion.order",n)}(S)}),[S]),(0,m.useEffect)((function(){(0,d.b)(I)||(0,x.zy)(r,I,yn(S,I)).then((function(e){"ok"===e.kind?U({type:"updateCommentPage",commentPage:e.value.page}):console.error("getCommentContext - error: ".concat(e.error))})).catch((function(e){return console.error("getCommentContext - error: ".concat(String(e)))}))}),[S,r,I]),(0,m.useEffect)((function(){"#comments"===window.location.hash&&U({type:"expandComments"})}),[]),(0,m.useEffect)((function(){0!==F&&1!==F&&2!==F||U({type:"expandComments"})}),[F]),(0,i.jsxs)(C,{value:U,children:[(0,i.jsxs)("div",{css:[vn,!P&&bn],children:[(0,i.jsx)(dn.L,{when:"above",breakpoint:"leftCol",children:(0,i.jsx)("div",{"data-testid":"discussion",css:(0,c.css)("padding-bottom:",u.x[2],"px;"),children:(0,i.jsx)(un.C,{enableDiscussionSwitch:p,user:null==f?void 0:f.profile,commentCount:F,isClosedForComments:k})})}),(0,i.jsx)(an,{user:f,baseUrl:r,isClosedForComments:!!k||!p,isClosedForRecommendations:!!w,shortUrl:t,additionalHeaders:{"D2-X-UID":n,"GU-Client":s},expanded:P,commentToScrollTo:I,onPermalinkClick:function(e){return window.location.hash="#comment-".concat(e),U({type:"updateHashCommentId",hashCommentId:e}),!1},apiKey:"dotcom-rendering",idApiUrl:h,page:M,filters:z,topLevelCommentCount:R,loading:O,comments:j,topForm:E,replyForm:A,bottomForm:T,reportAbuse:(0,d.b)(f)?g:f.reportAbuse}),!P&&(0,i.jsx)("div",{id:"discussion-overlay",css:gn})]}),!P&&(0,i.jsx)(tr,{onClick:function(){U({type:"expandComments"})},icon:(0,i.jsx)(l.D,{}),linkName:"view-more-comments",children:"View more comments"})]})}},18644:(e,r,t)=>{t.d(r,{L:()=>i});var n=t(50484),s=t(24017),o=t(81477),i=function(e){var r,t=e.children,i=e.when,c=e.breakpoint,a=e.el;return r="below"===i?(0,s.css)(o.TG[c],"{display:none;}"):(0,s.css)(o.HT[c],"{display:none;}"),"li"===a?(0,n.jsx)("li",{css:r,children:t}):(0,n.jsx)("span",{css:r,children:t})}},26124:(e,r,t)=>{t.d(r,{d:()=>n});var n=function(e){throw new Error("This should be unreachable")}},66781:(e,r,t)=>{t.d(r,{Bq:()=>P,HN:()=>h,L6:()=>m,MR:()=>w,Te:()=>g,mw:()=>c,nI:()=>k,pl:()=>M,qb:()=>x});var n=t(57364),s=t(20939),o=t(1948),i=(0,s.Ikc)({userId:(0,s.YjP)(),displayName:(0,s.YjP)(),webUrl:(0,s.YjP)(),apiUrl:(0,s.YjP)(),avatar:(0,s.YjP)(),secureAvatarUrl:(0,s.YjP)(),badge:(0,s.YOg)((0,s.Ikc)({name:(0,s.YjP)()})),privateFields:(0,s.lqM)((0,s.Ikc)({canPostComment:(0,s.zMY)(),isPremoderated:(0,s.zMY)(),hasCommented:(0,s.zMY)()}))}),c=function(e){var r=(0,s.xLC)((0,s.Ikc)({status:(0,s.euz)("ok"),userProfile:i}),e);return r.success?(0,o.ok)(r.output.userProfile):(0,o.z)("ParsingError")},a=(0,s.Ikc)({id:(0,s.pdi)((0,s.KCZ)([(0,s.aig)(),(0,s.YjP)()]),(function(e){return e.toString()})),body:(0,s.YjP)(),date:(0,s.YjP)(),isoDateTime:(0,s.YjP)(),status:(0,s.YjP)(),webUrl:(0,s.YjP)(),apiUrl:(0,s.YjP)(),numResponses:(0,s.lqM)((0,s.aig)()),numRecommends:(0,s.aig)(),isHighlighted:(0,s.zMY)(),userProfile:i,discussion:(0,s.lqM)((0,s.Ikc)({key:(0,s.YjP)(),webUrl:(0,s.YjP)(),apiUrl:(0,s.YjP)(),title:(0,s.YjP)(),isClosedForComments:(0,s.zMY)(),isClosedForRecommendation:(0,s.zMY)()})),metaData:(0,s.lqM)((0,s.Ikc)({commentCount:(0,s.aig)(),staffCommenterCount:(0,s.aig)(),editorsPickCount:(0,s.aig)(),blockedCount:(0,s.aig)(),responseCount:(0,s.aig)()}))}),d=(0,s.h1I)([a,(0,s.Ikc)({responses:(0,s.lqM)((0,s.Km6)(),void 0),responseTo:(0,s.Ikc)({displayName:(0,s.YjP)(),commentApiUrl:(0,s.YjP)(),isoDateTime:(0,s.YjP)(),date:(0,s.YjP)(),commentId:(0,s.YjP)(),commentWebUrl:(0,s.YjP)()})})]),u=(0,s.h1I)([a,(0,s.Ikc)({responses:(0,s.lqM)((0,s.YOg)(d),[]),responseTo:(0,s.lqM)((0,s.Km6)(),void 0)})]),l=(0,s.Oxt)("status",[(0,s.Ikc)({status:(0,s.euz)("error")}),(0,s.Ikc)({status:(0,s.euz)("ok"),comment:u})]),m=function(e){var r=(0,s.xLC)(l,e);return r.success?"error"===r.output.status?(0,o.z)("ApiError"):(0,o.ok)(r.output.comment.responses):(0,o.z)("ParsingError")},p=(0,s.Oxt)("status",[(0,s.Ikc)({status:(0,s.euz)("error"),errorCode:(0,s.KIO)(["USERNAME_MISSING","EMPTY_COMMENT_BODY","COMMENT_TOO_LONG","USER_BANNED","IP_THROTTLED","DISCUSSION_CLOSED","PARENT_COMMENT_MODERATED","COMMENT_RATE_LIMIT_EXCEEDED","INVALID_PROTOCOL","AUTH_COOKIE_INVALID","READ-ONLY-MODE","API_CORS_BLOCKED","API_ERROR","EMAIL_NOT_VALIDATED"])}),(0,s.Ikc)({status:(0,s.euz)("ok"),message:(0,s.YjP)()})]),x=function(e){var r=(0,s.xLC)(p,e),t=r.success,n=r.output;return t?"error"===n.status?(0,o.z)(n.errorCode):(0,o.ok)(n.message):(0,o.z)("ParsingError")},f=(0,s.Oxt)("status",[(0,s.Ikc)({status:(0,s.euz)("error"),message:(0,s.YjP)()}),(0,s.Ikc)({status:(0,s.euz)("ok")})]),h=function(e){var r=(0,s.xLC)(f,e),t=r.success,n=r.output;return t?"ok"===n.status?(0,o.ok)(!0):(0,o.z)(n.message):(0,o.z)("An unknown error occured")},g=(0,s.Oxt)("status",[(0,s.Ikc)({status:(0,s.euz)("error"),errors:(0,s.YOg)((0,s.Ikc)({message:(0,s.YjP)()}),[(0,s.BpQ)(1)])}),(0,s.Ikc)({status:(0,s.euz)("ok")})]),b=["newest","oldest","recommendations"],v=((0,n.E)(b),(0,n.E)(["collapsed","expanded","unthreaded"]),[25,50,100]),y=((0,n.E)(v),(0,s.Ikc)({status:(0,s.euz)("error"),statusCode:(0,s.aig)(),message:(0,s.YjP)(),errorCode:(0,s.lqM)((0,s.YjP)())})),j=(0,s.Ikc)({status:(0,s.euz)("ok"),currentPage:(0,s.aig)(),pages:(0,s.aig)(),pageSize:(0,s.aig)(),orderBy:(0,s.YjP)(),discussion:(0,s.Ikc)({key:(0,s.YjP)(),webUrl:(0,s.YjP)(),apiUrl:(0,s.YjP)(),commentCount:(0,s.aig)(),topLevelCommentCount:(0,s.lqM)((0,s.aig)(),0),isClosedForComments:(0,s.zMY)(),isClosedForRecommendation:(0,s.zMY)(),isThreaded:(0,s.zMY)(),title:(0,s.YjP)(),comments:(0,s.YOg)((0,s.KCZ)([d,u]))})}),k=(0,s.Oxt)("status",[y,j]),w=(0,s.Ikc)({status:(0,s.euz)("ok"),statusCode:(0,s.euz)(200),message:(0,s.YjP)()}),C=(0,s.Ikc)({status:(0,s.euz)("ok"),statusCode:(0,s.euz)(200)}),P=function(e){return(0,s.xLC)(C,e).success?(0,o.ok)(!0):(0,o.z)("ParsingError")},M=(0,s.Ikc)({status:(0,s.euz)("ok"),commentId:(0,s.aig)(),commentAncestorId:(0,s.aig)(),discussionKey:(0,s.YjP)(),discussionWebUrl:(0,s.YjP)(),discussionApiUrl:(0,s.YjP)(),orderBy:(0,s.KIO)(b),pageSize:(0,s.KIO)(v),page:(0,s.aig)()})},73771:(e,r,t)=>{t.d(r,{S:()=>I,Im:()=>w,EE:()=>A,zy:()=>R,Pu:()=>j,tn:()=>P,cU:()=>v,XH:()=>O,VH:()=>k,vh:()=>S,Tm:()=>C,Vf:()=>M,KW:()=>E});var n=t(62335),s=t(18247),o=t(57820),i=t.n(o),c=t(71456),a=t(90760),d=t(5240),u=t(20939),l=t(66781),m=t(17950),p=t(1948),x=function(){var e=(0,s.A)(i().mark((function e(){var r,t=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch.apply(void 0,t);case 3:return r=e.sent,e.t0=p.ok,e.next=7,r.json();case 7:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 11:if(e.prev=11,e.t2=e.catch(0),!(e.t2 instanceof SyntaxError)){e.next=15;break}return e.abrupt("return",(0,p.z)("ApiError"));case 15:return e.abrupt("return",(0,p.z)("NetworkError"));case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();function f(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?f(Object(t),!0).forEach((function(r){(0,n.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var g={baseUrl:"https://discussion.theguardian.com/discussion-api",apiKey:"discussion-rendering",headers:{},idApiUrl:"https://idapi.theguardian.com"},b={"api-key":g.apiKey},v=function(e){var r=e.baseUrl,t=e.additionalHeaders,n=e.apiKey,s=e.idApiUrl;g.baseUrl=r||g.baseUrl,g.headers=t,g.apiKey=n||g.apiKey,g.idApiUrl=s||g.idApiUrl,b["api-key"]=g.apiKey},y=function(e){return"?"+Object.keys(e).map((function(r){return"".concat(r,"=").concat(e[r])})).join("&")},j=function(){var e=(0,s.A)(i().mark((function e(r){var t,n,s,o,a,d,m,f,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.shortUrl,n=r.page,s=r.filters,o=r.signal,a=h(h({},b),{orderBy:"recommendations"===s.orderBy?"mostRecommended":s.orderBy,pageSize:s.pageSize,displayThreaded:"unthreaded"!==s.threads,maxResponses:"collapsed"===s.threads?3:100,page:n}),d=y(a),m=(0,c.w)(g.baseUrl,"discussion",t)+d,e.next=6,x(m,{headers:g.headers,signal:o});case 6:if("error"!==(f=e.sent).kind){e.next=9;break}return e.abrupt("return",o.aborted?(0,p.z)("AbortedSignal"):f);case 9:if((v=(0,u.xLC)(l.nI,f.value)).success){e.next=12;break}return e.abrupt("return",(0,p.z)("ParsingError"));case 12:if("error"!==v.output.status||"DISCUSSION_ONLY_AVAILABLE_IN_LINEAR_FORMAT"!==v.output.errorCode){e.next=14;break}return e.abrupt("return",j({shortUrl:t,page:n,filters:h(h({},s),{},{threads:"unthreaded"}),signal:o}));case 14:if("error"!==v.output.status){e.next=16;break}return e.abrupt("return",(0,p.z)("ApiError"));case 16:return e.abrupt("return",(0,p.ok)(v.output));case 17:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),k=function(){var e=(0,s.A)(i().mark((function e(r){var t,n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.w)(g.baseUrl,"comment/preview")+y(b),(n=new URLSearchParams).append("body",r),e.next=5,x(t,{method:"POST",body:n.toString(),headers:h({"Content-Type":"application/x-www-form-urlencoded"},g.headers)});case 5:if("error"!==(s=e.sent).kind){e.next=8;break}return e.abrupt("return",s);case 8:return e.abrupt("return",(0,a.G)(s.value)&&(0,d.K)(s.value.commentBody)?(0,p.ok)(s.value.commentBody):(0,p.z)("ParsingError"));case 9:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),w=function(e){return function(){var r=(0,s.A)(i().mark((function r(t,n){var s,o,a,d;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=(0,c.w)(g.baseUrl,"discussion",t,"comment")+y(b),(o=new URLSearchParams).append("body",n),a=(0,m.Kv)(e),r.next=6,x(s,{method:"POST",body:o.toString(),headers:h(h({"Content-Type":"application/x-www-form-urlencoded"},g.headers),a.headers),credentials:a.credentials});case 6:if("error"!==(d=r.sent).kind){r.next=9;break}return r.abrupt("return",d);case 9:return r.abrupt("return",(0,l.qb)(d.value));case 10:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()},C=function(e){return function(){var r=(0,s.A)(i().mark((function r(t,n,s){var o,a,d,u;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=(0,c.w)(g.baseUrl,"discussion",t,"comment",s,"reply")+y(b),(a=new URLSearchParams).append("body",n),d=(0,m.Kv)(e),r.next=6,x(o,{method:"POST",body:a.toString(),headers:h(h({"Content-Type":"application/x-www-form-urlencoded"},g.headers),d.headers),credentials:d.credentials});case 6:if("error"!==(u=r.sent).kind){r.next=9;break}return r.abrupt("return",u);case 9:return r.abrupt("return",(0,l.qb)(u.value));case 10:case"end":return r.stop()}}),r)})));return function(e,t,n){return r.apply(this,arguments)}}()},P=function(){var e=(0,s.A)(i().mark((function e(r){var t,n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.w)(g.baseUrl,"discussion",r,"topcomments")+y(b),e.next=3,x(t,{headers:h({},g.headers)});case 3:if("error"!==(n=e.sent).kind){e.next=6;break}return e.abrupt("return",n);case 6:if((s=(0,u.xLC)(l.nI,n.value)).success){e.next=9;break}return e.abrupt("return",(0,p.z)("ParsingError"));case 9:if("error"!==s.output.status){e.next=11;break}return e.abrupt("return",(0,p.z)("ApiError"));case 11:return e.abrupt("return",(0,p.ok)(s.output.discussion.comments));case 12:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),M=function(e){return function(){var r=(0,s.A)(i().mark((function r(t){var n,s,o,a,d,u,f,v;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.commentId,s=t.categoryId,o=t.email,a=t.reason,d=(0,c.w)(g.baseUrl,"comment",n,"reportAbuse")+y(b),(u=new URLSearchParams).append("categoryId",s.toString()),o&&u.append("email",o.toString()),a&&u.append("reason",a),f=e?(0,m.Kv)(e):void 0,r.next=9,x(d,{method:"POST",body:u.toString(),headers:h(h({"Content-Type":"application/x-www-form-urlencoded"},g.headers),null==f?void 0:f.headers),credentials:null==f?void 0:f.credentials});case 9:if("error"!==(v=r.sent).kind){r.next=12;break}return r.abrupt("return",(0,p.z)("An unknown error occured"));case 12:return r.abrupt("return",(0,l.HN)(v.value));case 13:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},S=function(e){return function(){var r=(0,s.A)(i().mark((function r(t){var n,s,o,a;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=(0,c.w)(g.baseUrl,"comment",t,"recommend")+y(b),o=(0,m.Kv)(e),r.next=4,x(s,{method:"POST",headers:h(h({},g.headers),null!==(n=o.headers)&&void 0!==n?n:{}),credentials:o.credentials});case 4:if("error"!==(a=r.sent).kind){r.next=7;break}return r.abrupt("return",!1);case 7:return r.abrupt("return","ok"===(0,l.Bq)(a.value).kind);case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},I=function(e){return function(){var r=(0,s.A)(i().mark((function r(t){var n,s,o,c;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=g.idApiUrl+"/user/me/username",s=(0,m.Kv)(e),r.next=4,x(n,{method:"POST",body:JSON.stringify({publicFields:{username:t,displayName:t}}),headers:h({"Content-Type":"application/json"},s.headers),credentials:s.credentials});case 4:if("error"!==(o=r.sent).kind){r.next=7;break}return r.abrupt("return",o);case 7:if((c=(0,u.xLC)(l.Te,o.value)).success){r.next=10;break}return r.abrupt("return",(0,p.z)("An unknown error occured"));case 10:if("error"!==c.output.status){r.next=12;break}return r.abrupt("return",(0,p.z)(c.output.errors.map((function(e){return e.message})).join("\n")));case 12:return r.abrupt("return",(0,p.ok)(!0));case 13:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},O=function(e){return function(){var r=(0,s.A)(i().mark((function r(t){var n,s,o;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=(0,c.w)(g.baseUrl,"comment",t,"highlight")+y(b),s=(0,m.Kv)(e),r.next=4,x(n,{method:"POST",headers:h(h({"Content-Type":"application/x-www-form-urlencoded"},g.headers),s.headers),credentials:s.credentials});case 4:if("error"!==(o=r.sent).kind){r.next=7;break}return r.abrupt("return",o);case 7:if((0,u.xLC)(l.MR,o.value).success){r.next=10;break}return r.abrupt("return",(0,p.z)("ParsingError"));case 10:return r.abrupt("return",(0,p.ok)(!0));case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},E=function(e){return function(){var r=(0,s.A)(i().mark((function r(t){var n,s,o;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=(0,c.w)(g.baseUrl,"comment",t,"unhighlight")+y(b),s=(0,m.Kv)(e),r.next=4,x(n,{method:"POST",headers:h(h({"Content-Type":"application/x-www-form-urlencoded"},g.headers),s.headers),credentials:s.credentials});case 4:if("error"!==(o=r.sent).kind){r.next=7;break}return r.abrupt("return",o);case 7:if((0,u.xLC)(l.MR,o.value).success){r.next=10;break}return r.abrupt("return",(0,p.z)("ParsingError"));case 10:return r.abrupt("return",(0,p.ok)(!1));case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},A=function(){var e=(0,s.A)(i().mark((function e(r){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.w)(g.baseUrl,"comment",r)+y(h(h({},b),{displayThreaded:!0,displayResponses:!0})),e.next=3,x(t,{headers:h({},g.headers)});case 3:if("error"!==(n=e.sent).kind){e.next=6;break}return e.abrupt("return",n);case 6:return e.abrupt("return",(0,l.L6)(n.value));case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),T=function(e){return new URLSearchParams({orderBy:"recommendations"===e.orderBy?"mostRecommended":e.orderBy,pageSize:String(e.pageSize),displayThreaded:String("collapsed"===e.threads||"expanded"===e.threads)})},R=function(){var e=(0,s.A)(i().mark((function e(r,t,n){var s,o,a,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,c.w)(r,"comment",t,"context"),o=T(n),e.next=4,x(s+"?"+o.toString());case 4:if("error"!==(a=e.sent).kind){e.next=7;break}return e.abrupt("return",a);case 7:if((d=(0,u.xLC)(l.pl,a.value)).success){e.next=10;break}return e.abrupt("return",(0,p.z)("ParsingError"));case 10:return e.abrupt("return",(0,p.ok)(d.output));case 11:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}()},1948:(e,r,t)=>{t.d(r,{ok:()=>n,z:()=>s});var n=function(e){return{kind:"ok",value:e}},s=function(e){return{kind:"error",error:e}}}}]);
//# sourceMappingURL=5676.client.web.legacy.faf55bd9c85324321e4f.js.map