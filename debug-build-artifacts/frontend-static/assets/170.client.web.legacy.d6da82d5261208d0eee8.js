"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[170],{30556:(e,n,r)=>{r.d(n,{af:()=>m,r2:()=>w});var t=r(22820),a=r(18247),i=r(57820),o=r.n(i),u=r(296),c=r(42702),s=r(67400),d=r(28118),f=r(45025),l=function(e){return["article","liveblog","gallery","video","interactive","audio"].includes(e.toLowerCase())},p=function(e){return window.guardian.dailyArticleCount||(l(e)&&(0,f.Q_)(),window.guardian.dailyArticleCount=(0,f.L3)()),window.guardian.dailyArticleCount},v=function(){var e=(0,a.A)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.yw)();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",void 0);case 4:return window.guardian.weeklyArticleCount||(l(t)&&(a=r.filter((function(e){return["tone","keyword"].includes(e.type.toLowerCase())})).map((function(e){return e.id})),(0,c.sB)(u.I.local,n,a)),window.guardian.weeklyArticleCount=(0,c.sQ)(u.I.local)),e.abrupt("return",window.guardian.weeklyArticleCount);case 6:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}(),w=function(){var e=(0,a.A)(o().mark((function e(n,r,t){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(t),e.next=3,v(n,r,t);case 3:return e.abrupt("return",{dailyArticleHistory:null!==(a=window.guardian.dailyArticleCount)&&void 0!==a?a:[],weeklyArticleHistory:null!==(i=window.guardian.weeklyArticleCount)&&void 0!==i?i:[]});case 4:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}(),m=function(e,n,r){var a=(0,s.useState)("Pending"),i=(0,t.A)(a,2),o=i[0],u=i[1];return(0,s.useEffect)((function(){w(e,n,r).then(u).catch((function(){return u(void 0)}))}),[r,e,n]),o}},87558:(e,n,r)=>{r.d(n,{B:()=>a});var t=["preview.gutools.co.uk","preview.code.dev-gutools.co.uk","localhost","m.thegulocal.com"],a=function(){if(window.location.hash){var e="force-braze-message",n=window.location.hash;if(n.includes(e)){if(!t.includes(window.location.hostname))return console.log("".concat(e," is not supported on this domain")),null;var r=n.slice(n.indexOf("".concat(e,"="))+19+1,n.length);try{return{dataFromBraze:JSON.parse(decodeURIComponent(r)),logImpressionWithBraze:function(){},logButtonClickWithBraze:function(){}}}catch(n){var a=n;console.log("There was an error with ".concat(e,": "),a.message)}}}return null}},30823:(e,n,r)=>{r.d(n,{O:()=>t});var t=function(e){return!0===window.guardian.config.switches.brazeTaylorReport&&!e.find((function(e){return"news/series/cotton-capital"===e.id}))}},28118:(e,n,r)=>{r.d(n,{Jj:()=>k,Pp:()=>p,VF:()=>v,Vi:()=>l,Xr:()=>S,_f:()=>z,h3:()=>m,mG:()=>x,mV:()=>y,n8:()=>C,q6:()=>I,tZ:()=>P,yw:()=>A});var t=r(22820),a=r(18247),i=r(57820),o=r.n(i),u=r(64361),c=r(65656),s=r(296),d=r(63854),f=r(67400),l="gu_hide_support_messaging",p="gu_recurring_contributor",v="gu.contributions.contrib-timestamp",w="gu.noRRBanner",m=function(e){var n,r,t=function(e){switch((0,u.R)({name:l})){case"true":return!0;case"false":return!1;default:return!!e&&"Pending"}}(e);return"Pending"===t?"Pending":t||(r=function(){var e=(0,u.R)({name:v});if(e)return(e?parseInt(e,10):0)||void 0}(),!(0,c.b)(r)&&(n=Date.now()-r,Math.floor(n/864e5)<=90))},h=[1,3,7],g=[1,3,5,7],b=function(){return null!==(0,u.R)({name:"gu_article_count_opt_out"})},y=function(){return new Promise((function(e){(0,u.R)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,d.Ym)((function(n){var r=n.usnat,t=n.tcfv2,a=n.aus;if(null!=r?r:a)e(!0);else if(t){var i=h.every((function(e){return t.consents[e]}));i||s.I.local.remove("gu.history.weeklyArticleCount"),e(i)}}))}))},k=function(){var e=(0,a.A)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return n=e.sent,e.abrupt("return",!n||b());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,a.A)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return n=e.sent,e.abrupt("return",!n||b());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=(0,f.useState)("Pending"),n=(0,t.A)(e,2),r=n[0],a=n[1];return(0,f.useEffect)((function(){k().then(a).catch((function(){return a(!0)}))}),[]),r},S=function(){return new Promise((function(e){(0,u.R)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,d.Ym)((function(n){var r=n.usnat,t=n.tcfv2,a=n.aus;if(null!=r?r:a)e(!0);else if(t){var i=g.every((function(e){return t.consents[e]}));e(i)}}))}))},C=function(){return!!s.I.local.get(w)},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return s.I.local.set(w,!0,e+12e5)},P=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return!!e&&n-new Date(e).getTime()<36e5},I=function(){var e=(0,u.R)({name:"GU_CO_COMPLETE",shouldMemoize:!0});if(e){var n;try{n=JSON.parse(decodeURIComponent(e))}catch(e){}return n}}},45025:(e,n,r)=>{r.d(n,{Gq:()=>u,L3:()=>o,Q_:()=>c});var t=r(90760),a=r(296),i="gu.history.dailyArticleCount",o=function(){try{var e=a.I.local.get(i);if(n=e,!Array.isArray(n)||!n.every((function(e){return(0,t.G)(e)&&"day"in e&&"count"in e&&"number"==typeof e.day&&"number"==typeof e.count})))throw new Error("Invalid gu.history.dailyArticleCount value");return e}catch(e){return void a.I.local.remove(i)}var n},u=function(){return Math.floor(Date.now()/864e5)},c=function(){var e,n,r=null!==(e=o())&&void 0!==e?e:[],t=u();if((null===(n=r[0])||void 0===n?void 0:n.day)===t)r[0].count+=1;else{r.unshift({day:t,count:1});var c=t-60,s=r.findIndex((function(e){return e.day&&e.day<c}));s>0&&r.splice(s)}a.I.local.set(i,r)}},46845:(e,n,r)=>{r.d(n,{w:()=>s});var t=r(18247),a=r(57820),i=r.n(a),o=r(10077),u=r(17950),c=function(){var e=(0,t.A)(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.kU)((function(e){var n;return null===(n=e.idToken)||void 0===n?void 0:n.claims.email}),(function(){return(0,o.J)(n).then((function(e){var n;return null===(n=e.user)||void 0===n?void 0:n.primaryEmailAddress})).catch((function(e){window.guardian.modules.sentry.reportError(e,"getEmail")}))})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),s=function(e){return function(){return new Promise((function(n){setTimeout((function(){return n(null)}),1e3),c(e).then((function(e){n(e||null)}))}))}}},10077:(e,n,r)=>{r.d(n,{J:()=>u,h:()=>c});var t=r(71456);function a(e){if(!e.ok)throw Error(e.statusText||"getIdApiUserData | An api call returned HTTP status ".concat(e.status));return e}var i=function(e){return fetch(e,{credentials:"include"}).then(a).then((function(e){return e.json()}))},o={},u=function(e){if(!o.idapiUserMeResponse){var n=(0,t.w)(e,"user/me");o.idapiUserMeResponse=i(n)}return o.idapiUserMeResponse},c=function(e){if(!o.idapiUserIdentifiersResponse){var n=(0,t.w)(e,"user/me/identifiers");o.idapiUserIdentifiersResponse=i(n)}return o.idapiUserIdentifiersResponse}},24755:(e,n,r)=>{r.d(n,{f:()=>a});var t=["lightbox","youTubeFullscreen","sticky-video-button","sticky-video","banner","dropdown","burger","mastheadVeggieBurgerExpandedMobile","expanded-veggie-menu-wrapper","expanded-veggie-menu","fullPageInteractiveHeaderWrapper","mobileSticky","stickyAdWrapperLabsHeader","stickyAdWrapper","stickyAdWrapperNav","mastheadMyAccountDropdown","mastheadEditionDropdown","editionDropdown","summaryDetails","toast","onwardsCarousel","myAccountDropdown","searchHeaderLink","TheGuardian","editionSwitcherBanner","expandableMarketingCardOverlay","tableOfContents","articleHeadline","immersiveBlackBox","bodyArea","rightColumnArea","mainMedia","card-nested-link","card-link"],a=function(e){var n=t.indexOf(e);return-1===n?-1:t.length-n}},16528:(e,n,r)=>{r.d(n,{h:()=>v});var t=r(62335),a=r(18247),i=r(57820),o=r.n(i),u=r(14429),c=r(65656),s=r(85918);function d(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function f(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?d(Object(r),!0).forEach((function(n){(0,t.A)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var l=function(){var e=(0,a.A)(o().mark((function e(n,r,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.V5)(t);case 2:e.sent.record({component:"".concat(r,"-picker-timeout-dcr"),value:n});case 4:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}(),p=function(){return null},v=function(e,n){var r=e.candidates,t=e.name;return new Promise((function(e){var i=r.map((function(e){return function(e,n,r){var t;return f(f({},e),{},{candidate:f(f({},e.candidate),{},{canShow:function(){return new Promise((function(a){var i="messagePicker-canShow-".concat(e.candidate.id),o=(0,u.h)("tx",i).endPerformanceMeasure;null!==e.timeoutMillis&&(t=window.setTimeout((function(){l(e.candidate.id,n,r),a({show:!1})}),e.timeoutMillis)),e.candidate.canShow().then((function(n){a(n);var t=o();e.reportTiming&&(0,s.V5)(r).then((function(e){e.record({component:i,value:t})}))})).catch((function(e){return console.error("timeoutify candidate - error: ".concat(String(e)))}))}))}}),cancelTimeout:function(){return!(0,c.b)(t)&&clearTimeout(t)}})}(e,t,n)})),d=i.map((function(e){return{candidateConfig:e,canShow:e.candidate.canShow()}})).reduce(function(){var e=(0,a.A)(o().mark((function e(n,r){var t,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.candidateConfig,a=r.canShow,e.next=3,n;case 3:if(!e.sent){e.next=5;break}return e.abrupt("return",n);case 5:return e.next=7,a;case 7:if(i=e.sent,t.cancelTimeout(),!i.show){e.next=11;break}return e.abrupt("return",{candidate:t.candidate,meta:i.meta});case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),Promise.resolve(null));d.then((function(n){if(i.map((function(e){return e.cancelTimeout()})),null===n)e(p);else{var r=n.candidate,t=n.meta;e((function(){return r.show(t)}))}})).catch((function(e){return console.error("pickMessage winner - error: ".concat(String(e)))}))}))}},49910:(e,n,r)=>{r.d(n,{q:()=>u});var t=r(24017),a=r(50484),i=r(67400),o=!1,u=function(){o||(window.guardian.automat={emotionReact:t,emotionReactJsxRuntime:a,react:i.default},o=!0)}},66049:(e,n,r)=>{r.d(n,{H:()=>u,z:()=>c});var t=r(29273),a=r(53994),i=new Promise((function(){})),o="ab-tests",u=function(){return(0,a.A)(o,(function(){return i})).data},c=function(e){var n=e.api,r=e.participations;(0,t.Tk)(o,{api:n,participations:r},!1)}},66186:(e,n,r)=>{r.d(n,{T:()=>o,w:()=>u});var t=r(22820),a=r(67400),i=r(17950),o=function(){switch(u().kind){case"Pending":return"Pending";case"SignedInWithCookies":case"SignedInWithOkta":return!0;case"SignedOutWithCookies":case"SignedOutWithOkta":return!1}},u=function(){var e=(0,a.useState)({kind:"Pending"}),n=(0,t.A)(e,2),r=n[0],o=n[1];return(0,a.useEffect)((function(){(0,i.kU)((function(e){o((0,i.dx)(e))}),(function(){return o((0,i.Hn)())})).catch((function(e){console.error(e)}))}),[]),r}},17947:(e,n,r)=>{r.d(n,{m:()=>E});var t=r(75342),a=r(53994),i=r(18247),o=r(57820),u=r.n(o),c=r(296),s=r(16346),d=r(14429),f=r(85918),l="gu.brazeUserSet",p=r(10077),v=r(17950),w=function(){var e=(0,i.A)(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.kU)((function(e){var n;return null===(n=e.idToken)||void 0===n?void 0:n.claims.braze_uuid}),(function(){return(0,p.h)(n).then((function(e){return e.brazeUuid})).catch((function(e){window.guardian.modules.sentry.reportError(e,"getBrazeUuid")}))})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),m=r(63854);function h(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return g(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw i}}}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}var b,y=function(e,n,r){return{isSuccessful:!1,failure:{field:e,data:n},data:r}},k=function(e,n){return[{name:"apiKey",value:Promise.resolve(window.guardian.config.page.brazeApiKey)},{name:"brazeSwitch",value:Promise.resolve(window.guardian.config.switches.brazeSwitch)},{name:"brazeUuid",value:e?w(n):Promise.resolve(null)},{name:"consent",value:new Promise((function(e,n){(0,m.Ym)((function(r){try{e((0,m.gS)("braze",r))}catch(e){n(e)}}))}))},{name:"isNotPaidContent",value:Promise.resolve(!window.guardian.config.page.isPaidContent)}]},A=function(){var e=(0,i.A)(u().mark((function e(n,r){var t,a,i,o,c,s,d,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=k(n,r),a={},i=h(t),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=23;break}return c=o.value,s=c.name,d=c.value,e.prev=7,e.next=10,d;case 10:if(!(f=e.sent)){e.next=15;break}a[s]=f,e.next=16;break;case 15:return e.abrupt("return",y(s,f,a));case 16:e.next=21;break;case 18:return e.prev=18,e.t0=e.catch(7),e.abrupt("return",y(s,e.t0 instanceof Error?e.t0.message:e.t0,a));case 21:e.next=5;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(3),i.e(e.t1);case 28:return e.prev=28,i.f(),e.finish(28);case 31:return e.abrupt("return",{isSuccessful:!0,data:a});case 32:case"end":return e.stop()}}),e,null,[[3,25,28,31],[7,18]])})));return function(n,r){return e.apply(this,arguments)}}(),x=r(65656),S={enableLogging:!0,noCookies:!0,baseUrl:"https://sdk.fra-01.braze.eu/api/v3",sessionTimeoutInSeconds:1,minimumIntervalBetweenTriggerActionsInSeconds:0,devicePropertyAllowlist:[]},C=function(){var e=(0,i.A)(u().mark((function e(n){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(7659).then(r.t.bind(r,14844,23));case 2:return(t=e.sent).setLogger((function(e){return(0,s.Rm)("tx",e)})),t.initialize(n,S),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),z=function(e){return(0,x.b)(b)&&(b=C(e)),b},P=function(){var e=(0,i.A)(u().mark((function e(n,r,a,i){var o,s,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="true"===c.I.local.getRaw(l),s=!a&&o,d=!i&&o,!(!r&&o||s||d)){e.next=18;break}if(e.prev=5,!n){e.next=11;break}return e.next=9,z(n);case 9:e.sent.wipeData();case 11:t.tP.clear(),c.I.local.remove(l),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),window.guardian.modules.sentry.reportError(e.t0,"braze-maybeWipeUserData");case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(n,r,t,a){return e.apply(this,arguments)}}(),I=function(){var e=(0,i.A)(u().mark((function e(n,r,a){var i,o,p,v,w,m,h,g,b,y;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.I.local.isAvailable()){e.next=2;break}return e.abrupt("return",{brazeMessages:new t._v,brazeCards:new t.ho});case 2:return e.next=4,A(r,n);case 4:if((i=e.sent).isSuccessful){e.next=11;break}return o=i.failure,p=i.data,(0,s.Rm)("tx","Not attempting to show Braze messages. Dependency ".concat(o.field," failed with ").concat(String(o.data),".")),e.next=10,P(p.apiKey,p.brazeUuid,p.consent,p.brazeSwitch);case 10:return e.abrupt("return",{brazeMessages:new t._v,brazeCards:new t.ho});case 11:return e.prev=11,v=(0,d.h)("tx","braze-sdk-load"),w=v.endPerformanceMeasure,e.next=15,z(i.data.apiKey);case 15:return m=e.sent,h=w(),e.next=19,(0,f.V5)(a);case 19:return e.sent.record({component:"braze-sdk-load-timing",value:h}),g=function(e,n){window.guardian.modules.sentry.reportError(e,n)},c.I.local.setRaw(l,"true"),m.changeUser(i.data.brazeUuid),m.openSession(),b=window.guardian.config.switches.brazeContentCards?new t.ue(m,g):new t.ho,y=new t.xK(m,t.tP,g,t.Aw),e.abrupt("return",{brazeMessages:y,brazeCards:b});case 30:return e.prev=30,e.t0=e.catch(11),e.abrupt("return",{brazeMessages:new t._v,brazeCards:new t.ho});case 33:case"end":return e.stop()}}),e,null,[[11,30]])})));return function(n,r,t){return e.apply(this,arguments)}}(),O=r(66186),E=function(e,n){var r=(0,O.w)(),i="SignedInWithOkta"===r.kind||"SignedInWithCookies"===r.kind,o=(0,a.A)("Pending"!==r.kind?"braze-message":null,(function(){return I(e,i,n)})),u=o.data;return o.error?{brazeMessages:new t._v,brazeCards:new t.ho}:{brazeMessages:null==u?void 0:u.brazeMessages,brazeCards:null==u?void 0:u.brazeCards}}},59695:(e,n,r)=>{r.d(n,{F:()=>u});var t=r(22820),a=r(76720),i=r(67400),o=r(34166),u=function(e){var n=(0,i.useState)(),r=(0,t.A)(n,2),u=r[0],c=r[1];return(0,i.useEffect)((function(){(0,o.C)().then((function(e){(0,a.R)(e)&&c(e)})).catch((function(n){var r="Error fetching country code: ".concat(String(n));window.guardian.modules.sentry.reportError(new Error(r),e)}))}),[e]),u}},88528:(e,n,r)=>{r.d(n,{E:()=>u});var t=r(22820),a=r(44165),i=r.n(a),o=r(67400),u=function(e){var n,r=(0,o.useState)(!1),a=(0,t.A)(r,2),u=a[0],c=a[1],s=(0,o.useState)(null!==(n=e.node)&&void 0!==n?n:null),d=(0,t.A)(s,2),f=d[0],l=d[1],p=(0,o.useRef)(null),v=(0,o.useCallback)((function(n){var r=(0,t.A)(n,1)[0];r&&(r.isIntersecting?c(!0):e.repeat&&c(!1))}),[e.repeat]),w=e.debounce?i()(v,200):v;return(0,o.useEffect)((function(){e.node&&l(e.node)}),[e.node]),(0,o.useEffect)((function(){if(f&&"IntersectionObserver"in window)return p.current=new window.IntersectionObserver(w,e),p.current.observe(f),function(){var e;return null===(e=p.current)||void 0===e?void 0:e.disconnect()}}),[f,e,w]),(0,o.useEffect)((function(){var n;!e.repeat&&u&&(null===(n=p.current)||void 0===n||n.disconnect())}),[u,e.repeat]),[u,l]}},95131:(e,n,r)=>{r.d(n,{H:()=>o});var t=r(22820),a=r(65656),i=r(67400),o=function(e,n){var r=(0,i.useState)(!1),o=(0,t.A)(r,2),u=o[0],c=o[1],s=n.every((function(e){return!(0,a.b)(e)}));(0,i.useEffect)((function(){!u&&s&&(e(),c(!0))}),[u,s,e])}}}]);
//# sourceMappingURL=170.client.web.legacy.d6da82d5261208d0eee8.js.map