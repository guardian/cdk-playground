"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[1104],{77663:(e,t,r)=>{r.d(t,{u:()=>i});var n=r(50484),i=function(e){var t=e.priority,r=e.defer,i=e.children,o=e.role,a="visible"===(null==r?void 0:r.until)?r.rootMargin:void 0,s=String(i.type.name);return(0,n.jsx)("gu-island",{name:s,priority:t,deferUntil:null==r?void 0:r.until,props:JSON.stringify(i.props),rootMargin:a,"data-spacefinder-role":o,children:i})}},78776:(e,t,r)=>{r.r(t),r.d(t,{SlotBodyEnd:()=>Y});var n=r(22820),i=r(62335),o=r(50484),a=r(24017),s=r(74184),c=r(64361),u=r(5240),l=r(65656),d=r(50641),p=r(67400),f=r(30556),m=r(16528),b=r(66049),g=r(66186),h=r(17947),w=r(59695),v=r(38111),y=r(7693),C=r(18247),O=r(57820),S=r.n(O),P=r(85918),k=r(87558),A=r(30823),E=r(46845),x=r(17950),D=r(88528),j=r(95131);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,i.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R={name:"pc1kq1",styles:"margin:18px 0"},L="RETENTION_EPIC",B=function(){var e=(0,C.A)(S().mark((function e(t,r,n,i,o){var a,s;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("interactive"!==n.toLowerCase()){e.next=2;break}return e.abrupt("return",{show:!1});case 2:if(!(a=(0,k.B)())){e.next=5;break}return e.abrupt("return",{show:!0,meta:a});case 5:if(!o){e.next=7;break}return e.abrupt("return",{show:!1});case 7:if(!(0,A.O)(i)){e.next=9;break}return e.abrupt("return",{show:!1});case 9:return e.prev=9,e.next=12,t.getMessageForEndOfArticle(r);case 12:if(!(s=e.sent).extras){e.next=15;break}return e.abrupt("return",{show:!0,meta:{dataFromBraze:s.extras,logImpressionWithBraze:function(){s.logImpression()},logButtonClickWithBraze:function(e){s.logButtonClick(e)}}});case 15:return e.abrupt("return",{show:!1});case 18:return e.prev=18,e.t0=e.catch(9),e.abrupt("return",{show:!1});case 21:case"end":return e.stop()}}),e,null,[[9,18]])})));return function(t,r,n,i,o){return e.apply(this,arguments)}}(),z=function(e){var t=e.BrazeComponent,r=e.meta,i=e.countryCode,a=e.idApiUrl,s=(0,g.w)(),c=(0,D.E)({rootMargin:"-18px",threshold:0,debounce:!0}),u=(0,n.A)(c,2),l=u[0],d=u[1],f=(0,p.useRef)(null),m=(0,y.U)().renderingTarget;(0,j.H)((function(){(0,P.u_)({component:{componentType:L,id:r.dataFromBraze.ophanComponentId},action:"INSERT"},m)}),[r.dataFromBraze,f.current]),(0,p.useEffect)((function(){l&&(r.logImpressionWithBraze(),(0,P.u_)({component:{componentType:L,id:r.dataFromBraze.ophanComponentId},action:"VIEW"},m))}),[l,r,m]);var b=r.dataFromBraze.componentName;if(!b)return null;var h=function(){var e=(0,C.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("SignedInWithCookies"!=s.kind&&"SignedInWithOkta"!=s.kind){e.next=4;break}return r=(0,x.Kv)(s),e.next=4,fetch("".concat(a,"/users/me/newsletters"),M({method:"PATCH",body:JSON.stringify({id:t,subscribed:!0})},r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=(0,E.w)(a);return(0,o.jsx)("div",{ref:d,css:R,children:(0,o.jsx)("div",{ref:f,children:(0,o.jsx)(t,{componentName:b,brazeMessageProps:r.dataFromBraze,subscribeToNewsletter:h,countryCode:i,logButtonClickWithBraze:r.logButtonClickWithBraze,submitComponentEvent:function(e){(0,P.u_)(e,m)},fetchEmail:w})})})},N=function(e){var t=e.meta,i=e.countryCode,a=e.idApiUrl,s=(0,p.useState)(),c=(0,n.A)(s,2),u=c[0],l=c[1];return(0,p.useEffect)((function(){r.e(8007).then(r.bind(r,41564)).then((function(e){l((function(){return e.BrazeEndOfArticleComponent}))})).catch((function(e){return window.guardian.modules.sentry.reportError(e,"braze-epic")}))}),[]),(0,o.jsx)(o.Fragment,{children:u?(0,o.jsx)(z,{BrazeComponent:u,meta:t,countryCode:i,idApiUrl:a}):(0,o.jsx)("div",{})})},T=r(296),F=r(14429),U=r(63854),_=r(42702),H=r(28118),W=r(49910);function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){(0,i.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q={name:"rmxmld",styles:"margin:18px 0;clear:both"},q=function(){var e=(0,C.A)(S().mark((function e(t){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0={ophanPageId:window.guardian.config.ophan.pageViewId,platformId:"GUARDIAN_WEB",clientName:"dcr",referrerUrl:window.location.origin+window.location.pathname},e.t1=t.contentType,e.t2=t.sectionId,e.t3=t.shouldHideReaderRevenue,e.t4=t.isMinuteArticle,e.t5=t.isPaidContent,e.t6=t.tags,e.t7=!t.hideSupportMessagingForUser,e.t8=(0,_.DS)(T.I.local),e.next=11,t.asyncArticleCount;case 11:return e.t9=e.sent,e.next=14,(0,H.Jj)();case 14:return e.t10=e.sent,e.t11=Number((0,c.R)({name:"GU_mvt_id",shouldMemoize:!0})),e.t12=t.countryCode,e.t13=window.location.origin+window.location.pathname,e.next=20,(0,H.Xr)();case 20:if(!e.sent){e.next=24;break}e.t14=t.browserId,e.next=25;break;case 24:e.t14=void 0;case 25:return e.t15=e.t14,e.t16=t.isSignedIn,e.t17={contentType:e.t1,sectionId:e.t2,shouldHideReaderRevenue:e.t3,isMinuteArticle:e.t4,isPaidContent:e.t5,tags:e.t6,showSupportMessaging:e.t7,epicViewLog:e.t8,weeklyArticleHistory:e.t9,hasOptedOutOfArticleCount:e.t10,mvtId:e.t11,countryCode:e.t12,url:e.t13,browserId:e.t15,isSignedIn:e.t16},e.abrupt("return",{tracking:e.t0,targeting:e.t17});case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,C.A)(S().mark((function e(t){var r,n,i,o,a,s,c,u,l,d,p,f,m,b,g;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.isSignedIn,i=t.shouldHideReaderRevenue,o=t.isPaidContent,a=t.contributionsServiceUrl,s=t.idApiUrl,c=t.stage,"Pending"!==(u=(0,H.h3)(n))){e.next=4;break}return e.abrupt("return",Promise.resolve({show:!1}));case 4:if(!i&&!o){e.next=6;break}return e.abrupt("return",Promise.resolve({show:!1}));case 6:return l=(0,F.h)("supporterRevenue","contributions-epic-data"),d=l.endPerformanceMeasure,e.next=9,q(V(V({},t),{},{hideSupportMessagingForUser:u}));case 9:return p=e.sent,e.next=12,(0,_.Am)(a,p);case 12:if(f=e.sent,m=null===(r=f.data)||void 0===r?void 0:r.module,d(),m){e.next=17;break}return e.abrupt("return",{show:!1});case 17:return b=n?(0,E.w)(s):void 0,e.next=20,(0,H.mV)();case 20:return g=e.sent,e.abrupt("return",{show:!0,meta:{module:m,fetchEmail:b,hasConsentForArticleCount:g,stage:c}});case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e){var t=e.module,i=e.fetchEmail,a=e.hasConsentForArticleCount,s=e.stage,c=(0,p.useState)(null),u=(0,n.A)(c,2),l=u[0],d=u[1],f=(0,y.U)().renderingTarget;return(0,p.useEffect)((function(){(0,W.q)();var e=(0,F.h)("supporterRevenue","contributions-epic-module").endPerformanceMeasure;Promise.all([r.e(8219),r.e(9428),r.e(8079),r.e(9355),r.e(5496),r.e(1398)]).then(r.bind(r,64573)).then((function(t){e(),d((function(){return t.ContributionsEpic}))})).catch((function(e){var t=e instanceof Error?"Error importing RR epic: ".concat(e.message):"Unknown error";console.log(t),window.guardian.modules.sentry.reportError(new Error(t),"rr-epic")}))}),[]),null!==l?(0,o.jsx)("div",{css:Q,children:(0,o.jsx)(l,V(V({},t.props),{},{fetchEmail:i,submitComponentEvent:function(e){(0,P.u_)(e,f)},openCmp:function(){U.r2.showPrivacyManager()},hasConsentForArticleCount:a,stage:s}))}):null};function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var $=(0,a.css)("color:",d.M.neutral[7],";"),Y=function(e){var t,r=e.contentType,a=e.sectionId,d=e.shouldHideReaderRevenue,C=e.isMinuteArticle,O=e.isPaidContent,S=e.tags,P=e.contributionsServiceUrl,k=e.idApiUrl,A=e.stage,E=e.pageId,x=e.renderAds,D=e.isLabs,j=e.articleEndSlot,I=(0,y.U)().renderingTarget,M=(0,h.m)(k,I).brazeMessages,R=(0,w.F)("slot-body-end"),L=(0,g.T)(),z=function(){var e=(0,p.useState)(),t=(0,n.A)(e,2),r=t[0],i=t[1];return(0,p.useEffect)((function(){var e=(0,c.R)({name:"bwid",shouldMemoize:!0}),t=(0,u.K)(e)?e:"no-browser-id-available";i(t)}),[]),r}(),T=(0,p.useState)(),F=(0,n.A)(T,2),U=F[0],_=F[1],H=(0,p.useState)(),W=(0,n.A)(H,2),G=W[0],V=W[1],Q="US"===R,q=(0,b.H)(),Y=null==q?void 0:q.api,Z=null!==(t=(null==Y?void 0:Y.isUserInVariant("MpuWhenNoEpic","variant"))&&"GB"===R)&&void 0!==t&&t,ee=x&&!D&&(Q||Z)&&j;return(0,p.useEffect)((function(){V((0,f.r2)(E,S,r).then((function(e){return null==e?void 0:e.weeklyArticleHistory})))}),[r,S,E]),(0,p.useEffect)((function(){if(!((0,l.b)(R)||(0,l.b)(M)||(0,l.b)(G)||(0,l.b)(z)||"Pending"===L)){var e=(s={isSignedIn:L,countryCode:R,contentType:r,sectionId:a,shouldHideReaderRevenue:d,isMinuteArticle:C,isPaidContent:O,tags:S,contributionsServiceUrl:P,idApiUrl:k,stage:A,asyncArticleCount:G,browserId:z},{candidate:{id:"reader-revenue-banner",canShow:function(){return J(s)},show:function(e){return function(){return(0,o.jsx)(K,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,i.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e))}}},timeoutMillis:null}),t=function(e,t,r,n,i,a,s){return{candidate:{id:"braze-epic",canShow:function(){return B(e,i,n,a,s)},show:function(e){return function(){return(0,o.jsx)(N,{meta:e,countryCode:t,idApiUrl:r})}}},timeoutMillis:2e3}}(M,R,k,r,{section:a},S,d),n={candidates:[t,e],name:"slotBodyEnd"};(0,m.h)(n,I).then((function(e){return _(e)})).catch((function(e){return console.error("SlotBodyEnd pickMessage - error: ".concat(String(e)))}))}var s}),[L,R,M,G,z,r,P,k,C,O,I,a,d,A,S]),(0,p.useEffect)((function(){null===U&&ee&&document.dispatchEvent(new CustomEvent("gu.commercial.slot.fill",{detail:{slotId:"dfp-ad--article-end",additionalSizes:Z?{desktop:[s.EA.outstreamDesktop,s.EA.outstreamGoogleDesktop]}:Q?{mobile:[s.EA.fluid]}:{}}}))}),[U,ee,Z,Q]),null===U||(0,l.b)(U)?null===U&&ee?(0,o.jsx)("div",{id:"slot-body-end",css:$,children:(0,o.jsx)(v.u,{"data-print-layout":"hide",position:"article-end"})}):null:(0,o.jsx)("div",{id:"slot-body-end",css:$,children:(0,o.jsx)(U,{})})}},95644:(e,t,r)=>{var n,i,o,a;r.d(t,{A$:()=>a,B0:()=>o,M2:()=>l,Ns:()=>i,vw:()=>n}),function(e){e[e.Standard=0]="Standard",e[e.Picture=1]="Picture",e[e.Gallery=2]="Gallery",e[e.Audio=3]="Audio",e[e.Video=4]="Video",e[e.Review=5]="Review",e[e.Analysis=6]="Analysis",e[e.Explainer=7]="Explainer",e[e.Comment=8]="Comment",e[e.Letter=9]="Letter",e[e.Feature=10]="Feature",e[e.LiveBlog=11]="LiveBlog",e[e.DeadBlog=12]="DeadBlog",e[e.Recipe=13]="Recipe",e[e.MatchReport=14]="MatchReport",e[e.Interview=15]="Interview",e[e.Editorial=16]="Editorial",e[e.Quiz=17]="Quiz",e[e.Interactive=18]="Interactive",e[e.PhotoEssay=19]="PhotoEssay",e[e.Obituary=20]="Obituary",e[e.Correction=21]="Correction",e[e.FullPageInteractive=22]="FullPageInteractive",e[e.NewsletterSignup=23]="NewsletterSignup",e[e.Timeline=24]="Timeline",e[e.Profile=25]="Profile"}(n||(n={})),function(e){e[e.Standard=0]="Standard",e[e.Immersive=1]="Immersive",e[e.Showcase=2]="Showcase",e[e.NumberedList=3]="NumberedList"}(i||(i={})),function(e){e[e.News=0]="News",e[e.Opinion=1]="Opinion",e[e.Sport=2]="Sport",e[e.Culture=3]="Culture",e[e.Lifestyle=4]="Lifestyle"}(o||(o={})),function(e){e[e.SpecialReport=5]="SpecialReport",e[e.Labs=6]="Labs",e[e.SpecialReportAlt=7]="SpecialReportAlt"}(a||(a={}));var s=function(e){switch(e.design){case"ArticleDesign":default:return n.Standard;case"PictureDesign":return n.Picture;case"GalleryDesign":return n.Gallery;case"AudioDesign":return n.Audio;case"VideoDesign":return n.Video;case"ReviewDesign":return n.Review;case"AnalysisDesign":return n.Analysis;case"CommentDesign":return n.Comment;case"LetterDesign":return n.Letter;case"FeatureDesign":return n.Feature;case"LiveBlogDesign":return n.LiveBlog;case"DeadBlogDesign":return n.DeadBlog;case"RecipeDesign":return n.Recipe;case"MatchReportDesign":return n.MatchReport;case"InterviewDesign":return n.Interview;case"EditorialDesign":return n.Editorial;case"QuizDesign":return n.Quiz;case"InteractiveDesign":return n.Interactive;case"PhotoEssayDesign":return n.PhotoEssay;case"ObituaryDesign":return n.Obituary;case"FullPageInteractiveDesign":return n.FullPageInteractive;case"NewsletterSignupDesign":return n.NewsletterSignup;case"ExplainerDesign":return n.Explainer;case"TimelineDesign":return n.Timeline;case"ProfileDesign":return n.Profile}},c=function(e){var t=e.display,r=e.design;switch(t){case"StandardDisplay":default:return i.Standard;case"ImmersiveDisplay":return"CommentDesign"===r?i.Standard:i.Immersive;case"ShowcaseDisplay":return i.Showcase;case"NumberedListDisplay":return i.NumberedList}},u=function(e){switch(e.theme){case"NewsPillar":default:return o.News;case"OpinionPillar":return o.Opinion;case"SportPillar":return o.Sport;case"CulturePillar":return o.Culture;case"LifestylePillar":return o.Lifestyle;case"SpecialReportTheme":return a.SpecialReport;case"SpecialReportAltTheme":return a.SpecialReportAlt;case"Labs":return a.Labs}},l=function(e){return{design:s(e),display:c(e),theme:u(e)}}},1954:(e,t,r)=>{r.d(t,{M:()=>n});var n=function(e){return"var(".concat(e,")")}},84782:(e,t,r)=>{r.d(t,{f:()=>n});var n={desktop:980,leftCol:1140,mobile:320,mobileLandscape:480,mobileMedium:375,phablet:660,tablet:740,wide:1300}},81477:(e,t,r)=>{r.d(t,{HT:()=>s,TG:()=>c,Tq:()=>u});var n=r(84782),i=function(e){return"@media (min-width: ".concat("".concat(e,"px"),")")},o=function(e){return"@media (max-width: ".concat("".concat(e-.1,"px"),")")},a=function(e,t){return"@media (min-width: ".concat("".concat(e,"px"),") and (max-width: ","".concat(t-.1,"px"),")")},s={mobile:i(n.f.mobile),mobileMedium:i(n.f.mobileMedium),mobileLandscape:i(n.f.mobileLandscape),phablet:i(n.f.phablet),tablet:i(n.f.tablet),desktop:i(n.f.desktop),leftCol:i(n.f.leftCol),wide:i(n.f.wide)},c={mobile:o(n.f.mobile),mobileMedium:o(n.f.mobileMedium),mobileLandscape:o(n.f.mobileLandscape),phablet:o(n.f.phablet),tablet:o(n.f.tablet),desktop:o(n.f.desktop),leftCol:o(n.f.leftCol),wide:o(n.f.wide)},u={mobile:{and:{mobileMedium:a(n.f.mobile,n.f.mobileMedium),mobileLandscape:a(n.f.mobile,n.f.mobileLandscape),phablet:a(n.f.mobile,n.f.phablet),tablet:a(n.f.mobile,n.f.tablet),desktop:a(n.f.mobile,n.f.desktop),leftCol:a(n.f.mobile,n.f.leftCol),wide:a(n.f.mobileMedium,n.f.wide)}},mobileMedium:{and:{mobileLandscape:a(n.f.mobileMedium,n.f.mobileLandscape),phablet:a(n.f.mobileMedium,n.f.phablet),tablet:a(n.f.mobileMedium,n.f.tablet),desktop:a(n.f.mobileMedium,n.f.desktop),leftCol:a(n.f.mobileMedium,n.f.leftCol),wide:a(n.f.mobileMedium,n.f.wide)}},mobileLandscape:{and:{phablet:a(n.f.mobileLandscape,n.f.phablet),tablet:a(n.f.mobileLandscape,n.f.tablet),desktop:a(n.f.mobileLandscape,n.f.desktop),leftCol:a(n.f.mobileLandscape,n.f.leftCol),wide:a(n.f.mobileLandscape,n.f.wide)}},phablet:{and:{tablet:a(n.f.phablet,n.f.tablet),desktop:a(n.f.phablet,n.f.desktop),leftCol:a(n.f.phablet,n.f.leftCol),wide:a(n.f.phablet,n.f.wide)}},tablet:{and:{desktop:a(n.f.tablet,n.f.desktop),leftCol:a(n.f.tablet,n.f.leftCol),wide:a(n.f.tablet,n.f.wide)}},desktop:{and:{leftCol:a(n.f.desktop,n.f.leftCol),wide:a(n.f.desktop,n.f.wide)}},leftCol:{and:{wide:a(n.f.leftCol,n.f.wide)}}}}}]);
//# sourceMappingURL=SlotBodyEnd-importable.client.web.legacy.e58db60d76ed7b28fa67.js.map