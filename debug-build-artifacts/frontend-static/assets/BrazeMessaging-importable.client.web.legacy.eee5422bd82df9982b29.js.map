{"version":3,"file":"BrazeMessaging-importable.client.web.legacy.eee5422bd82df9982b29.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/components/BrazeMessaging.importable.tsx","webpack://@guardian/dotcom-rendering/./src/lib/getIdapiUserData.ts","webpack://@guardian/dotcom-rendering/./src/lib/useAuthStatus.ts","webpack://@guardian/dotcom-rendering/./src/lib/hasCurrentBrazeUser.ts","webpack://@guardian/dotcom-rendering/./src/lib/getBrazeUuid.ts","webpack://@guardian/dotcom-rendering/./src/lib/braze/checkBrazeDependencies.ts","webpack://@guardian/dotcom-rendering/./src/lib/braze/initialiseAppboy.ts","webpack://@guardian/dotcom-rendering/./src/lib/braze/hasRequiredConsents.ts","webpack://@guardian/dotcom-rendering/./src/lib/braze/buildBrazeMessaging.ts","webpack://@guardian/dotcom-rendering/./src/lib/useBraze.ts","webpack://@guardian/dotcom-rendering/../node_modules/.pnpm/@guardian+braze-components@21.0.0_@emotion+react@11.11.3_@guardian+libs@19.2.1_@guardian+source@8.0.0_react@18.3.1/node_modules/@guardian/braze-components/dist/logic/index.esm.js","webpack://@guardian/dotcom-rendering/../node_modules/.pnpm/@guardian+libs@19.2.1_tslib@2.6.2_typescript@5.5.3/node_modules/@guardian/libs/dist/joinUrl/joinUrl.js"],"sourcesContent":["import { log } from '@guardian/libs';\nimport { useBraze } from '../lib/useBraze';\nimport { useConfig } from './ConfigContext';\n/**\n * This component ensures we call buildBrazeMessaging at least once\n * on every page\n *\n * ## Why does this need to be an Island?\n *\n * All behaviour is client-side.\n *\n * ---\n *\n * Does not render **anything**.\n */\nexport const BrazeMessaging = ({ idApiUrl }) => {\n    const { renderingTarget } = useConfig();\n    const { brazeMessages, brazeCards } = useBraze(idApiUrl, renderingTarget);\n    if (brazeMessages) {\n        log('tx', 'Braze Messages Interface loaded', brazeMessages);\n    }\n    if (brazeCards) {\n        log('tx', 'Braze Cards Interface loaded', brazeCards);\n    }\n    // we donâ€™t render anything\n    return null;\n};\n","import { joinUrl } from '@guardian/libs';\nfunction checkForErrors(response) {\n    if (!response.ok) {\n        throw Error(response.statusText ||\n            `getIdApiUserData | An api call returned HTTP status ${response.status}`);\n    }\n    return response;\n}\nconst callApi = (url) => {\n    return fetch(url, {\n        credentials: 'include',\n    })\n        .then(checkForErrors)\n        .then((response) => response.json());\n};\nconst cache = {};\nexport const getIdApiUserData = (ajaxUrl) => {\n    if (!cache.idapiUserMeResponse) {\n        const url = joinUrl(ajaxUrl, 'user/me');\n        cache.idapiUserMeResponse = callApi(url);\n    }\n    return cache.idapiUserMeResponse;\n};\nexport const getIdapiUserIdentifiers = (ajaxUrl) => {\n    if (!cache.idapiUserIdentifiersResponse) {\n        const url = joinUrl(ajaxUrl, 'user/me/identifiers');\n        cache.idapiUserIdentifiersResponse = callApi(url);\n    }\n    return cache.idapiUserIdentifiersResponse;\n};\n","import { useEffect, useState } from 'react';\nimport { eitherInOktaTestOrElse, getSignedInStatusWithCookies, getSignedInStatusWithOkta, } from './identity';\n/**\n * A hook to find out if a user is signed in.\n * Returns `'Pending'` until status is known.\n * Always returns `'Pending'` during server-side rendering.\n * */\nexport const useIsSignedIn = () => {\n    const authStatus = useAuthStatus();\n    switch (authStatus.kind) {\n        case 'Pending':\n            return 'Pending';\n        case 'SignedInWithCookies':\n        case 'SignedInWithOkta':\n            return true;\n        case 'SignedOutWithCookies':\n        case 'SignedOutWithOkta':\n            return false;\n    }\n};\nexport const useAuthStatus = () => {\n    const [authStatus, setAuthStatus] = useState({\n        kind: 'Pending',\n    });\n    useEffect(() => {\n        eitherInOktaTestOrElse((oktaAuthState) => {\n            setAuthStatus(getSignedInStatusWithOkta(oktaAuthState));\n        }, () => setAuthStatus(getSignedInStatusWithCookies())).catch((error) => {\n            console.error(error);\n        });\n    }, []);\n    return authStatus;\n};\n","import { storage } from '@guardian/libs';\nconst KEY = 'gu.brazeUserSet';\nconst hasCurrentBrazeUser = () => {\n    return storage.local.getRaw(KEY) === 'true';\n};\nconst setHasCurrentBrazeUser = () => {\n    storage.local.setRaw(KEY, 'true');\n};\nconst clearHasCurrentBrazeUser = () => {\n    storage.local.remove(KEY);\n};\nexport { hasCurrentBrazeUser, setHasCurrentBrazeUser, clearHasCurrentBrazeUser, };\n","import { getIdapiUserIdentifiers } from './getIdapiUserData';\nimport { eitherInOktaTestOrElse } from './identity';\nexport const getBrazeUuid = async (ajaxUrl) => \n// TODO Okta: Remove either when at 100% in oktaVariant test, and just use idToken\neitherInOktaTestOrElse((authState) => authState.idToken?.claims.braze_uuid, () => getIdapiUserIdentifiers(ajaxUrl)\n    .then((data) => data.brazeUuid)\n    .catch((error) => {\n    window.guardian.modules.sentry.reportError(error, 'getBrazeUuid');\n}));\n","import { getBrazeUuid } from '../getBrazeUuid';\nimport { hasRequiredConsents } from './hasRequiredConsents';\nconst buildFailureResponse = (name, value, data) => ({\n    isSuccessful: false,\n    failure: {\n        field: name,\n        data: value,\n    },\n    data,\n});\nconst buildDependencies = (isSignedIn, idApiUrl) => {\n    return [\n        {\n            name: 'apiKey',\n            value: Promise.resolve(window.guardian.config.page.brazeApiKey),\n        },\n        {\n            name: 'brazeSwitch',\n            value: Promise.resolve(window.guardian.config.switches.brazeSwitch),\n        },\n        {\n            name: 'brazeUuid',\n            value: isSignedIn ? getBrazeUuid(idApiUrl) : Promise.resolve(null),\n        },\n        {\n            name: 'consent',\n            value: hasRequiredConsents(),\n        },\n        {\n            name: 'isNotPaidContent',\n            value: Promise.resolve(!window.guardian.config.page.isPaidContent),\n        },\n    ];\n};\nconst checkBrazeDependencies = async (isSignedIn, idApiUrl) => {\n    const dependencies = buildDependencies(isSignedIn, idApiUrl);\n    const data = {};\n    // I think we could possibly clean this up a bit when we can use\n    // Promise.allSettled reliably (it's not available in our current Node\n    // version and polyfill.io doesn't have a polyfill yet).\n    for (const { name, value } of dependencies) {\n        try {\n            const result = await value;\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions -- TODO: Complex types, look into this further\n            if (result) {\n                data[name] = result;\n            }\n            else {\n                return buildFailureResponse(name, result, data);\n            }\n        }\n        catch (e) {\n            return buildFailureResponse(name, e instanceof Error ? e.message : e, data);\n        }\n    }\n    return {\n        isSuccessful: true,\n        data,\n    };\n};\nexport { checkBrazeDependencies };\n","import { isUndefined, log } from '@guardian/libs';\nconst SDK_OPTIONS = {\n    enableLogging: true,\n    noCookies: true,\n    baseUrl: 'https://sdk.fra-01.braze.eu/api/v3',\n    sessionTimeoutInSeconds: 1,\n    minimumIntervalBetweenTriggerActionsInSeconds: 0,\n    devicePropertyAllowlist: [],\n};\nconst initialiseAppboy = async (apiKey) => {\n    const importedAppboy = (await import(\n    /* webpackChunkName: \"braze-web-sdk-core\" */ '@braze/web-sdk-core'));\n    importedAppboy.setLogger((message) => log('tx', message));\n    importedAppboy.initialize(apiKey, SDK_OPTIONS);\n    return importedAppboy;\n};\nconst getInitialisedAppboy = (() => {\n    let cache;\n    return (apiKey) => {\n        if (isUndefined(cache)) {\n            cache = initialiseAppboy(apiKey);\n        }\n        return cache;\n    };\n})();\nexport { getInitialisedAppboy };\n","import { getConsentFor, onConsentChange } from '@guardian/libs';\nconst hasRequiredConsents = () => new Promise((resolve, reject) => {\n    onConsentChange((state) => {\n        try {\n            resolve(getConsentFor('braze', state));\n        }\n        catch (e) {\n            reject(e);\n        }\n    });\n});\nexport { hasRequiredConsents };\n","import { BrazeCards, BrazeMessages, canRenderBrazeMsg, LocalMessageCache, NullBrazeCards, NullBrazeMessages, } from '@guardian/braze-components/logic';\nimport { log, startPerformanceMeasure, storage } from '@guardian/libs';\nimport { getOphan } from '../../client/ophan/ophan';\nimport { clearHasCurrentBrazeUser, hasCurrentBrazeUser, setHasCurrentBrazeUser, } from '../hasCurrentBrazeUser';\nimport { checkBrazeDependencies } from './checkBrazeDependencies';\nimport { getInitialisedAppboy } from './initialiseAppboy';\nconst maybeWipeUserData = async (apiKey, brazeUuid, consent, brazeSwitch) => {\n    const hasCurrentBrazeUserValue = hasCurrentBrazeUser();\n    const userHasLoggedOut = !brazeUuid && hasCurrentBrazeUserValue;\n    const userHasRemovedConsent = !consent && hasCurrentBrazeUserValue;\n    const brazeHasBeenDisabled = !brazeSwitch && hasCurrentBrazeUserValue;\n    if (userHasLoggedOut || userHasRemovedConsent || brazeHasBeenDisabled) {\n        try {\n            if (apiKey) {\n                const appboy = await getInitialisedAppboy(apiKey);\n                appboy.wipeData();\n            }\n            LocalMessageCache.clear();\n            clearHasCurrentBrazeUser();\n        }\n        catch (error) {\n            window.guardian.modules.sentry.reportError(\n            // @ts-expect-error\n            error, 'braze-maybeWipeUserData');\n        }\n    }\n};\nexport const buildBrazeMessaging = async (idApiUrl, isSignedIn, renderingTarget) => {\n    if (!storage.local.isAvailable()) {\n        // we require local storage for using any message channel so that we know\n        // when to clear up user data from the device on logout\n        return {\n            brazeMessages: new NullBrazeMessages(),\n            brazeCards: new NullBrazeCards(),\n        };\n    }\n    const dependenciesResult = await checkBrazeDependencies(isSignedIn, idApiUrl);\n    if (!dependenciesResult.isSuccessful) {\n        const { failure, data } = dependenciesResult;\n        log('tx', `Not attempting to show Braze messages. Dependency ${failure.field} failed with ${String(failure.data)}.`);\n        await maybeWipeUserData(data.apiKey, data.brazeUuid, data.consent, data.brazeSwitch);\n        return {\n            brazeMessages: new NullBrazeMessages(),\n            brazeCards: new NullBrazeCards(),\n        };\n    }\n    try {\n        const { endPerformanceMeasure } = startPerformanceMeasure('tx', 'braze-sdk-load');\n        const appboy = await getInitialisedAppboy(dependenciesResult.data.apiKey);\n        const sdkLoadTimeTaken = endPerformanceMeasure();\n        const ophan = await getOphan(renderingTarget);\n        ophan.record({\n            // @ts-expect-error -- the relevant team should remove this call as it is dropped by Ophan\n            // see https://github.com/guardian/dotcom-rendering/pull/11438 further context\n            component: 'braze-sdk-load-timing',\n            value: sdkLoadTimeTaken,\n        });\n        const errorHandler = (error, desc) => {\n            window.guardian.modules.sentry.reportError(error, desc);\n        };\n        setHasCurrentBrazeUser();\n        appboy.changeUser(dependenciesResult.data.brazeUuid);\n        appboy.openSession();\n        const brazeCards = window.guardian.config.switches.brazeContentCards\n            ? new BrazeCards(appboy, errorHandler)\n            : new NullBrazeCards();\n        const brazeMessages = new BrazeMessages(appboy, LocalMessageCache, errorHandler, canRenderBrazeMsg);\n        return { brazeMessages, brazeCards };\n    }\n    catch {\n        return {\n            brazeMessages: new NullBrazeMessages(),\n            brazeCards: new NullBrazeCards(),\n        };\n    }\n};\n","import { NullBrazeCards, NullBrazeMessages, } from '@guardian/braze-components/logic';\nimport useSWRImmutable from 'swr/immutable';\nimport { buildBrazeMessaging } from './braze/buildBrazeMessaging';\nimport { useAuthStatus } from './useAuthStatus';\n/**\n * Returns brazeMessaging as BrazeMessagesInterface and BrazeCardsInterface\n *\n * BrazeMessages is used to show single-impression messages (like ad impressions).\n * In contrast, BrazeCards can provide persistent user notifications.\n *\n * We're using useSWRImmutable to ensure this call is only made once\n * [doc]: https://swr.vercel.app/docs/revalidation#disable-automatic-revalidations\n */\nexport const useBraze = (idApiUrl, renderingTarget) => {\n    const authStatus = useAuthStatus();\n    const isSignedIn = authStatus.kind === 'SignedInWithOkta' ||\n        authStatus.kind === 'SignedInWithCookies';\n    const { data, error } = useSWRImmutable(authStatus.kind !== 'Pending' ? 'braze-message' : null, () => buildBrazeMessaging(idApiUrl, isSignedIn, renderingTarget));\n    if (error) {\n        return {\n            brazeMessages: new NullBrazeMessages(),\n            brazeCards: new NullBrazeCards(),\n        };\n    }\n    return {\n        brazeMessages: data?.brazeMessages,\n        brazeCards: data?.brazeCards,\n    };\n};\n","import { storage as e } from \"@guardian/libs\";\nfunction r(e) { var r = function (e, r) { if (\"object\" != typeof e || !e)\n    return e; var t = e[Symbol.toPrimitive]; if (void 0 !== t) {\n    var n = t.call(e, r || \"default\");\n    if (\"object\" != typeof n)\n        return n;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n} return (\"string\" === r ? String : Number)(e); }(e, \"string\"); return \"symbol\" == typeof r ? r : String(r); }\nfunction t(e, r) { if (!(e instanceof r))\n    throw new TypeError(\"Cannot call a class as a function\"); }\nfunction n(e, t) { for (var n = 0; n < t.length; n++) {\n    var o = t[n];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, r(o.key), o);\n} }\nfunction o(e, r, t) { return r && n(e.prototype, r), t && n(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction a(e, t, n) { return (t = r(t)) in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e; }\nfunction i(e, r) { return function (e) { if (Array.isArray(e))\n    return e; }(e) || function (e, r) { var t = null == e ? null : \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"]; if (null != t) {\n    var n, o, a, i, s = [], l = !0, u = !1;\n    try {\n        if (a = (t = t.call(e)).next, 0 === r) {\n            if (Object(t) !== t)\n                return;\n            l = !1;\n        }\n        else\n            for (; !(l = (n = a.call(t)).done) && (s.push(n.value), s.length !== r); l = !0)\n                ;\n    }\n    catch (e) {\n        u = !0, o = e;\n    }\n    finally {\n        try {\n            if (!l && null != t.return && (i = t.return(), Object(i) !== i))\n                return;\n        }\n        finally {\n            if (u)\n                throw o;\n        }\n    }\n    return s;\n} }(e, r) || s(e, r) || function () { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }(); }\nfunction s(e, r) { if (e) {\n    if (\"string\" == typeof e)\n        return l(e, r);\n    var t = Object.prototype.toString.call(e).slice(8, -1);\n    return \"Object\" === t && e.constructor && (t = e.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(e) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? l(e, r) : void 0;\n} }\nfunction l(e, r) { (null == r || r > e.length) && (r = e.length); for (var t = 0, n = new Array(r); t < r; t++)\n    n[t] = e[t]; return n; }\nvar u, c = function () { function e(r, n, o, a, i, s) { t(this, e), this.id = void 0, this.appboy = void 0, this.message = void 0, this.slotName = void 0, this.cache = void 0, this.errorHandler = void 0, this.id = r, this.message = n, this.appboy = o, this.slotName = a, this.cache = i, this.errorHandler = s; } return o(e, [{ key: \"logImpression\", value: function () { try {\n            this.appboy.logInAppMessageImpression(this.message);\n        }\n        catch (e) {\n            e instanceof Error && this.errorHandler(e, \"BrazeMessage.logImpression\");\n        } this.cache.remove(this.slotName, this.id, this.errorHandler); } }, { key: \"logButtonClick\", value: function (e) { var r = new this.appboy.InAppMessageButton(\"Button: ID \".concat(e), void 0, void 0, void 0, void 0, void 0, e); try {\n            this.appboy.logInAppMessageButtonClick(r, this.message);\n        }\n        catch (e) {\n            e instanceof Error && this.errorHandler(e, \"BrazeMessage.logButtonClick\");\n        } } }, { key: \"extras\", get: function () { return this.message.extras; } }]), e; }(), d = function () { function e(r, n, o, a) { t(this, e), this.appboy = void 0, this.freshMessageBySlot = void 0, this.cache = void 0, this.errorHandler = void 0, this.canRender = void 0, this.appboy = r, this.cache = n, this.freshMessageBySlot = { Banner: this.getFreshMessagesForSlot(\"Banner\"), EndOfArticle: this.getFreshMessagesForSlot(\"EndOfArticle\") }, this.errorHandler = o, this.canRender = a; } return o(e, [{ key: \"getFreshMessagesForSlot\", value: function (e) { var r = this; return new Promise((function (t) { r.appboy.subscribeToInAppMessage((function (n) { var o = n, a = o.extras; a && a.slotName && a.slotName === e && (r.cache.push(e, { message: o, id: \"\".concat(Math.random().toString(16).slice(2), \"-\").concat((new Date).getTime()) }, r.errorHandler), t(o)); })); })); } }, { key: \"getMessageForBanner\", value: function (e) { return this.getMessageForSlot(\"Banner\", e); } }, { key: \"getMessageForEndOfArticle\", value: function (e) { return this.getMessageForSlot(\"EndOfArticle\", e); } }, { key: \"getMessageForSlot\", value: function (e, r) { var t = this, n = this.getHighestPriorityMessageFromCache(e, r); return n ? Promise.resolve(n) : this.freshMessageBySlot[e].then((function () { var n = t.getHighestPriorityMessageFromCache(e, r); if (n)\n            return Promise.resolve(n); throw new Error(\"No valid messages for \".concat(e, \" slot\")); })); } }, { key: \"getHighestPriorityMessageFromCache\", value: function (e, r) { var t, n = this, o = this.cache.all(e, this.appboy, this.errorHandler).filter((function (e) { return n.canRender(e.message.extras); })), a = { messagesWithFilters: (t = o).filter((function (e) { return Boolean(e.message.extras.section); })), messagesWithoutFilters: t.filter((function (e) { return !Boolean(e.message.extras.section); })) }, s = a.messagesWithoutFilters, l = i(a.messagesWithFilters.concat(s).filter((function (e) { var t; if (!e.message.extras.section || \"string\" != typeof e.message.extras.section)\n            return !0; var n = null == r || null === (t = r.section) || void 0 === t ? void 0 : t.toLowerCase(); return !!n && e.message.extras.section.split(\"|\").map((function (e) { return e.toLowerCase(); })).includes(n); })), 1)[0]; if (l)\n            return new c(l.id, l.message, this.appboy, e, this.cache, this.errorHandler); } }]), e; }(), h = function () { function e() { t(this, e); } return o(e, [{ key: \"getMessageForBanner\", value: function () { return Promise.reject(new Error(\"No banner message\")); } }, { key: \"getMessageForEndOfArticle\", value: function () { return Promise.reject(new Error(\"No end of article message\")); } }]), e; }(), f = function (e) { return e.Banner = \"Banner\", e.EndOfArticle = \"EndOfArticle\", e; }({}), g = function (e) { return e.ProfileBadge = \"ProfileBadge\", e; }({}), p = function () { function e(r, n, o, a, i) { t(this, e), this.id = void 0, this.slotName = void 0, this.card = void 0, this.appboy = void 0, this.errorHandler = void 0, this.id = r, this.slotName = n, this.card = o, this.appboy = a, this.errorHandler = i; } return o(e, [{ key: \"logImpression\", value: function () { try {\n            this.appboy.logCardImpressions([this.card], !0) || this.errorHandler(new Error(\"Failed to log card impression event\"), \"BrazeCard.logImpressions\");\n        }\n        catch (e) {\n            e instanceof Error && this.errorHandler(e, \"BrazeCard.logImpressions\");\n        } } }, { key: \"logCardClick\", value: function () { try {\n            this.appboy.logCardClick(this.card, !0) || this.errorHandler(new Error(\"Failed to log card click event\"), \"BrazeCard.logCardClick\");\n        }\n        catch (e) {\n            e instanceof Error && this.errorHandler(e, \"BrazeCard.logCardClick\");\n        } } }, { key: \"logCardDismissal\", value: function () { try {\n            this.appboy.logCardDismissal(this.card) || this.errorHandler(new Error(\"Failed to log card dismiss event\"), \"BrazeCard.logCardDismiss\");\n        }\n        catch (e) {\n            e instanceof Error && this.errorHandler(e, \"BrazeCard.logCardDismiss\");\n        } } }, { key: \"extras\", get: function () { var e = this.card.extras; return void 0 === e ? {} : e; } }, { key: \"expiry\", get: function () { var e = this.card.expiresAt; return null === e ? void 0 : e; } }]), e; }(), m = function () { function e(r, n) { t(this, e), this.appboy = void 0, this.errorHandler = void 0, this.appboy = r, this.errorHandler = n; } return o(e, [{ key: \"getCardsForProfileBadge\", value: function () { return this.getCardsForSlot(g.ProfileBadge); } }, { key: \"getCardsForSlot\", value: function (e) { var r = this; return this.appboy.getCachedContentCards().cards.flatMap((function (t) { var n = t.extras; return n && n.slotName && n.slotName === e ? void 0 === t.id ? (r.errorHandler(new Error(\"appboy card had no ID\"), \"BrazeCards.getCardsForSlot\"), []) : [new p(t.id, e, t, r.appboy, r.errorHandler)] : []; })); } }, { key: \"lastUpdated\", get: function () { return this.appboy.getCachedContentCards().lastUpdated; } }]), e; }(), v = function () { function e() { t(this, e); } return o(e, [{ key: \"getCardsForProfileBadge\", value: function () { return []; } }]), e; }(), y = 864e5, b = function (e) { return \"\".concat(\"gu.brazeMessageCache\", \".\").concat(e); }, C = function (r, t) { var n = b(r); e.local.set(n, t); }, w = function (e, r) { return new r.HtmlMessage(e.message, e.extras, e.campaignId, e.cardId, e.triggerId, e.dismissType, e.duration, e.animateIn, e.animateOut, e.frameColor, e.htmlId, e.css, e.messageFields); }, B = function (r, t) { var n = function (r) { var t = b(r), n = e.local.get(t); return Array.isArray(n) ? n : []; }(r), o = n.filter((function (e) { return r = e, Boolean((null == r ? void 0 : r.expires) && Number.isFinite(null == r ? void 0 : r.expires) && (null == r || null === (t = r.message) || void 0 === t ? void 0 : t.id) && (null == r || null === (n = r.message) || void 0 === n || null === (n = n.message) || void 0 === n ? void 0 : n.triggerId) && (null == r || null === (o = r.message) || void 0 === o || null === (o = o.message) || void 0 === o ? void 0 : o.extras)); var r, t, n, o; })).filter((function (e) { return e.expires > Date.now(); })); if (n.length !== o.length) {\n    var a = n.length - o.length;\n    t(Error(\"Removed \".concat(a, \" expired message\").concat(1 === a ? \"\" : \"s\", \" from queue\")), \"LocalMessageCache\"), C(r, o);\n} return o; }, I = function () { function r() { t(this, r); } return o(r, null, [{ key: \"peek\", value: function (e, r, t) { var n = B(e, t)[0]; if (n)\n            return { id: n.message.id, message: w(n.message.message, r) }; } }, { key: \"all\", value: function (e, r, t) { return B(e, t).map((function (e) { return { id: e.message.id, message: w(e.message.message, r) }; })); } }, { key: \"remove\", value: function (e, r, t) { var n = B(e, t), o = n.findIndex((function (e) { return e.message.id === r; })); if (o >= 0 && n.splice(o, 1))\n            return C(e, n), !0; return !1; } }, { key: \"push\", value: function (e, r, t) { var n = B(e, t); if (n.length < 2) {\n            var o = { message: r, expires: Date.now() + 864e5 };\n            return n.push(o), C(e, n), !0;\n        } return t(new Error(\"Failed to add message to queue - queue full\"), \"LocalMessageCache\"), !1; } }, { key: \"clear\", value: function () { for (var r in f) {\n            var t = b(r);\n            e.local.remove(t);\n        } } }]), r; }(), E = [\"https://media.guim.co.uk/\", \"https://i.guim.co.uk/\"], k = function (e) { return E.some((function (r) { return e.startsWith(r); })); }, F = [\"%%CURRENCY_SYMBOL%%\", \"%%COUNTRY_NAME%%\"], M = /%%.*?%%/g, x = function (e) { var r, t, n = e.buttonText, o = e.buttonUrl, a = e.ophanComponentId, i = e.highlightedText, s = N(e), l = (i || \"\") + \" \" + s.join(\" \"), u = !!(t = null === (r = l.match(M)) || void 0 === r ? void 0 : r.filter((function (e) { return !F.includes(\"\".concat(e)); }))) && t.length > 0; return Boolean(n && o && a && s.length > 0 && !u); }, N = function (e) { var r, t = [], n = function (e, r) { var t = \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"]; if (!t) {\n    if (Array.isArray(e) || (t = s(e)) || r && e && \"number\" == typeof e.length) {\n        t && (e = t);\n        var n = 0, o = function () { };\n        return { s: o, n: function () { return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] }; }, e: function (e) { throw e; }, f: o };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n} var a, i = !0, l = !1; return { s: function () { t = t.call(e); }, n: function () { var e = t.next(); return i = e.done, e; }, e: function (e) { l = !0, a = e; }, f: function () { try {\n        i || null == t.return || t.return();\n    }\n    finally {\n        if (l)\n            throw a;\n    } } }; }(Object.keys(e).filter((function (e) { return /^paragraph\\d$/.test(e); })).sort()); try {\n    for (n.s(); !(r = n.n()).done;) {\n        var o = e[r.value];\n        o && t.push(o);\n    }\n}\ncatch (e) {\n    n.e(e);\n}\nfinally {\n    n.f();\n} return t; }, S = (a(u = {}, \"AppBanner\", (function (e) { var r = e.header, t = e.body, n = e.cta, o = e.imageUrl; return !!(r && t && n && o) && (!!k(o) || (console.log(\"Image URL \".concat(o, \" is not allowed\")), !1)); })), a(u, \"BannerWithLink\", (function (e) { var r = e.header, t = e.body, n = e.buttonText, o = e.buttonUrl, a = e.imageUrl, i = e.ophanComponentId; return a && !k(a) ? (console.log(\"Image URL \".concat(a, \" is not allowed\")), !1) : Boolean(r && t && n && o && a && i); })), a(u, \"StyleableBannerWithLink\", (function (e) { var r = e.header, t = e.body, n = e.buttonText, o = e.buttonUrl, a = e.imageUrl, i = e.ophanComponentId; return a && !k(a) ? (console.log(\"Image URL \".concat(a, \" is not allowed\")), !1) : Boolean(r && t && n && o && a && i); })), a(u, \"BannerNewsletter\", (function (e) { var r = e.header, t = e.body, n = e.imageUrl, o = e.ophanComponentId, a = e.newsletterId, i = e.frequency; return n && !k(n) ? (console.log(\"Image URL \".concat(n, \" is not allowed\")), !1) : Boolean(r && t && n && o && a && i); })), a(u, \"StyleableBannerNewsletter\", (function (e) { var r = e.header, t = e.body, n = e.imageUrl, o = e.ophanComponentId, a = e.newsletterId, i = e.frequency; return n && !k(n) ? (console.log(\"Image URL \".concat(n, \" is not allowed\")), !1) : Boolean(r && t && n && o && a && i); })), a(u, \"Epic\", x), a(u, \"EpicWithSpecialHeader\", (function (e) { var r = x(e); if (r) {\n    var t = e.authoredEpicImageUrl, n = e.authoredEpicImageAltText, o = e.authoredEpicBylineName;\n    return t && !k(t) ? (console.log(\"Image URL \".concat(t, \" is not allowed\")), !1) : Boolean(t && n && o);\n} return r; })), a(u, \"USNewsletterEpic\", (function (e) { var r = e.header, t = e.frequency, n = e.paragraph1, o = e.ophanComponentId; return Boolean(r && t && n && o); })), a(u, \"AUNewsletterEpic\", (function (e) { var r = e.header, t = e.frequency, n = e.paragraph1, o = e.ophanComponentId; return Boolean(r && t && n && o); })), a(u, \"UKNewsletterEpic\", (function (e) { var r = e.header, t = e.frequency, n = e.paragraph1, o = e.ophanComponentId; return Boolean(r && t && n && o); })), a(u, \"DownToEarthNewsletterEpic\", (function (e) { var r = e.header, t = e.frequency, n = e.paragraph1, o = e.ophanComponentId; return Boolean(r && t && n && o); })), a(u, \"EpicNewsletter_AU_AfternoonUpdate\", (function (e) { var r = e.header, t = e.frequency, n = e.paragraph1, o = e.ophanComponentId; return Boolean(r && t && n && o); })), a(u, \"EpicNewsletter_TheGuide\", (function (e) { var r = e.header, t = e.frequency, n = e.paragraph1, o = e.ophanComponentId; return Boolean(r && t && n && o); })), a(u, \"NewsletterEpic\", (function (e) { var r = e.header, t = e.frequency, n = e.paragraph1, o = e.imageUrl, a = e.newsletterId, i = e.ophanComponentId; return !!(r && t && n && o && a && i) && (!!k(o) || (console.log(\"Image URL \".concat(o, \" is not allowed\")), !1)); })), u), A = function (e) { return !!e && (!!S[e.componentName] && S[e.componentName](e)); };\nexport { p as BrazeCard, m as BrazeCards, c as BrazeMessage, d as BrazeMessages, I as LocalMessageCache, v as NullBrazeCards, h as NullBrazeMessages, A as canRenderBrazeMsg, w as hydrateMessage, y as millisecondsBeforeExpiry, C as setQueue };\n","const multipleSlashesInRoute = /\\b\\/{2,}/g;\nconst joinUrl = (...args) => args.join(\"/\").replace(multipleSlashesInRoute, \"/\");\nexport { joinUrl };\n"],"names":["BrazeMessaging","_ref","idApiUrl","renderingTarget","useConfig","_useBraze","useBraze","brazeMessages","brazeCards","log","checkForErrors","response","ok","Error","statusText","concat","status","callApi","url","fetch","credentials","then","json","cache","getIdApiUserData","ajaxUrl","idapiUserMeResponse","joinUrl","getIdapiUserIdentifiers","idapiUserIdentifiersResponse","useIsSignedIn","useAuthStatus","kind","_useState","useState","_useState2","_slicedToArray","authStatus","setAuthStatus","useEffect","eitherInOktaTestOrElse","oktaAuthState","getSignedInStatusWithOkta","getSignedInStatusWithCookies","catch","error","console","KEY","getBrazeUuid","_asyncToGenerator","_regeneratorRuntime","_callee","_context","prev","next","abrupt","authState","_authState$idToken","idToken","claims","braze_uuid","data","brazeUuid","window","guardian","modules","sentry","reportError","stop","_x","apply","arguments","buildFailureResponse","name","value","isSuccessful","failure","field","buildDependencies","isSignedIn","Promise","resolve","config","page","brazeApiKey","switches","brazeSwitch","reject","onConsentChange","state","getConsentFor","e","isPaidContent","checkBrazeDependencies","dependencies","_iterator","_step","_step$value","result","_createForOfIteratorHelper","s","n","done","sent","t0","message","t1","f","finish","_x2","SDK_OPTIONS","enableLogging","noCookies","baseUrl","sessionTimeoutInSeconds","minimumIntervalBetweenTriggerActionsInSeconds","devicePropertyAllowlist","initialiseAppboy","apiKey","importedAppboy","setLogger","initialize","getInitialisedAppboy","isUndefined","maybeWipeUserData","consent","hasCurrentBrazeUserValue","userHasRemovedConsent","brazeHasBeenDisabled","storage","local","getRaw","wipeData","LocalMessageCache","clear","remove","_x3","_x4","buildBrazeMessaging","_ref2","_callee2","dependenciesResult","_startPerformanceMeas","endPerformanceMeasure","appboy","sdkLoadTimeTaken","errorHandler","_context2","isAvailable","NullBrazeMessages","NullBrazeCards","String","startPerformanceMeasure","getOphan","record","component","desc","setRaw","changeUser","openSession","brazeContentCards","BrazeCards","BrazeMessages","canRenderBrazeMsg","_x5","_x6","_x7","_useSWRImmutable","useSWRImmutable","r","_typeof","t","Symbol","toPrimitive","call","TypeError","length","o","enumerable","configurable","writable","Object","defineProperty","key","prototype","a","i","Array","isArray","iterator","l","u","push","return","toString","slice","constructor","from","test","c","this","id","slotName","logInAppMessageImpression","InAppMessageButton","logInAppMessageButtonClick","get","extras","d","freshMessageBySlot","canRender","Banner","getFreshMessagesForSlot","EndOfArticle","subscribeToInAppMessage","Math","random","Date","getTime","getMessageForSlot","getHighestPriorityMessageFromCache","messagesWithFilters","all","filter","Boolean","section","messagesWithoutFilters","toLowerCase","split","map","includes","h","g","ProfileBadge","p","card","logCardImpressions","logCardClick","logCardDismissal","expiresAt","m","getCardsForSlot","getCachedContentCards","cards","flatMap","lastUpdated","v","b","C","set","w","HtmlMessage","campaignId","cardId","triggerId","dismissType","duration","animateIn","animateOut","frameColor","htmlId","css","messageFields","B","expires","Number","isFinite","now","I","findIndex","splice","E","k","some","startsWith","F","M","x","buttonText","buttonUrl","ophanComponentId","highlightedText","N","join","match","keys","sort","S","header","body","cta","imageUrl","newsletterId","frequency","authoredEpicImageUrl","authoredEpicImageAltText","authoredEpicBylineName","paragraph1","A","componentName","multipleSlashesInRoute","_len","args","_key","replace"],"sourceRoot":""}