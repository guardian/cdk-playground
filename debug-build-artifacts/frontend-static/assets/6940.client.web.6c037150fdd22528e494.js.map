{"version":3,"file":"6940.client.web.6c037150fdd22528e494.js","mappings":"yLAEO,MAAMA,EAAa,KACzBC,EAAAA,EAAAA,GAAmB,sB,mCCIb,MAAMA,EACZC,IAEA,MAAMC,EAAU,IACZC,SAASC,iBAAoCH,IAGjD,GAAuB,IAAnBC,EAAQG,OAAc,OAAOC,QAAQC,UAEzCC,OAAOC,iBAAiB,WAAYC,IACnC,MAAMC,EAAST,EAAQU,MAAMC,IAC5B,IACC,OAAOA,EAAEC,OAAS,EAA2BC,OAAOD,IACrD,CAAE,MAAOE,GACR,OAAO,CACR,KAED,GAAIL,EACH,IAEC,MAAMM,EAAUC,KAAKC,MAAMT,EAAMU,MAE3B,eADEH,EAAQI,OAEdV,EAAOW,OAASL,EAAQM,MAI3B,CAAE,MAAOP,GAET,CACD,IAGD,IAAK,MAAML,KAAUT,EAAS,C,IAChBS,EAAb,MAAMa,GAA2B,QAApBb,EAAAA,EAAOc,aAAa,iBAApBd,IAAAA,EAAAA,EAAiC,IAC5Ce,QAAQ,eAAgB,YACxBA,QAAQ,iBAAkB,cAC5Bf,EAAOgB,aAAa,SAAUH,EAC/B,CAEA,OAAOlB,QAAQC,SAAS,C","sources":["webpack://@guardian/dotcom-rendering/./src/client/atomIframe.ts","webpack://@guardian/dotcom-rendering/./src/client/updateIframeHeight.tsx"],"sourcesContent":["import { updateIframeHeight } from './updateIframeHeight';\n\nexport const atomIframe = (): Promise<void> =>\n\tupdateIframeHeight('iframe.atom__iframe');\n","type HeightEventType = { source: { name: string } };\n\ntype Message = {\n\ttype: string;\n\tvalue: string;\n};\n\nexport const updateIframeHeight = (\n\tqueryString: `iframe${string}`,\n): Promise<void> => {\n\tconst iframes = [\n\t\t...document.querySelectorAll<HTMLIFrameElement>(queryString),\n\t];\n\n\tif (iframes.length === 0) return Promise.resolve();\n\n\twindow.addEventListener('message', (event) => {\n\t\tconst iframe = iframes.find((i) => {\n\t\t\ttry {\n\t\t\t\treturn i.name === (event as HeightEventType).source.name;\n\t\t\t} catch (e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tif (iframe) {\n\t\t\ttry {\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unsafe-argument -- weâ€™re in a try-catch\n\t\t\t\tconst message = JSON.parse(event.data) as Message;\n\t\t\t\tswitch (message.type) {\n\t\t\t\t\tcase 'set-height':\n\t\t\t\t\t\tiframe.height = message.value;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t// do nothing\n\t\t\t}\n\t\t}\n\t});\n\n\tfor (const iframe of iframes) {\n\t\tconst src = (iframe.getAttribute('srcdoc') ?? '')\n\t\t\t.replace(/<gu-script>/g, '<script>')\n\t\t\t.replace(/<\\/gu-script>/g, '<' + '/script>');\n\t\tiframe.setAttribute('srcdoc', src);\n\t}\n\n\treturn Promise.resolve();\n};\n"],"names":["atomIframe","updateIframeHeight","queryString","iframes","document","querySelectorAll","length","Promise","resolve","window","addEventListener","event","iframe","find","i","name","source","e","message","JSON","parse","data","type","height","value","src","getAttribute","replace","setAttribute"],"sourceRoot":""}