"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[9339],{60220:(e,t,r)=>{function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t),r.d(t,{SetABTests:()=>C});const i=e=>{let{mvtMaxValue:t=1e6,mvtId:r,pageIsSensitive:i,abTestSwitches:a,forcedTestVariants:s,forcedTestException:o,arrayOfTestObjects:c=[]}=e;const u=e=>{const c=(e=>{const n=t*e.audienceOffset,i=n+t*e.audience;var a;return r&&r>n&&r<=i&&null!==(a=e.variants[r%e.variants.length])&&void 0!==a?a:null})(e),u=((e,t)=>{var r;const n=e.id,i=null==t||null===(r=t[n])||void 0===r?void 0:r.variant;return!!i&&(a=i,null!==(s=e.variants.find((e=>e.id===a)))&&void 0!==s&&s);var a,s})(e,s),d=u||c;return o!==e.id&&(u||(e=>{const t=(r=e.expiry,(new Date).valueOf()>new Date(r).setHours(23,59,59,59));var r;const n=!!e.showForSensitive,s=a["ab".concat(e.id)]&&!!a["ab".concat(e.id)],o=e.canRun();return(!i||n)&&!!s&&!t&&o})(e))&&d&&(u||(e=>{const t="notintest"!==e.id;return e.canRun?e.canRun()&&t:t})(d))?(l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){n(e,t,r[t])}))}return e}({},e),p=null!=(p={variantToRun:d})?p:{},Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(p)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(p)).forEach((function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(p,e))})),l):null;var l,p},d=e=>e.reduce(((e,t)=>{const r=u(t);return r?[...e,r]:e}),[]);return{allRunnableTests:d,runnableTest:u,firstRunnableTest:e=>{var t;return null!==(t=e.map((e=>u(e))).find((e=>null!==e)))&&void 0!==t?t:null},isUserInVariant:(e,t)=>d(c).some((r=>r.id===e&&r.variantToRun.id===t))}},a=(e,t)=>t({abTestRegister:e}),s=(e,t)=>{const r={variantName:e.id,complete:t};return e.campaignCode&&(r.campaignCodes=[e.campaignCode]),r},o=e=>e.variants.every((e=>"function"==typeof e.impression)),c=(e,t,r)=>n=>{const i=n.variantToRun,o=e?i.success:i.impression;if(o)try{o(((e,t,r,n)=>{const i={[e.id]:s(t,r)};return()=>a(i,n)})(n,i,e,r))}catch(e){t(e)}};var u=Object.defineProperty,d=(e,t,r)=>((e,t,r)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class l{get allRunnableTests(){return this._core.allRunnableTests}get firstRunnableTest(){return this._core.firstRunnableTest}get runnableTest(){return this._core.runnableTest}get isUserInVariant(){return this._core.isUserInVariant}get registerCompleteEvents(){return this._ophan.registerCompleteEvents}get registerImpressionEvents(){return this._ophan.registerImpressionEvents}get trackABTests(){return this._ophan.trackABTests}constructor({abTestSwitches:e,arrayOfTestObjects:t,errorReporter:r,forcedTestException:n,forcedTestVariants:u,mvtId:l,mvtMaxValue:p,ophanRecord:f,pageIsSensitive:h,serverSideTests:v}){d(this,"_core"),d(this,"_ophan"),this._core=i({abTestSwitches:e,arrayOfTestObjects:t,forcedTestException:n,forcedTestVariants:u,mvtId:l,mvtMaxValue:p,pageIsSensitive:h}),this._ophan=(e=>{let{serverSideTests:t,errorReporter:r,ophanRecord:n}=e;return{registerCompleteEvents:e=>e.forEach(c(!0,r,n)),registerImpressionEvents:e=>e.filter(o).forEach(c(!1,r,n)),trackABTests:e=>a(((e,t,r)=>{try{const t={},n=Object.keys(r).filter((e=>!!r[e]));return e.filter((e=>!o(e))).forEach((e=>{t[e.id]=s(e.variantToRun,!1)})),n.forEach((e=>{t["ab".concat(e)]=s({id:"inTest",test:()=>{}},!1)})),t}catch(e){return t(e),{}}})(e,r,t),n)}})({errorReporter:r,ophanRecord:f,serverSideTests:v})}}var p=r(18411),f=r(9474),h=r(60439),v=r(67400),b=r(50026),g=r(81611),m=r(6595),O=r(70919),y=r(11733),w=r(52197);const T=[g.i,w.k,y.k,{id:"ConsentlessAds",author:"@guardian/commercial-dev",start:"2022-08-11",expiry:"2023-06-01",audience:0,audienceOffset:0,audienceCriteria:"All pageviews",successMeasure:"Testing Opt Out ads in production",description:"Use consentless ad stack rather than consented / standalone",variants:[{id:"control",test:()=>{}},{id:"variant",test:()=>{}}],canRun:()=>!0},O.l,{id:"MpuWhenNoEpic",author:"@commercial-dev",start:"2023-11-22",expiry:"2024-04-30",audience:.1,audienceOffset:.05,audienceCriteria:"",successMeasure:"",description:"Test MPU when there is no epic at the end of Article on the page.",variants:[{id:"control",test:()=>{}},{id:"variant",test:()=>{}}],canRun:()=>!0},m.K,{id:"OptimiseSpacefinderInline",author:"@commercial-dev",start:"2024-08-08",expiry:"2024-09-13",audience:.05,audienceOffset:0,audienceCriteria:"",successMeasure:"",description:"Test new spacefinder rules for inline1 ads on desktop.",variants:[{id:"control",test:()=>{}},{id:"variant",test:()=>{}}],canRun:()=>!0},{id:"UsaExpandableMarketingCard",start:"2024-10-02",expiry:"2024-12-18",author:"dotcom.platform@guardian.co.uk",description:"Test the impact of showing the user a component that highlights the Guardians journalism.",audience:.4,audienceOffset:0,audienceCriteria:"US-based users that see the US edition.",successMeasure:"Users are more likely to engage with the site.",canRun:()=>!0,variants:[{id:"control",test:()=>{}},{id:"variant-free",test:()=>{}},{id:"variant-bubble",test:()=>{}},{id:"variant-billionaire",test:()=>{}}]},{id:"OnwardsContentArticle",start:"2024-12-05",expiry:"2025-01-29",author:"dotcom.platform@guardian.co.uk",description:"Test the impact of showing the galleries onwards content component on article pages.",audience:.5,audienceOffset:.5,audienceCriteria:"Article pages",successMeasure:"Users are more likely to click a link in the onward content component.",canRun:()=>!0,variants:[{id:"control",test:()=>{}},{id:"variant",test:()=>{}}]}];function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const k=e=>e.startsWith("#ab")?e.replace("#ab-","").split(",").reduce(((e,t)=>{const[r,n]=t.split("=");return r&&n?(i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){j(e,t,r[t])}))}return e}({},e),a=null!=(a={[r]:{variant:n}})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i):e;var i,a}),{}):{};var R=r(67061),P=r(15593);function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const M=1e6,I=e=>{if(!e)return;const t=Number(e);return Number.isNaN(t)||t<1||t>M?void 0:t},C=e=>{let{isDev:t,pageIsSensitive:r,abTestSwitches:n,forcedTestVariants:i,serverSideTests:a}=e;const{renderingTarget:s}=(0,P.U)(),[o,c]=(0,v.useState)();return(0,v.useEffect)((()=>{(0,b.V5)(s).then(c).catch((e=>{console.log("There was an error retrieving the ophan window object",e)}))}),[s]),(0,v.useEffect)((()=>{if(!o)return;var e;const s=t&&null!==(e=I((0,p.R)({name:"GU_mvt_id_local",shouldMemoize:!0})))&&void 0!==e?e:I((0,p.R)({name:"GU_mvt_id",shouldMemoize:!0}));(0,f.b)(s)&&console.error("There is no MVT ID set, see SetABTests.importable.tsx");const c=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){E(e,t,r[t])}))}return e}({},i,k(window.location.hash)),u=new l({mvtId:null!=s?s:-1,mvtMaxValue:M,pageIsSensitive:r,abTestSwitches:n,arrayOfTestObjects:T,forcedTestVariants:c,ophanRecord:o.record,serverSideTests:a,errorReporter:e=>window.guardian.modules.sentry.reportError(e instanceof Error?e:Error(String(e)),"ab-tests")}),d=u.allRunnableTests(T),v=d.reduce(((e,t)=>{let{id:r,variantToRun:n}=t;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){S(e,t,r[t])}))}return e}({},e,{[r]:{variant:n.id}})}),{});(0,R.z)({api:u,participations:v}),u.trackABTests(d),u.registerImpressionEvents(d),u.registerCompleteEvents(d),(0,h.Rm)("dotcom","AB tests initialised")}),[n,i,t,r,o,a]),null}},81611:(e,t,r)=>{r.d(t,{i:()=>n});const n={id:"AbTestTest",start:"2020-05-20",expiry:"2023-12-01",author:"gtrufitt",description:"This Test",audience:1e-4,audienceOffset:0,successMeasure:"It works",audienceCriteria:"Everyone",idealOutcome:"It works",showForSensitive:!0,canRun:()=>!0,variants:[{id:"control",test:()=>{},impression:e=>{e()},success:e=>{e()}},{id:"variant",test:()=>{},impression:e=>{e()},success:e=>{e()}}]}},6595:(e,t,r)=>{r.d(t,{K:()=>n});const n={id:"AdBlockAsk",author:"@guardian/commercial-dev",start:"2024-04-10",expiry:"2024-05-31",audience:.1,audienceOffset:.1,audienceCriteria:"",successMeasure:"",description:"Show new ad block ask component in ad slots when we detect ad blocker usage",variants:[{id:"control",test:()=>{}},{id:"variant",test:()=>{}}],canRun:()=>!0}},70919:(e,t,r)=>{r.d(t,{l:()=>n});const n={id:"IntegrateIma",start:"2022-07-14",expiry:"2024-02-28",author:"Zeke Hunter-Green",description:"Test the commercial impact of replacing YouTube ads with Interactive Media Ads on first-party videos",audience:0,audienceOffset:.1,audienceCriteria:"Opt in",successMeasure:"IMA integration works as expected without adversely affecting pages with videos",canRun:()=>!0,variants:[{id:"control",test:()=>{}},{id:"variant",test:()=>{}}]}},11733:(e,t,r)=>{r.d(t,{k:()=>n});const n={id:"SignInGateMainControl",start:"2020-05-20",expiry:"2025-12-01",author:"Mahesh Makani",description:"Show sign in gate to 100% of users on 3rd article view of simple article templates, and show a further 5 times after the first dismissal, with higher priority over banners and epic. Control Audience.",audience:.1,audienceOffset:.9,successMeasure:"N/A - User does not see gate, only to compare to variant.",audienceCriteria:"3rd article of the day, lower priority than consent banner, simple articles (not gallery, live etc.), not signed in, not shown after dismiss, not on help, info sections etc. Exclude iOS 9 and guardian-live-australia. Suppresses other banners, and appears over epics",dataLinkNames:"SignInGateMain",idealOutcome:"Increase the number of users signed in whilst running at a reasonable scale",showForSensitive:!1,canRun:()=>!0,variants:[{id:"main-control-5",test:()=>{}}]}},52197:(e,t,r)=>{r.d(t,{k:()=>n});const n={id:"SignInGateMainVariant",start:"2020-06-09",expiry:"2025-12-01",author:"Mahesh Makani",description:"Show sign in gate to 100% of users on 3rd article view of simple article templates, and show a further 5 times after the first dismissal, with higher priority over banners and epic. Main/Variant Audience.",audience:.9,audienceOffset:0,successMeasure:"Users sign in or create a Guardian account",audienceCriteria:"3rd article of the day, lower priority than consent banner, simple articles (not gallery, live etc.), not signed in, not shown after dismiss, not on help, info sections etc. Exclude iOS 9 and guardian-live-australia. Suppresses other banners, and appears over epics",dataLinkNames:"SignInGateMain",idealOutcome:"Increase the number of users signed in whilst running at a reasonable scale",showForSensitive:!1,canRun:()=>!0,variants:[{id:"main-variant-5",test:()=>{}}]}},67061:(e,t,r)=>{r.d(t,{H:()=>o,z:()=>c});var n=r(29273),i=r(53994);const a=new Promise((()=>{})),s="ab-tests",o=()=>{const{data:e}=(0,i.A)(s,(()=>a));return e},c=e=>{let{api:t,participations:r}=e;(0,n.Tk)(s,{api:t,participations:r},!1)}}}]);
//# sourceMappingURL=SetABTests-importable.client.web.a87073dc404273b6f06c.js.map