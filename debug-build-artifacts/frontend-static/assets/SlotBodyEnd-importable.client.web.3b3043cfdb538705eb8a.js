"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[1104],{39395:(e,t,n)=>{n.d(t,{u:()=>i});var r=n(50484);const i=e=>{let{priority:t,defer:n,children:i,role:o}=e;const a="visible"===(null==n?void 0:n.until)?n.rootMargin:void 0,s=String(i.type.name);return(0,r.jsx)("gu-island",{name:s,priority:t,deferUntil:null==n?void 0:n.until,props:JSON.stringify(i.props),rootMargin:a,"data-spacefinder-role":o,children:i})}},44175:(e,t,n)=>{n.r(t),n.d(t,{SlotBodyEnd:()=>K});var r=n(50484),i=n(24017),o=n(54577),a=n(18411),s=n(72762),l=n(9474),c=n(77907),d=n(67400),u=n(99952),p=n(59820),f=n(67061),m=n(14374),b=n(37438),g=n(75747),h=n(97546),w=n(15593),y=n(50026),v=n(3002),C=n(70451),O=n(38169),S=n(97656),P=n(58452),E=n(53399);function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(){const e=(t=["\n\tmargin: 18px 0;\n"],n||(n=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})));var t,n;return D=function(){return e},e}const I=(0,i.css)(D()),M="RETENTION_EPIC",k=e=>{let{BrazeComponent:t,meta:n,countryCode:i,idApiUrl:o}=e;const a=(0,m.w)(),[s,l]=(0,P.E)({rootMargin:"-18px",threshold:0,debounce:!0}),c=(0,d.useRef)(null),{renderingTarget:u}=(0,w.U)();(0,E.H)((()=>{(0,y.u_)({component:{componentType:M,id:n.dataFromBraze.ophanComponentId},action:"INSERT"},u)}),[n.dataFromBraze,c.current]),(0,d.useEffect)((()=>{s&&(n.logImpressionWithBraze(),(0,y.u_)({component:{componentType:M,id:n.dataFromBraze.ophanComponentId},action:"VIEW"},u))}),[s,n,u]);const p=n.dataFromBraze.componentName;if(!p)return null;const f=(0,O.w)(o);return(0,r.jsx)("div",{ref:l,css:I,children:(0,r.jsx)("div",{ref:c,children:(0,r.jsx)(t,{componentName:p,brazeMessageProps:n.dataFromBraze,subscribeToNewsletter:async e=>{if("SignedInWithCookies"==a.kind||"SignedInWithOkta"==a.kind){const t=(0,S.Kv)(a);await fetch("".concat(o,"/users/me/newsletters"),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){j(e,t,n[t])}))}return e}({method:"PATCH",body:JSON.stringify({id:e,subscribed:!0})},t))}},countryCode:i,logButtonClickWithBraze:n.logButtonClickWithBraze,submitComponentEvent:e=>{(0,y.u_)(e,u)},fetchEmail:f})})})},A=e=>{let{meta:t,countryCode:i,idApiUrl:o}=e;const[a,s]=(0,d.useState)();return(0,d.useEffect)((()=>{Promise.all([n.e(4684),n.e(8007)]).then(n.bind(n,58200)).then((e=>{s((()=>e.BrazeEndOfArticleComponent))})).catch((e=>window.guardian.modules.sentry.reportError(e,"braze-epic")))}),[]),(0,r.jsx)(r.Fragment,{children:a?(0,r.jsx)(k,{BrazeComponent:a,meta:t,countryCode:i,idApiUrl:o}):(0,r.jsx)("div",{})})};var R=n(61082),L=n(88793),B=n(9092),z=n(29995),x=n(36226),T=n(20522);function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){N(e,t,n[t])}))}return e}function F(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function _(){const e=(t=["\n\tmargin: 18px 0;\n\tclear: both;\n"],n||(n=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})));var t,n;return _=function(){return e},e}const H=(0,i.css)(_()),W=e=>{let{module:t,fetchEmail:i,hasConsentForArticleCount:o,stage:a}=e;const[s,l]=(0,d.useState)(null),{renderingTarget:c}=(0,w.U)();return(0,d.useEffect)((()=>{(0,T.q)();const{endPerformanceMeasure:e}=(0,L.h)("supporterRevenue","contributions-epic-module");Promise.all([n.e(4684),n.e(8920),n.e(6398),n.e(3789),n.e(1076),n.e(5721),n.e(1262),n.e(6627),n.e(895)]).then(n.bind(n,30895)).then((t=>{e(),l((()=>t.ContributionsEpic))})).catch((e=>{const t=e instanceof Error?"Error importing RR epic: ".concat(e.message):"Unknown error";console.log(t),window.guardian.modules.sentry.reportError(new Error(t),"rr-epic")}))}),[]),null!==s?(0,r.jsx)("div",{css:H,children:(0,r.jsx)(s,F(U({},t.props),{fetchEmail:i,submitComponentEvent:e=>{(0,y.u_)(e,c)},openCmp:()=>{B.r2.showPrivacyManager()},hasConsentForArticleCount:o,stage:a}))}):null};function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(){const e=(t=["\n\tcolor: ",";\n"],n||(n=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})));var t,n;return V=function(){return e},e}const J=(0,i.css)(V(),c.M.neutral[7]),Q=e=>({candidate:{id:"reader-revenue-banner",canShow:()=>(async e=>{var t;const{isSignedIn:n,shouldHideReaderRevenue:r,isPaidContent:i,contributionsServiceUrl:o,idApiUrl:s,stage:l}=e,c=(0,x.h3)(n);if("Pending"===c)return Promise.resolve({show:!1});if(r||i)return Promise.resolve({show:!1});const{endPerformanceMeasure:d}=(0,L.h)("supporterRevenue","contributions-epic-data"),u=await(async e=>({tracking:{ophanPageId:window.guardian.config.ophan.pageViewId,platformId:"GUARDIAN_WEB",clientName:"dcr",referrerUrl:window.location.origin+window.location.pathname},targeting:{contentType:e.contentType,sectionId:e.sectionId,shouldHideReaderRevenue:e.shouldHideReaderRevenue,isMinuteArticle:e.isMinuteArticle,isPaidContent:e.isPaidContent,tags:e.tags,showSupportMessaging:!e.hideSupportMessagingForUser,epicViewLog:(0,z.DS)(R.I.local),weeklyArticleHistory:await e.asyncArticleCount,hasOptedOutOfArticleCount:await(0,x.Jj)(),mvtId:Number((0,a.R)({name:"GU_mvt_id",shouldMemoize:!0})),countryCode:e.countryCode,url:window.location.origin+window.location.pathname,browserId:await(0,x.Xr)()?e.browserId:void 0,isSignedIn:e.isSignedIn}}))(F(U({},e),{hideSupportMessagingForUser:c})),p=null===(t=(await(0,z.Am)(o,u)).data)||void 0===t?void 0:t.module;return d(),p?{show:!0,meta:{module:p,fetchEmail:n?(0,O.w)(s):void 0,hasConsentForArticleCount:await(0,x.mV)(),stage:l}}:{show:!1}})(e),show:e=>()=>(0,r.jsx)(W,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){G(e,t,n[t])}))}return e}({},e))},timeoutMillis:null}),q=(e,t,n,i,o,a,s)=>({candidate:{id:"braze-epic",canShow:()=>(async(e,t,n,r,i)=>{if("interactive"===n.toLowerCase())return{show:!1};const o=(0,v.B)();if(o)return{show:!0,meta:o};if(i)return{show:!1};if((0,C.O)(r))return{show:!1};try{const n=await e.getMessageForEndOfArticle(t);return n.extras?{show:!0,meta:{dataFromBraze:n.extras,logImpressionWithBraze:()=>{n.logImpression()},logButtonClickWithBraze:e=>{n.logButtonClick(e)}}}:{show:!1}}catch(e){return{show:!1}}})(e,o,i,a,s),show:e=>()=>(0,r.jsx)(A,{meta:e,countryCode:t,idApiUrl:n})},timeoutMillis:2e3}),K=e=>{let{contentType:t,sectionId:n,shouldHideReaderRevenue:i,isMinuteArticle:c,isPaidContent:y,tags:v,contributionsServiceUrl:C,idApiUrl:O,stage:S,pageId:P,renderAds:E,isLabs:j,articleEndSlot:D}=e;const{renderingTarget:I}=(0,w.U)(),{brazeMessages:M}=(0,b.m)(O,I),k=(0,g.F)("slot-body-end"),A=(0,m.T)(),R=(()=>{const[e,t]=(0,d.useState)();return(0,d.useEffect)((()=>{const e=(0,a.R)({name:"bwid",shouldMemoize:!0}),n=(0,s.K)(e)?e:"no-browser-id-available";t(n)}),[]),e})(),[L,B]=(0,d.useState)(),[z,x]=(0,d.useState)(),T="US"===k,N=(0,f.H)(),U=null==N?void 0:N.api;var F;const _=null!==(F=(null==U?void 0:U.isUserInVariant("MpuWhenNoEpic","variant"))&&"GB"===k)&&void 0!==F&&F,H=E&&!j&&(T||_)&&D;return(0,d.useEffect)((()=>{x((0,u.r2)(P,v,t).then((e=>null==e?void 0:e.weeklyArticleHistory)))}),[t,v,P]),(0,d.useEffect)((()=>{if((0,l.b)(k)||(0,l.b)(M)||(0,l.b)(z)||(0,l.b)(R)||"Pending"===A)return;const e=Q({isSignedIn:A,countryCode:k,contentType:t,sectionId:n,shouldHideReaderRevenue:i,isMinuteArticle:c,isPaidContent:y,tags:v,contributionsServiceUrl:C,idApiUrl:O,stage:S,asyncArticleCount:z,browserId:R}),r={candidates:[q(M,k,O,t,{section:n},v,i),e],name:"slotBodyEnd"};(0,p.h)(r,I).then((e=>B(e))).catch((e=>console.error("SlotBodyEnd pickMessage - error: ".concat(String(e)))))}),[A,k,M,z,R,t,C,O,c,y,I,n,i,S,v]),(0,d.useEffect)((()=>{if(null===L&&H){const e=()=>_?{desktop:[o.EA.outstreamDesktop,o.EA.outstreamGoogleDesktop]}:T?{mobile:[o.EA.fluid]}:{};document.dispatchEvent(new CustomEvent("gu.commercial.slot.fill",{detail:{slotId:"dfp-ad--article-end",additionalSizes:e()}}))}}),[L,H,_,T]),null===L||(0,l.b)(L)?null===L&&H?(0,r.jsx)("div",{id:"slot-body-end",css:J,children:(0,r.jsx)(h.u,{"data-print-layout":"hide",position:"article-end"})}):null:(0,r.jsx)("div",{id:"slot-body-end",css:J,children:(0,r.jsx)(L,{})})}},16632:(e,t,n)=>{n.d(t,{A$:()=>a,B0:()=>o,M2:()=>d,Ns:()=>i,vw:()=>r});var r=function(e){return e[e.Standard=0]="Standard",e[e.Picture=1]="Picture",e[e.Gallery=2]="Gallery",e[e.Audio=3]="Audio",e[e.Video=4]="Video",e[e.Review=5]="Review",e[e.Analysis=6]="Analysis",e[e.Explainer=7]="Explainer",e[e.Comment=8]="Comment",e[e.Letter=9]="Letter",e[e.Feature=10]="Feature",e[e.LiveBlog=11]="LiveBlog",e[e.DeadBlog=12]="DeadBlog",e[e.Recipe=13]="Recipe",e[e.MatchReport=14]="MatchReport",e[e.Interview=15]="Interview",e[e.Editorial=16]="Editorial",e[e.Quiz=17]="Quiz",e[e.Interactive=18]="Interactive",e[e.PhotoEssay=19]="PhotoEssay",e[e.Obituary=20]="Obituary",e[e.Correction=21]="Correction",e[e.FullPageInteractive=22]="FullPageInteractive",e[e.NewsletterSignup=23]="NewsletterSignup",e[e.Timeline=24]="Timeline",e[e.Profile=25]="Profile",e}({}),i=function(e){return e[e.Standard=0]="Standard",e[e.Immersive=1]="Immersive",e[e.Showcase=2]="Showcase",e[e.NumberedList=3]="NumberedList",e}({}),o=function(e){return e[e.News=0]="News",e[e.Opinion=1]="Opinion",e[e.Sport=2]="Sport",e[e.Culture=3]="Culture",e[e.Lifestyle=4]="Lifestyle",e}({}),a=function(e){return e[e.SpecialReport=5]="SpecialReport",e[e.Labs=6]="Labs",e[e.SpecialReportAlt=7]="SpecialReportAlt",e}({});const s=e=>{let{design:t}=e;switch(t){case"ArticleDesign":default:return 0;case"PictureDesign":return 1;case"GalleryDesign":return 2;case"AudioDesign":return 3;case"VideoDesign":return 4;case"ReviewDesign":return 5;case"AnalysisDesign":return 6;case"CommentDesign":return 8;case"LetterDesign":return 9;case"FeatureDesign":return 10;case"LiveBlogDesign":return 11;case"DeadBlogDesign":return 12;case"RecipeDesign":return 13;case"MatchReportDesign":return 14;case"InterviewDesign":return 15;case"EditorialDesign":return 16;case"QuizDesign":return 17;case"InteractiveDesign":return 18;case"PhotoEssayDesign":return 19;case"ObituaryDesign":return 20;case"FullPageInteractiveDesign":return 22;case"NewsletterSignupDesign":return 23;case"ExplainerDesign":return 7;case"TimelineDesign":return 24;case"ProfileDesign":return 25}},l=e=>{let{display:t,design:n}=e;switch(t){case"StandardDisplay":default:return 0;case"ImmersiveDisplay":return"CommentDesign"===n?0:1;case"ShowcaseDisplay":return 2;case"NumberedListDisplay":return 3}},c=e=>{let{theme:t}=e;switch(t){case"NewsPillar":default:return 0;case"OpinionPillar":return 1;case"SportPillar":return 2;case"CulturePillar":return 3;case"LifestylePillar":return 4;case"SpecialReportTheme":return 5;case"SpecialReportAltTheme":return 7;case"Labs":return 6}},d=e=>({design:s(e),display:l(e),theme:c(e)})},53694:(e,t,n)=>{n.d(t,{M:()=>r});const r=e=>"var(".concat(e,")")},92280:(e,t,n)=>{n.d(t,{f:()=>r});const r={desktop:980,leftCol:1140,mobile:320,mobileLandscape:480,mobileMedium:375,phablet:660,tablet:740,wide:1300}},99923:(e,t,n)=>{n.d(t,{HT:()=>s,TG:()=>l,Tq:()=>c});var r=n(92280);const i=e=>"@media (min-width: ".concat("".concat(e,"px"),")"),o=e=>"@media (max-width: ".concat("".concat(e-.1,"px"),")"),a=(e,t)=>"@media (min-width: ".concat("".concat(e,"px"),") and (max-width: ").concat("".concat(t-.1,"px"),")"),s={mobile:i(r.f.mobile),mobileMedium:i(r.f.mobileMedium),mobileLandscape:i(r.f.mobileLandscape),phablet:i(r.f.phablet),tablet:i(r.f.tablet),desktop:i(r.f.desktop),leftCol:i(r.f.leftCol),wide:i(r.f.wide)},l={mobile:o(r.f.mobile),mobileMedium:o(r.f.mobileMedium),mobileLandscape:o(r.f.mobileLandscape),phablet:o(r.f.phablet),tablet:o(r.f.tablet),desktop:o(r.f.desktop),leftCol:o(r.f.leftCol),wide:o(r.f.wide)},c={mobile:{and:{mobileMedium:a(r.f.mobile,r.f.mobileMedium),mobileLandscape:a(r.f.mobile,r.f.mobileLandscape),phablet:a(r.f.mobile,r.f.phablet),tablet:a(r.f.mobile,r.f.tablet),desktop:a(r.f.mobile,r.f.desktop),leftCol:a(r.f.mobile,r.f.leftCol),wide:a(r.f.mobileMedium,r.f.wide)}},mobileMedium:{and:{mobileLandscape:a(r.f.mobileMedium,r.f.mobileLandscape),phablet:a(r.f.mobileMedium,r.f.phablet),tablet:a(r.f.mobileMedium,r.f.tablet),desktop:a(r.f.mobileMedium,r.f.desktop),leftCol:a(r.f.mobileMedium,r.f.leftCol),wide:a(r.f.mobileMedium,r.f.wide)}},mobileLandscape:{and:{phablet:a(r.f.mobileLandscape,r.f.phablet),tablet:a(r.f.mobileLandscape,r.f.tablet),desktop:a(r.f.mobileLandscape,r.f.desktop),leftCol:a(r.f.mobileLandscape,r.f.leftCol),wide:a(r.f.mobileLandscape,r.f.wide)}},phablet:{and:{tablet:a(r.f.phablet,r.f.tablet),desktop:a(r.f.phablet,r.f.desktop),leftCol:a(r.f.phablet,r.f.leftCol),wide:a(r.f.phablet,r.f.wide)}},tablet:{and:{desktop:a(r.f.tablet,r.f.desktop),leftCol:a(r.f.tablet,r.f.leftCol),wide:a(r.f.tablet,r.f.wide)}},desktop:{and:{leftCol:a(r.f.desktop,r.f.leftCol),wide:a(r.f.desktop,r.f.wide)}},leftCol:{and:{wide:a(r.f.leftCol,r.f.wide)}}}}}]);
//# sourceMappingURL=SlotBodyEnd-importable.client.web.3b3043cfdb538705eb8a.js.map