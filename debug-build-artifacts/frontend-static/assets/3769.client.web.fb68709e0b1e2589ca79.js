"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[3769],{53769:(t,e,n)=>{n.d(e,{d:()=>ji});var r=n(50484),o=n(24017),s=n(61082),i=n(9474),c=n(96378),a=n(1255),d=n(67400),u=n(16488),l=n(38679),m=n(72762),p=n(92582);const f=["newest","oldest","recommendations"],h=["collapsed","expanded","unthreaded"],x=[25,50,100];var g=n(53694),b=n(7351),y=n(15593),v=n(76629);const j=(0,d.createContext)((()=>{(0,v.Y)("dotcom","The 'dispatch' function in discussion is not defined! Did you remember to include a context provider for it?")})),w=t=>{let{value:e,children:n}=t;return(0,r.jsx)(j.Provider,{value:e,children:n})};var k=n(99923),C=n(95571),P=n(28481),O=n(27123),M=n(54684),S=n(60439),I=n(55932),E=n(93690),T=n(3461),z=n(32444),R=n(12069),F=n(39452),U=n(56607);function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){D(t,e,n[e])}))}return t}function N(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function B(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function A(){const t=B(["\n\tz-index: 1;\n\tborder: 1px solid ",";\n\tposition: absolute;\n\twidth: 300px;\n\ttop: 0;\n\tright: 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: ","px;\n\tbackground-color: ",";\n\t",";\n"]);return A=function(){return t},t}function Y(){const t=B(["\n\tbackground-color: ",";\n"]);return Y=function(){return t},t}function _(){const t=B(["\n\tselect,\n\tinput,\n\ttextarea {\n\t\tborder: 1px solid ",";\n\t}\n"]);return _=function(){return t},t}function H(){const t=B(["\n\tselect,\n\tinput,\n\ttextarea {\n\t\tborder: 1px solid ",";\n\t}\n"]);return H=function(){return t},t}function K(){const t=B(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin-bottom: ","px;\n\n\tlabel {\n\t\tdisplay: block;\n\t}\n\n\tselect,\n\tinput,\n\ttextarea {\n\t\tbackground-color: ",";\n\t\tmin-height: ","px;\n\t\twidth: 75%;\n\t\tcolor: inherit;\n\t}\n"]);return K=function(){return t},t}function q(){const t=B(["\n\tdiv {\n\t\tsvg {\n\t\t\tright: 80px;\n\t\t\tfill: ",";\n\t\t}\n\t}\n"]);return q=function(){return t},t}function G(){const t=B(["\n\tspan[role='alert'] {\n\t\tsvg {\n\t\t\tfill: ",";\n\t\t}\n\t}\n"]);return G=function(){return t},t}function V(){const t=B(["\n\t\t\t\t\t\t\t\tcolor: ",";\n\t\t\t\t\t\t\t\tpadding-top: ","px;\n\t\t\t\t\t\t\t"]);return V=function(){return t},t}function $(){const t=B(["\n\t\t\t\t\t\t\t\tcolor: ",";\n\t\t\t\t\t\t\t\tpadding-top: ","px;\n\t\t\t\t\t\t\t"]);return $=function(){return t},t}function W(){const t=B(["\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\tright: ","px;\n\t\t\t\t\t\ttop: ","px;\n\t\t\t\t\t"]);return W=function(){return t},t}const J=(0,o.css)(A(),(0,g.M)("--discussion-border"),c.x[3],(0,g.M)("--discussion-report-background"),b.Ikj),X=(0,g.M)("--discussion-report-label-text"),Z=(0,g.M)("--discussion-report-error-text"),Q=(0,o.css)(Y(),(0,g.M)("--discussion-report-button")),tt=(0,o.css)(_(),(0,g.M)("--discussion-report-error-text")),et=(0,o.css)(H(),(0,g.M)("--discussion-report-border")),nt=(0,o.css)(K(),c.x[2],(0,g.M)("--discussion-report-background"),c.x[5]),rt=(0,o.css)(q(),X),ot=(0,o.css)(G(),Z),st=t=>{let{commentId:e,toggleSetShowForm:n,reportAbuse:s}=t;const i=(0,d.useRef)(null);let a=null,u=null;(0,d.useEffect)((()=>{i.current&&(a=i.current.querySelector('select[name="category"]'),u=i.current.querySelector('button[custom-guardian="close-modal"]'))}),[i]),(0,d.useEffect)((()=>{null==a||a.focus()}),[a]),(0,d.useEffect)((()=>{document.addEventListener("mousedown",(t=>{i.current&&!i.current.contains(t.target)&&n()}))}),[i,n]),(0,d.useEffect)((()=>{const t=t=>{if("Escape"===t.code)n();else if("Tab"===t.code){if(!a||!u)return;t.shiftKey||document.activeElement!==u||(a.focus(),t.preventDefault()),t.shiftKey&&document.activeElement===a&&(u.focus(),t.preventDefault())}};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)}));const[l,m]=(0,d.useState)({categoryId:0,reason:"",email:""}),p={categoryId:"",reason:"",email:"",response:""},[f,h]=(0,d.useState)(p),[x,b]=(0,d.useState)(),y=9===l.categoryId||3===l.categoryId;return(0,r.jsx)("div",{"aria-modal":"true",ref:i,children:(0,r.jsxs)("form",{css:J,onSubmit:t=>{t.preventDefault();const{categoryId:n,reason:r,email:o}=l;h(p),n?s({categoryId:n,reason:r,email:o,commentId:e}).then((t=>{"error"===t.kind?h(N(L({},f),{response:t.error})):b("Report submitted")})).catch((()=>{(0,S.Rm)("dotcom","Discussion: error reporting abuse")})):h(N(L({},f),{categoryId:"You must select a category before submitting"}))},children:[(0,r.jsx)("div",{css:[nt,rt,ot,f.categoryId?tt:et],children:(0,r.jsxs)(I.l,{label:"Category",onChange:t=>{m(N(L({},l),{categoryId:Number(t.target.value)})),f.categoryId="",h(f)},value:l.categoryId,theme:{textLabel:X,textOptional:X,textError:Z,borderError:Z},error:f.categoryId?f.categoryId:void 0,children:[(0,r.jsx)(E.c,{value:"0",children:"Please select"}),(0,r.jsx)(E.c,{value:"1",children:"Personal abuse"}),(0,r.jsx)(E.c,{value:"2",children:"Off topic"}),(0,r.jsx)(E.c,{value:3,children:"Legal issue"}),(0,r.jsx)(E.c,{value:"4",children:"Trolling"}),(0,r.jsx)(E.c,{value:"5",children:"Hate speech"}),(0,r.jsx)(E.c,{value:"6",children:"Offensive/Threatening language"}),(0,r.jsx)(E.c,{value:"7",children:"Copyright"}),(0,r.jsx)(E.c,{value:"8",children:"Spam"}),(0,r.jsx)(E.c,{value:9,children:"Other"})]})}),(0,r.jsx)("div",{css:[nt,rt,ot,f.reason?tt:et],children:(0,r.jsx)(T.f,{id:"reason",size:"medium",label:"Reason",optional:!y,onChange:t=>m(N(L({},l),{reason:t.target.value})),value:l.reason,required:y,theme:{textLabel:X,textOptional:X,textError:Z,borderError:Z},error:f.reason?f.reason:void 0})}),(0,r.jsx)("div",{css:[nt,rt,ot,f.email?tt:et],children:(0,r.jsx)(z.k,{label:"Email",optional:!0,id:"email",type:"email",onChange:t=>m(N(L({},l),{email:t.target.value})),value:l.email,theme:{textLabel:X,textOptional:X,textError:Z,borderError:Z},error:f.email?f.email:void 0})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(O.$,{type:"submit",size:"small","data-link-name":"Post report abuse",cssOverrides:Q,children:"Report"}),!!f.response&&(0,r.jsx)(R.W,{cssOverrides:(0,o.css)(V(),Z,c.x[2]),children:f.response}),!!x&&(0,r.jsx)(F.H,{cssOverrides:(0,o.css)($(),(0,g.M)("--discussion-report-success-text"),c.x[2]),children:x})]}),(0,r.jsx)("div",{css:(0,o.css)(W(),c.x[3],c.x[3]),children:(0,r.jsx)(O.$,{"custom-guardian":"close-modal",size:"small",iconSide:"right",icon:(0,r.jsx)(U.F,{}),onClick:n,"data-link-name":"cancel-report-abuse",hideLabel:!0,cssOverrides:Q,children:"close report abuse modal"})})]})})};function it(){const t=(e=["\n\tborder-radius: ","px;\n\twidth: ","px;\n\theight: ","px;\n"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));var e,n;return it=function(){return t},t}const ct=t=>(0,o.css)(it(),t+10,t,t),at=t=>{let{imageUrl:e="https://avatar.guim.co.uk/no-user-image.gif",displayName:n,size:o}=t;switch(o){case"small":return(0,r.jsx)("img",{src:e,alt:n,css:ct(36)});case"large":return(0,r.jsx)("img",{src:e,alt:n,css:ct(60)});default:return(0,r.jsx)("img",{src:e,alt:n,css:ct(48)})}};function dt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function ut(){const t=dt(["\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n"]);return ut=function(){return t},t}function lt(){const t=dt(["\n\tdisplay: inline-block;\n\twidth: 15px;\n\theight: 15px;\n"]);return lt=function(){return t},t}function mt(){const t=dt(["\n\tdisplay: inline-block;\n\tline-height: 15px;\n\tmargin: 0 0 0 ","px;\n\t",";\n"]);return mt=function(){return t},t}function pt(){const t=dt(["\n\tcolor: ",";\n"]);return pt=function(){return t},t}function ft(){const t=dt(["\n\tcolor: ",";\n"]);return ft=function(){return t},t}const ht=(0,o.css)(ut()),xt=(0,o.css)(lt()),gt=(0,o.css)(mt(),c.x[1],b.rDY),bt=(0,o.css)(pt(),(0,g.M)("--discussion-staff-label-text")),yt=(0,o.css)(ft(),(0,g.M)("--discussion-pick-label-text")),vt=()=>(0,r.jsxs)("div",{css:ht,children:[(0,r.jsxs)("svg",{width:"36",height:"36",viewBox:"0 0 36 36",css:xt,fill:(0,g.M)("--staff-contributor-badge"),children:[(0,r.jsx)("path",{d:"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36"}),(0,r.jsx)("path",{fill:(0,g.M)("--staff-contributor-badge-text"),d:"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z"})]}),(0,r.jsx)("p",{css:[gt,bt],children:"Staff"})]}),jt=()=>(0,r.jsxs)("div",{css:ht,children:[(0,r.jsxs)("svg",{width:"36",height:"36",viewBox:"0 0 36 36",css:xt,fill:(0,g.M)("--staff-contributor-badge"),children:[(0,r.jsx)("path",{d:"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36"}),(0,r.jsx)("path",{fill:(0,g.M)("--staff-contributor-badge-text"),d:"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z"})]}),(0,r.jsx)("p",{css:[gt,bt],children:"Contributor"})]}),wt=()=>(0,r.jsxs)("div",{css:ht,children:[(0,r.jsxs)("svg",{width:"36",height:"36",viewBox:"0 0 36 36",css:xt,fill:(0,g.M)("--staff-pick-badge"),children:[(0,r.jsx)("path",{d:"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36"}),(0,r.jsx)("path",{fill:(0,g.M)("--staff-pick-badge-text"),d:"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z"})]}),(0,r.jsx)("p",{css:[gt,yt],children:"Guardian Pick"})]});function kt(){const t=(e=["\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));var e,n;return kt=function(){return t},t}const Ct=t=>{let{children:e}=t;return(0,r.jsx)("div",{css:(0,o.css)(kt()),children:e})};var Pt=n(58701);function Ot(){const t=(e=["\n\tdisplay: flex;\n\tflex-direction: row;\n"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));var e,n;return Ot=function(){return t},t}const Mt=(0,o.css)(Ot()),St=t=>{let{children:e,wrap:n=!1,cssOverrides:o}=t;return(0,r.jsx)("div",{css:[Mt,o],style:{flexWrap:n?"wrap":void 0},children:e})};function It(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Et(){const t=It(["\n\t",";\n\t/**\n\t * Typography preset styles should not be overridden.\n\t * This has been done because the styles do not directly map to the new presets.\n\t * Please speak to your team's designer and update this to use a more appropriate preset.\n\t */\n\tfont-weight: 300;\n\tmin-width: 0.75rem;\n\tcolor: ",";\n\tmargin-right: 0.3125rem;\n"]);return Et=function(){return t},t}function Tt(){const t=It(["\n\tcursor: ",";\n\twidth: 1.1875rem;\n\theight: 1.1875rem;\n\tbackground-color: ",";\n\tborder-radius: 62.5rem;\n\tborder: none;\n"]);return Tt=function(){return t},t}function zt(){const t=It(["\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tsvg {\n\t\tfill: ",";\n\t\theight: 15px;\n\t\twidth: 15px;\n\t}\n"]);return zt=function(){return t},t}const Rt=(0,o.css)(Et(),b.Ikj,(0,g.M)("--discussion-subdued")),Ft=(t,e)=>(0,o.css)(Tt(),t||!e?"default":"pointer",t?(0,g.M)("--recommendation-count-selected"):(0,g.M)("--recommendation-count")),Ut=t=>(0,o.css)(zt(),t?(0,g.M)("--recommendation-count-arrow-selected"):(0,g.M)("--recommendation-count-arrow")),Dt=t=>{let{commentId:e,initialCount:n,alreadyRecommended:o,user:s,userMadeComment:i,isClosedForRecommendations:c}=t;const[a,u]=(0,d.useState)(n),[l,m]=(0,d.useState)(o);return(0,r.jsxs)(St,{children:[(0,r.jsx)("div",{css:Rt,children:a}),(0,r.jsx)("button",{css:Ft(l,!!s),onClick:()=>{if(!s)return;const t=a+1;u(t),m(!0),s.onRecommend(e).then((e=>{e||(u(t-1),m(o))})).catch((()=>{}))},disabled:l||!s||i||c,"data-link-name":"Recommend comment","aria-label":"Recommend comment",type:"button",children:(0,r.jsx)("div",{css:Ut(l),children:(0,r.jsx)(Pt.B,{})})})]})};var Lt=n(73785);const Nt=t=>{const e=new Date(t);return(t=>{const e=Math.round((new Date).getTime()/1e3)-86400;return t.getTime()>=new Date(1e3*e).getTime()})(e)?(0,Lt.f)(e.getTime(),{verbose:!0,daysUntilAbsolute:1}):"".concat(e.getDate()," ").concat((t=>{switch(t){case 0:return"Jan";case 1:return"Feb";case 2:return"Mar";case 3:return"Apr";case 4:return"May";case 5:return"Jun";case 6:return"Jul";case 7:return"Aug";case 8:return"Sep";case 9:return"Oct";case 10:return"Nov";case 11:return"Dec";default:return""}})(e.getMonth())," ").concat(e.getFullYear()," ").concat(e.getHours(),".").concat(String(e.getMinutes()).padStart(2,"0"))};function Bt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function At(){const t=Bt(["\n\tcolor: ",";\n\ttext-decoration: none;\n\t:hover,\n\t:focus {\n\t\ttext-decoration: underline;\n\t}\n"]);return At=function(){return t},t}function Yt(){const t=Bt(["\n\t",";\n\t/**\n\t * Typography preset styles should not be overridden.\n\t * This has been done because the styles do not directly map to the new presets.\n\t * Please speak to your team's designer and update this to use a more appropriate preset.\n\t */\n\tfont-weight: 300;\n\tmin-width: 0.75rem;\n\tmargin-right: 0.3125rem;\n\twhite-space: nowrap;\n"]);return Yt=function(){return t},t}const _t=(0,o.css)(At(),(0,g.M)("--discussion-subdued")),Ht=(0,o.css)(Yt(),b.Ikj),Kt=t=>{let{isoDateTime:e,webUrl:n,commentId:o,onPermalinkClick:s}=t;const[i,c]=(0,d.useState)(Nt(e));return((t,e)=>{const n=(0,d.useRef)();(0,d.useEffect)((()=>{n.current=t}),[t]),(0,d.useEffect)((()=>{const t=setInterval((function(){const t=n.current;t&&t()}),15e3);return()=>clearInterval(t)}),[15e3])})((()=>{c(Nt(e))})),(0,r.jsx)("a",{href:n,css:_t,"data-link-name":"jump-to-comment-timestamp",onClick:t=>{s(o),t.preventDefault()},rel:"nofollow",children:(0,r.jsx)("time",{dateTime:e.toString(),css:Ht,children:i})})};function qt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Gt(){const t=qt(["\n\tmargin-top: -2px;\n\n\ta {\n\t\t","\n\t\tmargin-right: ","px;\n\t\tcolor: ",";\n\t\t/*\n      We do not want underline to be applied to SVG\n      therefore we override the styles and apply them to the nested <span>\n    */\n\t\t:hover {\n\t\t\ttext-decoration: none;\n\t\t\ttext-decoration-color: none;\n\t\t\tspan {\n\t\t\t\tcolor: ",";\n\t\t\t\ttext-decoration: underline;\n\t\t\t\ttext-decoration-color: ",";\n\t\t\t}\n\t\t}\n\t}\n"]);return Gt=function(){return t},t}function Vt(){const t=qt(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n"]);return Vt=function(){return t},t}function $t(){const t=qt(["\n\tdisplay: block;\n\tclear: left;\n\t","\n\tmargin-top: ",";\n\tmargin-bottom: ",";\n\tword-break: break-word;\n\n\tp {\n\t\tmargin-top: 0;\n\t\tmargin-bottom: ","px;\n\t}\n\n\tblockquote {\n\t\tmargin-top: ","px;\n\t\tmargin-bottom: ","px;\n\t\tmargin-left: ","px;\n\t\tmargin-right: ","px;\n\t\tpadding-left: ","px;\n\t\tcolor: ",";\n\t}\n\n\ti {\n\t\tfont-style: italic;\n\t}\n\n\tb {\n\t\tfont-weight: bold;\n\t}\n\n\tcode {\n\t\t/* stylelint-disable-next-line property-disallowed-list -- we do not have a monospace Source font */\n\t\tfont-family: monospace;\n\t\tfont-size: 1em;\n\t}\n"]);return $t=function(){return t},t}function Wt(){const t=qt(["\n\tcolor: ",";\n\t","\n"]);return Wt=function(){return t},t}function Jt(){const t=qt(["\n\ta {\n\t\tcolor: ",";\n\t\ttext-decoration-color: ",";\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n"]);return Jt=function(){return t},t}function Xt(){const t=qt(["\n\tborder-top: 1px solid ",";\n\tdisplay: flex;\n\tpadding: ","px 0;\n"]);return Xt=function(){return t},t}function Zt(){const t=qt(["\n\tbackground-color: ",";\n\tmargin-left: -","px;\n\tpadding-left: ","px;\n\tmargin-right: -","px;\n\tpadding-right: ","px;\n"]);return Zt=function(){return t},t}function Qt(){const t=qt(["\n\tmargin-right: ","px;\n\n\t"," {\n\t\tdisplay: none;\n\t}\n"]);return Qt=function(){return t},t}function te(){const t=qt(["\n\ta {\n\t\tcolor: ",";\n\t\ttext-decoration-color: ",";\n\t\t:hover {\n\t\t\tcolor: ",";\n\t\t\ttext-decoration-color: ",";\n\t\t}\n\t}\n"]);return te=function(){return t},t}function ee(){const t=qt(["\n\ta {\n\t\t","\n\t}\n"]);return ee=function(){return t},t}function ne(){const t=qt(["\n\ta {\n\t\t","\n\t}\n"]);return ne=function(){return t},t}function re(){const t=qt(["\n\tsvg {\n\t\t/* stylelint-disable-next-line declaration-no-important */\n\t\tfill: "," !important;\n\t}\n"]);return re=function(){return t},t}function oe(){const t=qt(["\n\tflex-grow: 1;\n\twidth: 100%;\n"]);return oe=function(){return t},t}function se(){const t=qt(["\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n"]);return se=function(){return t},t}function ie(){const t=qt(["\n\tpadding: 2px;\n\twhite-space: nowrap;\n"]);return ie=function(){return t},t}function ce(){const t=qt(["\n\tmargin-left: ","px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n"]);return ce=function(){return t},t}function ae(){const t=qt(["\n\t"," {\n\t\tdisplay: none;\n\t}\n"]);return ae=function(){return t},t}function de(){const t=qt(["\n\t"," {\n\t\tdisplay: none;\n\t}\n"]);return de=function(){return t},t}function ue(){const t=qt(["\n\tmargin-top: 0px;\n\tmargin-bottom: -6px;\n"]);return ue=function(){return t},t}function le(){const t=qt(["\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n"]);return le=function(){return t},t}function me(){const t=qt(["\n\t"," {\n\t\tpadding-right: 10px;\n\t\twidth: calc(100% - 35px);\n\t\tbox-sizing: border-box;\n\t}\n"]);return me=function(){return t},t}function pe(){const t=qt(["\n\tbutton {\n\t\tcolor: ",";\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ",";\n\t\t}\n\t}\n"]);return pe=function(){return t},t}function fe(){const t=qt(["\n\tbutton {\n\t\tcolor: ",";\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ",";\n\t\t}\n\t}\n"]);return fe=function(){return t},t}function he(){const t=qt(["\n\ttext-decoration: none;\n"]);return he=function(){return t},t}function xe(){const t=qt(["\n\t"," {\n\t\t","\n\t\twidth: 100%;\n\t\tmax-width: fit-content;\n\t}\n"]);return xe=function(){return t},t}function ge(){const t=qt(["\n\tmargin-top: -2px;\n\t"," {\n\t\t","\n\t\tmin-width: 40%;\n\t\tflex-grow: 1;\n\t}\n"]);return ge=function(){return t},t}function be(){const t=qt(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: ","px;\n"]);return be=function(){return t},t}function ye(){const t=qt(["\n\t\t\twidth: ","px;\n\t\t"]);return ye=function(){return t},t}function ve(){const t=qt(["\n\t\t\t\t\t\tcolor: red;\n\t\t\t\t\t"]);return ve=function(){return t},t}function je(){const t=qt(["\n\t\t\t\t\t\t\t\t\t\t\t\tmargin-right: ","px;\n\t\t\t\t\t\t\t\t\t\t\t"]);return je=function(){return t},t}function we(){const t=qt(["\n\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t"]);return we=function(){return t},t}function ke(){const t=qt(["\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"]);return ke=function(){return t},t}function Ce(){const t=qt(["\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t"]);return Ce=function(){return t},t}function Pe(){const t=qt(["\n\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t"]);return Pe=function(){return t},t}function Oe(){const t=qt(["\n\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t"]);return Oe=function(){return t},t}function Me(){const t=qt(["\n\t\t\t\t\t\t\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\t\t\t\t\t\t"]);return Me=function(){return t},t}const Se=(0,o.css)(Gt(),b.yui,c.x[2],(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text")),Ie=(0,o.css)(Vt()),Ee=(0,o.css)($t(),b.PSs,c.L[2],c.L[3],c.x[3],c.x[3],c.x[3],c.x[5],c.x[5],c.x[2],(0,g.M)("--discussion-subdued")),Te=(0,o.css)(Wt(),(0,g.M)("--discussion-subdued"),b.Ikj),ze=(0,o.css)(Jt(),(0,g.M)("--discussion-link"),(0,g.M)("--discussion-comment-underline")),Re=(0,o.css)(Xt(),(0,g.M)("--discussion-border"),c.x[2]),Fe=(0,o.css)(Zt(),(0,g.M)("--discussion-selected-background"),c.x[2],c.x[2],c.x[2],c.x[2]),Ue=(0,o.css)(Qt(),c.x[2],k.TG.mobileLandscape),De=(0,o.css)(te(),(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text")),Le=(0,o.css)(ee(),b.yui),Ne=(0,o.css)(ne(),b.PSs),Be=(0,o.css)(re(),(0,g.M)("--discussion-subdued")),Ae=(0,o.css)(oe()),Ye=(0,o.css)(se()),_e=(0,o.css)(ie()),He=(0,o.css)(ce(),c.x[2]),Ke=(0,o.css)(ae(),k.TG.mobileLandscape),qe=(0,o.css)(de(),k.HT.mobileLandscape),Ge=(0,o.css)(ue()),Ve=(0,o.css)(le()),$e=(0,o.css)(me(),k.TG.mobileLandscape),We=(0,o.css)(pe(),(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text")),Je=(0,o.css)(fe(),(0,g.M)("--discussion-subdued"),(0,g.M)("--discussion-subdued")),Xe=(0,o.css)(he()),Ze=(0,o.css)(xe(),k.TG.mobileLandscape,Ve),Qe=(0,o.css)(ge(),k.TG.mobileLandscape,Ve),tn=(0,o.css)(be(),c.x[1]),en=t=>{let{amount:e}=t;return(0,r.jsx)("div",{css:(0,o.css)(ye(),c.x[e])})},nn=t=>{let{comment:e,isClosedForComments:n,isClosedForRecommendations:s,setCommentBeingRepliedTo:i,user:a,isReply:u,wasScrolledTo:l,isMuted:m,toggleMuteStatus:p,onPermalinkClick:f,reportAbuse:h,isExpanded:x}=t;const[g,y]=(0,d.useState)(e.isHighlighted),[v,j]=(0,d.useState)(!1),[w,k]=(0,d.useState)(""),S=()=>{j(!v)},I=e.userProfile.badge.some((t=>"Staff"===t.name)),E="blocked"!==e.status&&g,T=e.userProfile.badge.some((t=>"Contributor"===t.name));return(0,r.jsxs)(r.Fragment,{children:[!!w&&(0,r.jsx)("span",{css:(0,o.css)(ve()),children:w}),(0,r.jsxs)("div",{id:"comment-".concat(e.id),"data-testid":e.id,css:[Re,l&&Fe],children:[(0,r.jsx)("div",{css:Ue,children:(0,r.jsx)(at,{imageUrl:e.userProfile.avatar,displayName:e.userProfile.displayName,size:u?"small":"medium"})}),(0,r.jsxs)("div",{css:Ae,children:[(0,r.jsxs)("header",{css:Ye,children:[(0,r.jsx)("div",{css:$e,children:(0,r.jsxs)(Ct,{children:[(0,r.jsx)("div",{css:[e.responseTo&&Ke,qe],children:(0,r.jsxs)(St,{children:[(0,r.jsx)("div",{css:(0,o.css)(je(),c.x[2]),children:(0,r.jsx)(at,{imageUrl:e.userProfile.avatar,displayName:"",size:"small"})}),(0,r.jsxs)("div",{css:tn,children:[(0,r.jsx)("div",{css:[De,Le,Ge],children:(0,r.jsx)(C.N,{href:e.userProfile.webUrl,cssOverrides:Xe,rel:"nofollow",children:e.userProfile.displayName})}),(0,r.jsx)(Kt,{isoDateTime:e.isoDateTime,webUrl:e.webUrl,commentId:e.id,onPermalinkClick:f})]})]})}),(0,r.jsxs)("div",{css:[!e.responseTo&&Ke],children:[(0,r.jsxs)(St,{children:[(0,r.jsx)("div",{css:[De,Le,Ze],children:(0,r.jsx)(C.N,{href:e.userProfile.webUrl,cssOverrides:Xe,rel:"nofollow",children:e.userProfile.displayName})}),e.responseTo?(0,r.jsx)("div",{css:[De,Ne,Be,Qe],children:(0,r.jsx)(C.N,{href:"#comment-".concat(e.responseTo.commentId),cssOverrides:Xe,icon:(0,r.jsx)(P.Z,{}),iconSide:"left",rel:"nofollow",children:e.responseTo.displayName})}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)("div",{css:[He,e.responseTo&&Ke],children:(0,r.jsx)(Kt,{isoDateTime:e.isoDateTime,webUrl:e.webUrl,commentId:e.id,onPermalinkClick:f})})]}),(0,r.jsxs)(St,{children:[I&&(0,r.jsx)("div",{css:_e,children:(0,r.jsx)(vt,{})}),T&&!I&&(0,r.jsx)("div",{css:_e,children:(0,r.jsx)(jt,{})}),E&&(0,r.jsx)("div",{css:_e,children:(0,r.jsx)(wt,{})})]})]})]})}),"blocked"!==e.status&&(0,r.jsx)(Dt,{commentId:e.id,initialCount:e.numRecommends,alreadyRecommended:!1,user:a,userMadeComment:(null==a?void 0:a.profile.userId)===e.userProfile.userId,isClosedForRecommendations:s})]}),(0,r.jsx)("div",{css:[e.responseTo&&Ke,qe],children:(0,r.jsxs)(St,{children:[I&&(0,r.jsx)("div",{css:_e,children:(0,r.jsx)(vt,{})}),T&&!I&&(0,r.jsx)("div",{css:_e,children:(0,r.jsx)(jt,{})}),E&&(0,r.jsx)("div",{css:_e,children:(0,r.jsx)(wt,{})})]})}),m&&(0,r.jsx)("p",{css:Te,children:(0,r.jsxs)(St,{children:[(0,r.jsx)(r.Fragment,{children:"All posts from this user have been muted on this device."}),(0,r.jsx)(en,{amount:1}),(0,r.jsx)("div",{css:[Je,(0,o.css)(we(),b.rDY)],children:(0,r.jsx)(O.$,{priority:"subdued",size:"xsmall",onClick:()=>p(e.userProfile.userId),"data-link-name":"unmute-user",children:"Unmute?"})})]})}),!m&&"blocked"===e.status&&(0,r.jsx)("p",{css:[Te,ze],dangerouslySetInnerHTML:{__html:e.body}}),!m&&"blocked"!==e.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{css:[Ee,ze],dangerouslySetInnerHTML:{__html:e.body}}),(0,r.jsxs)("div",{css:Ie,children:[(0,r.jsxs)(St,{children:[!n&&(0,r.jsxs)(r.Fragment,{children:[a?(0,r.jsx)("div",{css:[Be,We,(0,o.css)(ke(),b.yui)],children:(0,r.jsx)(O.$,{priority:"subdued",onClick:()=>i(e),icon:(0,r.jsx)(P.Z,{}),iconSide:"left","data-link-name":"reply to comment",children:"Reply"})}):(0,r.jsx)("div",{css:[Be,Se],children:(0,r.jsx)(C.N,{href:"https://profile.theguardian.com/signin?returnUrl=".concat(e.webUrl,"&").concat((0,M.h)("signin_to_reply_comment")),cssOverrides:Xe,icon:(0,r.jsx)(P.Z,{}),iconSide:"left",rel:"nofollow",children:(0,r.jsx)("span",{"data-link-name":"reply to comment",children:"Reply"})})}),(0,r.jsx)(en,{amount:4})]}),(0,r.jsx)(en,{amount:4}),"Staff"===(null==a?void 0:a.kind)&&a.profile.userId!==e.userProfile.userId&&(0,r.jsx)("div",{css:[We,(0,o.css)(Ce(),b.yui)],children:(0,r.jsx)(O.$,{priority:"subdued",onClick:g?()=>(async t=>{k("");const n=await t.onUnpick(e.id);"error"===n.kind?k(n.error):y(n.value)})(a):()=>(async t=>{k("");const n=await t.onPick(e.id);"error"===n.kind?k(n.error):y(n.value)})(a),"data-link-name":g?"unpick-comment":"pick-comment",children:g?"Unpick":"Pick"})})]}),(0,r.jsxs)(St,{children:[a&&e.userProfile.userId!==a.profile.userId?(0,r.jsx)("div",{css:[Je,(0,o.css)(Pe(),b.Ikj)],children:(0,r.jsx)(O.$,{priority:"subdued",size:"small",onClick:()=>p(e.userProfile.userId),"data-link-name":"mute-user",children:"Mute"})}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(en,{amount:4}),x&&(0,r.jsx)("div",{css:[Je,(0,o.css)(Oe(),b.Ikj)],children:(0,r.jsx)(O.$,{priority:"subdued",size:"small",onClick:S,"data-link-name":"Open report abuse",children:"Report"})}),v&&(0,r.jsx)("div",{css:(0,o.css)(Me()),children:(0,r.jsx)(st,{toggleSetShowForm:S,commentId:e.id,reportAbuse:h})})]})]})]})]})]})]})};var rn=n(8571);function on(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function sn(){const t=on(["\n\t\t\t\tbutton {\n\t\t\t\t\t","\n\t\t\t\t\tbackground-color: ",";\n\t\t\t\t\tcolor: ",";\n\n\t\t\t\t\t:hover {\n\t\t\t\t\t\tbackground-color: ",";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t"]);return sn=function(){return t},t}function cn(){const t=on(["\n\t\t\t\tbutton {\n\t\t\t\t\t","\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tborder: 1px solid\n\t\t\t\t\t\t",";\n\t\t\t\t\tcolor: ",";\n\n\t\t\t\t\t:hover {\n\t\t\t\t\t\tbackground-color: ",";\n\t\t\t\t\t\tborder: 1px solid\n\t\t\t\t\t\t\t",";\n\t\t\t\t\t\tcolor: ",";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t"]);return cn=function(){return t},t}function an(){const t=on(["\n\t\t\t\tbutton {\n\t\t\t\t\t","\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tcolor: ",";\n\t\t\t\t\tborder-radius: 0;\n\t\t\t\t}\n\t\t\t"]);return an=function(){return t},t}const dn=t=>{switch(t){case"primary":return(0,o.css)(sn(),b.yui,(0,g.M)("--discussion-primary-button-background"),(0,g.M)("--discussion-button-text"),(0,g.M)("--discussion-button-background-hover"));case"secondary":return(0,o.css)(cn(),b.yui,(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-button-background-hover"),(0,g.M)("--discussion-button-background-hover"),(0,g.M)("--discussion-button-text"));case"subdued":return(0,o.css)(an(),b.yui,(0,g.M)("--discussion-accent-text"))}},un=t=>{let{onClick:e,type:n,priority:o="primary",children:s,icon:i,iconSide:c,linkName:a,size:d="default"}=t;return(0,r.jsx)("div",{css:dn(o),children:(0,r.jsx)(O.$,{priority:o,size:d,onClick:e,type:n,icon:i,iconSide:c,"data-link-name":a,children:s})})};function ln(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function mn(){const t=ln(["\n\t","\n\tpadding: ","px ","px;\n\tbackground-color: ",";\n\tborder-radius: 5px;\n\tmargin-top: 0;\n\tmargin-bottom: ","px;\n\tword-break: break-word;\n\n\tblockquote {\n\t\tmargin-top: ","px;\n\t\tmargin-bottom: ","px;\n\t\tmargin-left: ","px;\n\t\tmargin-right: ","px;\n\t\tpadding-left: ","px;\n\t\tcolor: ",";\n\t}\n\n\ti {\n\t\tfont-style: italic;\n\t}\n\n\tb {\n\t\tfont-weight: bold;\n\t}\n\n\tcode {\n\t\t/* stylelint-disable-next-line property-disallowed-list -- Source doesn't have a monospace font */\n\t\tfont-family: monospace;\n\t\tfont-size: 1em;\n\t}\n\n\t/*\n\t\ttodo: this spacing is currently repeated here, on regular comments, and\n\t\ton TopPick comments; can we factor out the common styling for these\n\t\tthree components?\n\t*/\n\tp {\n\t\tmargin-top: 0;\n\t\tmargin-bottom: ","px;\n\t}\n"]);return mn=function(){return t},t}function pn(){const t=ln(["\n\tdisplay: block;\n\tleft: 0;\n\twidth: 0;\n\theight: 0;\n\tborder-right: 1rem solid transparent;\n\tborder-bottom: 1rem solid\n\t\t",";\n\tmargin-left: 12.5rem;\n\tborder-right-style: inset;\n"]);return pn=function(){return t},t}const fn=(0,o.css)(mn(),b.PSs,c.x[2],c.x[4],(0,g.M)("--discussion-preview-background"),20,c.x[3],c.x[3],c.x[5],c.x[5],c.x[2],(0,g.M)("--discussion-subdued"),c.x[3]),hn=(0,o.css)(pn(),(0,g.M)("--discussion-preview-background")),xn=t=>{let{previewHtml:e,showSpout:n}=t;return(0,r.jsxs)(r.Fragment,{children:[n&&(0,r.jsx)("div",{css:hn}),(0,r.jsx)("div",{css:fn,dangerouslySetInnerHTML:{__html:e||""}})]})};function gn(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function bn(){const t=gn(["\n\t",";\n"]);return bn=function(){return t},t}function yn(){const t=gn(["\n\tcolor: ",";\n"]);return yn=function(){return t},t}function vn(){const t=gn(["\n\t> label {\n\t\t> * {\n\t\t\tcolor: inherit;\n\t\t}\n\t}\n"]);return vn=function(){return t},t}function jn(){const t=gn(["\n\tbackground-color: transparent;\n\tcolor: inherit;\n"]);return jn=function(){return t},t}function wn(){const t=gn(["\n\t",";\n"]);return wn=function(){return t},t}function kn(){const t=gn(["\n\t\t\t\t\tpadding: ","px;\n\t\t\t\t"]);return kn=function(){return t},t}function Cn(){const t=gn(["\n\t\t\t\tpadding: ","px;\n\t\t\t"]);return Cn=function(){return t},t}function Pn(){const t=gn(["\n\t\t\t\t\t\t\twidth: ","px;\n\t\t\t\t\t\t"]);return Pn=function(){return t},t}const On=(0,o.css)(bn(),b.PSs),Mn=(0,o.css)(yn(),(0,g.M)("--discussion-link")),Sn=t=>{let{children:e}=t;return(0,r.jsx)("p",{css:On,children:e})},In=(0,o.css)(vn()),En=(0,o.css)(jn()),Tn=(0,o.css)(wn(),b.aal),zn=t=>{let{error:e="",submitForm:n,cancelSubmit:s,previewBody:i}=t;const{renderingTarget:a}=(0,y.U)(),[u,l]=(0,d.useState)("");return"Apps"===a?(0,r.jsxs)("div",{css:(0,o.css)(kn(),c.x[2]),children:[(0,r.jsx)("h3",{css:Tn,children:"Welcome, you’re about to make your first comment!"}),(0,r.jsx)(Sn,{children:"Before you can post, you need to choose a username. Please do this in your profile settings."})]}):(0,r.jsx)("div",{css:(0,o.css)(Cn(),c.x[2]),children:(0,r.jsxs)("form",{onSubmit:t=>{t.preventDefault(),n(u)},children:[(0,r.jsx)("h3",{css:Tn,children:"Welcome, you’re about to make your first comment!"}),(0,r.jsx)(Sn,{children:"Before you post, we’d like to thank you for joining the debate - we’re glad you’ve chosen to participate and we value your opinions and experiences."}),(0,r.jsx)(Sn,{children:"Please choose your username under which you would like all your comments to show up. You can only set your username once."}),(0,r.jsx)("div",{css:In,children:(0,r.jsx)(z.k,{label:"Username:",supporting:"Must be 6-20 characters, letters and/or numbers only, no spaces.",value:u,onChange:t=>l(t.target.value),width:30,error:e,cssOverrides:En})}),(0,r.jsx)(Sn,{children:(0,r.jsxs)(r.Fragment,{children:["Please keep your posts respectful and abide by the"," ",(0,r.jsx)(C.N,{href:"/community-standards",priority:"primary",subdued:!0,rel:"nofollow",cssOverrides:Mn,children:(0,r.jsx)("span",{css:On,children:"community guidelines"})})," -"," and if you spot a comment you think doesn’t adhere to the guidelines, please use the ‘Report’ link next to it to let us know."]})}),(0,r.jsx)(Sn,{children:"Please preview your comment below and click ‘post’ when you’re happy with it."}),(0,r.jsx)(xn,{previewHtml:i,showSpout:!1}),(0,r.jsxs)(St,{children:[(0,r.jsx)(un,{onClick:()=>{n(u)},linkName:"post comment",size:"small",children:"Post your comment"}),(0,r.jsx)("div",{css:(0,o.css)(Pn(),c.x[3])}),(0,r.jsx)(un,{priority:"subdued",onClick:s,linkName:"cancel-post-comment",size:"small",children:"Cancel"})]})]})})};function Rn(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Fn(){const t=Rn(["\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tmargin-bottom: ","px;\n"]);return Fn=function(){return t},t}function Un(){const t=Rn(["\n\twidth: 100%;\n\tmargin-bottom: ","px;\n\tpadding: 8px 10px 10px 8px;\n\t",";\n\tborder-color: ",";\n\t:focus {\n\t\tborder-color: ",";\n\t\toutline: none;\n\t}\n\tcolor: inherit;\n\tbackground-color: ",";\n"]);return Un=function(){return t},t}function Dn(){const t=Rn(["\n\t::placeholder {\n\t\tcolor: ",";\n\t}\n"]);return Dn=function(){return t},t}function Ln(){const t=Rn(["\n\t::placeholder {\n\t\tfont-weight: bold;\n\t\topacity: 1;\n\t\tcolor: inherit;\n\t}\n"]);return Ln=function(){return t},t}function Nn(){const t=Rn(["\n\tmargin: 0 0 10px 0;\n\t",";\n"]);return Nn=function(){return t},t}function Bn(){const t=Rn(["\n\ta {\n\t\tcolor: ",";\n\t\ttext-decoration: none;\n\t\t:hover,\n\t\t:focus {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n"]);return Bn=function(){return t},t}function An(){const t=Rn(["\n\tbackground-color: ",";\n\tpadding: 8px 10px 10px 8px;\n\twidth: 100%;\n\tmargin-top: 8px;\n\tmargin-bottom: 2px;\n"]);return An=function(){return t},t}function Yn(){const t=Rn(["\n\theight: 22px;\n\tfont-size: 13px;\n\tline-height: 17px;\n\tborder: 1px solid ",";\n\tbackground-color: ",";\n\tcolor: inherit;\n\ttext-align: center;\n\tcursor: pointer;\n\tmargin-left: 4px;\n\tpadding: 2px 5px 0px 5px;\n\tmin-width: 11px;\n\tlist-style-type: none;\n"]);return Yn=function(){return t},t}function _n(){const t=Rn(["\n\t& div {\n\t\tcolor: inherit;\n\t\t",";\n\t\tsvg {\n\t\t\tfill: ",";\n\t\t}\n\t}\n"]);return _n=function(){return t},t}function Hn(){const t=Rn(["\n\tcolor: ",";\n\t",";\n"]);return Hn=function(){return t},t}function Kn(){const t=Rn(["\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex-wrap: wrap;\n\tjustify-content: space-between;\n\talign-items: stretch;\n\talign-content: space-between;\n\tgap: ","px;\n\t"," {\n\t\tflex-direction: column-reverse;\n\t}\n"]);return Kn=function(){return t},t}function qn(){const t=Rn(["\n\t\t\twidth: ","px;\n\t\t"]);return qn=function(){return t},t}const Gn=t=>"<b>".concat(t,"</b>"),Vn=t=>"<i>".concat(t,"</i>"),$n=t=>"<del>".concat(t,"</del>"),Wn=t=>"<code>".concat(t,"</code>"),Jn=t=>"<blockquote>".concat(t,"</blockquote>"),Xn=(0,o.css)(Fn(),c.x[5]),Zn=(0,o.css)(Un(),c.x[3],b.PSs,(0,g.M)("--discussion-border"),(0,g.M)("--discussion-subdued"),(0,g.M)("--comment-form-input-background")),Qn=(0,o.css)(Dn(),(0,g.M)("--discussion-subdued")),tr=(0,o.css)(Ln()),er=(0,o.css)(Nn(),b.Ikj),nr=(0,o.css)(Bn(),(0,g.M)("--discussion-link")),rr=(0,o.css)(An(),(0,g.M)("--comment-form-header-background")),or=(0,o.css)(Yn(),(0,g.M)("--discussion-background"),(0,g.M)("--discussion-background")),sr=(0,o.css)(_n(),b.rDY,(0,g.M)("--discussion-pre-mod")),ir=(0,o.css)(Hn(),(0,g.M)("--discussion-pre-mod"),b.rDY),cr=(0,o.css)(Kn(),c.x[3],k.TG.wide),ar=t=>{let{amount:e}=t;return(0,r.jsx)("div",{css:(0,o.css)(qn(),c.x[e])})},dr=t=>{let{shortUrl:e,onAddComment:n,user:s,setCommentBeingRepliedTo:i,commentBeingRepliedTo:c,onPreview:a,error:u,setError:m,userNameMissing:p,setUserNameMissing:f,previewBody:h,setPreviewBody:x}=t;var g;const[b,y]=(0,d.useState)(!1),[v,j]=(0,d.useState)(!1),[w,k]=(0,d.useState)(0),[P,O]=(0,d.useState)(0),[M,S]=(0,d.useState)(""),I=t=>{S(t)};(0,d.useEffect)((()=>{var t,e;c&&(null===(t=document.getElementById("comment-".concat(c.id)))||void 0===t||t.scrollIntoView(),null===(e=document.querySelector("#comment-reply-form-".concat(c.id," textarea")))||void 0===e||e.focus())}),[c]);const E=()=>{const t=M;return{startString:t.substring(0,w),highlightedString:t.substring(w,P),endString:t.substring(P,t.length)}},z=t=>{const e=E();if(!e)return;const{startString:n,highlightedString:r,endString:o}=e;I(n.concat(t(r),o))},R=()=>{m(""),I(""),x(""),y(!1),null==i||i()},F=async()=>{if(v)return;j(!0),m("");const t=M;if(t){const r=c?await s.onReply(e,t,c.id):await s.onComment(e,t);"error"===r.kind?(t=>{switch(t){case"USERNAME_MISSING":return f(!0);case"EMPTY_COMMENT_BODY":return m("Please write a comment.");case"COMMENT_TOO_LONG":return m("Your comment must be fewer than 5000 characters long.");case"USER_BANNED":return m('Commenting has been disabled for this account (<a href="/community-faqs#321a">why?</a>).');case"IP_THROTTLED":return m('Commenting has been temporarily blocked for this IP address (<a href="/community-faqs">why?</a>).');case"DISCUSSION_CLOSED":return m("Sorry your comment can not be published as the discussion is now closed for comments.");case"PARENT_COMMENT_MODERATED":return m("Sorry the comment can not be published as the comment you replied to has been moderated since.");case"COMMENT_RATE_LIMIT_EXCEEDED":return m("You can only post one comment every minute. Please try again in a moment.");case"INVALID_PROTOCOL":return m("Sorry your comment can not be published as it was not sent over\n\t\t\t\t\ta secure channel. Please report us this issue using the technical issue link\n\t\t\t\t\tin the page footer.");case"AUTH_COOKIE_INVALID":return m("Sorry, your comment was not published as you are no longer signed in. Please sign in and try again.");case"READ-ONLY-MODE":return m("Sorry your comment can not currently be published as\n\t\t\t\t\tcommenting is undergoing maintenance but will be back shortly. Please try\n\t\t\t\t\tagain in a moment.");case"API_CORS_BLOCKED":return m("Could not post due to your internet settings, which might be\n\t\t\t\t   controlled by your provider. Please contact your administrator\n\t\t\t\t   or disable any proxy servers or VPNs and try again.");case"API_ERROR":return m("Sorry, there was a problem posting your comment. Please try\n\t\t\t\t\tanother browser or network connection.  Reference code ");case"EMAIL_NOT_VALIDATED":return m('Please confirm your email address to comment.<br />\n\t\t\t\t\tIf you can\'t find the email, we can\n\t\t\t\t\t<a href="#">\n\t\t\t\t\t<strong>resend the verification email</strong></a> to your email\n\t\t\t\t\taddress.');default:m("Sorry, there was a problem posting your comment.")}})(r.error):(n(c?((t,e,n,r)=>({id:t,body:e,date:Date(),isoDateTime:(new Date).toISOString(),status:"visible",webUrl:"https://discussion.theguardian.com/comment-permalink/".concat(t),apiUrl:"https://discussion.guardianapis.com/discussion-api/comment/".concat(t),numRecommends:0,isHighlighted:!1,userProfile:n,responseTo:{displayName:r.userProfile.displayName,commentApiUrl:"https://discussion.guardianapis.com/discussion-api/comment/".concat(r.id),isoDateTime:r.isoDateTime,date:r.date,commentId:String(r.id),commentWebUrl:"https://discussion.theguardian.com/comment-permalink/".concat(r.id)}}))(r.value,t,s.profile,c):((t,e,n)=>({id:t,body:e,date:Date(),isoDateTime:(new Date).toISOString(),status:"visible",webUrl:"https://discussion.theguardian.com/comment-permalink/".concat(t),apiUrl:"https://discussion.guardianapis.com/discussion-api/comment/".concat(t),numRecommends:0,isHighlighted:!1,userProfile:n,responses:[]}))(r.value,t,s.profile)),R())}j(!1)};return b&&p?(0,r.jsx)(zn,{error:u,submitForm:async t=>{if(m(""),!t)return void m("Username field cannot be empty");const e=await s.addUsername(t);"ok"===e.kind?(F(),f(!1)):m(e.error)},cancelSubmit:()=>f(!1),previewBody:h}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{css:Xn,onSubmit:t=>{t.preventDefault(),F()},children:[b&&(0,r.jsxs)("div",{css:rr,children:[(0,r.jsxs)("p",{css:[er,nr],children:["Please keep comments respectful and abide by the"," ",(0,r.jsx)("a",{href:"/community-standards",children:"community guidelines"}),"."]}),(null===(g=s.profile.privateFields)||void 0===g?void 0:g.isPremoderated)&&(0,r.jsx)(rn.P,{message:"Your comments are currently being pre-moderated",context:(0,r.jsx)(C.N,{href:"/community-faqs#311",target:"_blank",rel:"nofollow",cssOverrides:ir,children:"(why?)"}),cssOverrides:sr})]}),(0,r.jsx)(T.f,{"data-testid":"comment-input",placeholder:c||!b?"Join the discussion":"",cssOverrides:(0,o.css)([Zn,c&&b&&Qn,!c&&!b&&tr]),style:{height:b?"132px":"50px"},onFocus:()=>y(!0),value:M,onChange:t=>{S(t.target.value)},onSelect:t=>{k(t.target.selectionStart),O(t.target.selectionEnd)},label:"",error:u}),(0,r.jsxs)("div",{css:cr,children:[(0,r.jsx)(St,{wrap:!0,children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(un,{type:"submit",linkName:"post comment",size:"small",children:"Post your comment"}),b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ar,{amount:3}),(0,r.jsx)(un,{onClick:async()=>{const t=M;if(!t)return;const e=null!=a?a:l.VH,n=await e(t);if("error"===n.kind)return m("Preview request failed, please try again"),void x("");x(n.value)},priority:"secondary",linkName:"preview-comment",size:"small",children:"Preview"}),(0,r.jsx)(ar,{amount:3}),(0,r.jsx)(un,{onClick:R,priority:"subdued",linkName:"cancel-post-comment",size:"small",children:"Cancel"})]})]})}),b&&(0,r.jsxs)(St,{wrap:!0,children:[(0,r.jsx)("button",{onClick:t=>{t.preventDefault(),z(Gn)},css:or,style:{fontWeight:"bold"},"data-link-name":"formatting-controls-bold",type:"button",title:"Bold",children:"bold"}),(0,r.jsx)("button",{onClick:t=>{t.preventDefault(),z(Vn)},css:or,style:{fontStyle:"italic"},"data-link-name":"formatting-controls-italic",type:"button",title:"Italic",children:"italic"}),(0,r.jsx)("button",{onClick:t=>{t.preventDefault(),z($n)},css:or,style:{textDecoration:"line-through"},"data-link-name":"formatting-controls-strikethrough",type:"button",title:"Strikethrough",children:"strikethrough"}),(0,r.jsx)("button",{onClick:t=>{t.preventDefault(),z(Wn)},css:or,style:{fontFamily:"monospace"},"data-link-name":"formatting-controls-code",type:"button",title:"Code",children:"<code>"}),(0,r.jsx)("button",{onClick:t=>{t.preventDefault(),z(Jn)},css:or,"data-link-name":"formatting-controls-quote",type:"button",title:"Quote",children:'"quote"'}),(0,r.jsx)("button",{onClick:t=>{t.preventDefault(),(()=>{const t=prompt("Your URL:","http://www.");if(null===t)return;const e=E();if(!e)return;const{startString:n,highlightedString:r,endString:o}=e;I(n.concat(((t,e)=>'<a href="'.concat(t,'" rel="nofollow">').concat(e||t,"</a>"))(t,r),o))})()},css:or,style:{textDecoration:"underline"},"data-link-name":"formatting-controls-link",type:"button",title:"Link",children:"Link"})]})]})]}),""!==h.trim()&&(0,r.jsx)(xn,{previewHtml:h,showSpout:!0})]})};function ur(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function lr(){const t=ur(["\n\t\t\twidth: ","px;\n\t\t"]);return lr=function(){return t},t}function mr(){const t=ur(["\n\twidth: 18px;\n\tsvg {\n\t\t/* stylelint-disable-next-line declaration-no-important */\n\t\tfill: "," !important;\n\t}\n"]);return mr=function(){return t},t}function pr(){const t=ur(["\n\t",";\n\tline-height: 19px;\n"]);return pr=function(){return t},t}function fr(){const t=ur(["\n\t",";\n\tmargin-top: 0px;\n\tmargin-bottom: ","px;\n"]);return fr=function(){return t},t}function hr(){const t=ur(["\n\tpadding-top: ","px;\n\tpadding-bottom: ","px;\n\tpadding-left: ","px;\n\tpadding-right: ","px;\n\tbackground-color: ",";\n\tmargin-top: ","px;\n\tmargin-bottom: ","px;\n\tposition: relative;\n\tdisplay: flex;\n\tflex-direction: column;\n\t:before {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tborder-left: ","px solid\n\t\t\t",";\n\t\tborder-top: ","px solid transparent;\n\t\ttop: -","px;\n\t\tmargin-left: ","px;\n\t}\n"]);return hr=function(){return t},t}function xr(){const t=ur(["\n\tp {\n\t\t",";\n\t\tmargin-top: 0px;\n\t\tmargin-bottom: ","px;\n\t}\n"]);return xr=function(){return t},t}function gr(){const t=ur(["\n\tcolor: ",";\n"]);return gr=function(){return t},t}function br(){const t=ur(["\n\tbutton {\n\t\tcolor: ",";\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ",";\n\t\t}\n\t}\n"]);return br=function(){return t},t}function yr(){const t=ur(["\n\tbutton {\n\t\tcolor: ",";\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ",";\n\t\t}\n\t}\n"]);return yr=function(){return t},t}function vr(){const t=ur(["\n\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t"]);return vr=function(){return t},t}function jr(){const t=ur(["\n\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t}\n\t\t\t\t\t"]);return jr=function(){return t},t}const wr=t=>{let{amount:e}=t;return(0,r.jsx)("div",{css:(0,o.css)(lr(),c.x[e])})},kr=(0,o.css)(mr(),(0,g.M)("--discussion-subdued")),Cr=(0,o.css)(pr(),b.PSs),Pr=(0,o.css)(fr(),b.yui,c.x[2]),Or=(0,o.css)(hr(),c.x[3],c.x[3],c.x[5],c.x[5],(0,g.M)("--discussion-top-pick-background"),15,20,15,(0,g.M)("--discussion-top-pick-background"),15,14,c.x[9]),Mr=(0,o.css)(xr(),b.PSs,c.x[3]),Sr=(0,o.css)(gr(),(0,g.M)("--discussion-link")),Ir=(0,o.css)(br(),(0,g.M)("--discussion-accent-text"),(0,g.M)("--discussion-accent-text")),Er=(0,o.css)(yr(),(0,g.M)("--discussion-subdued"),(0,g.M)("--discussion-subdued")),Tr=t=>{let{commentBeingRepliedTo:e}=t;const[n,s]=(0,d.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(St,{children:[(0,r.jsx)("div",{css:kr,children:(0,r.jsx)(P.Z,{})}),(0,r.jsx)(wr,{amount:1}),(0,r.jsx)("div",{css:Cr,children:e.userProfile.displayName}),(0,r.jsx)(wr,{amount:3}),(0,r.jsx)("div",{css:[Ir,(0,o.css)(vr(),b.yui)],children:(0,r.jsx)(O.$,{priority:"subdued",onClick:()=>s(!n),"data-link-name":n?"reply-comment-hide":"reply-comment-show",children:n?"Hide Comment":"Show comment"})})]}),n&&(0,r.jsx)(zr,{commentBeingRepliedTo:e,setDisplayReplyComment:s,displayReplyComment:n})]})},zr=t=>{let{commentBeingRepliedTo:e,setDisplayReplyComment:n,displayReplyComment:s}=t;return(0,r.jsxs)("div",{css:Or,children:[(0,r.jsxs)("p",{css:Pr,children:[e.userProfile.displayName," @"," ",e.date," said:"]}),(0,r.jsx)("div",{css:Mr,dangerouslySetInnerHTML:{__html:e.body||""}}),(0,r.jsx)("div",{css:[Er,(0,o.css)(jr(),b.PSs)],children:(0,r.jsx)(O.$,{priority:"subdued",onClick:()=>n(!s),"data-link-name":"hide-comment",children:(0,r.jsx)("span",{css:Sr,children:"Hide Comment"})})})]})};function Rr(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Fr(){const t=Rr(["\n\tlist-style-type: none;\n\tpadding-left: ","px;\n\tmargin-left: ","px;\n"]);return Fr=function(){return t},t}function Ur(){const t=Rr(["\n\tborder-top: 1px solid ",";\n"]);return Ur=function(){return t},t}function Dr(){const t=Rr(["\n\tlist-style-type: none;\n\tpadding-left: 0;\n"]);return Dr=function(){return t},t}function Lr(){const t=Rr(["\n\tbackground-color: ",";\n\tmargin-left: -","px;\n\tpadding-left: ","px;\n\tmargin-right: -","px;\n\tpadding-right: ","px;\n"]);return Lr=function(){return t},t}function Nr(){const t=Rr(["\n\tmargin: 0px;\n"]);return Nr=function(){return t},t}function Br(){const t=Rr(["\n\t\t\t\t\t\t\t\t\t\tpadding-top: ","px;\n\t\t\t\t\t\t\t\t\t\tpadding-bottom: ","px;\n\t\t\t\t\t\t\t\t\t"]);return Br=function(){return t},t}const Ar=(0,o.css)(Fr(),c.x[2],c.x[12]),Yr=(0,o.css)(Ur(),(0,g.M)("--discussion-border")),_r=(0,o.css)(Dr()),Hr=(0,o.css)(Lr(),(0,g.M)("--discussion-selected-background"),c.x[2],c.x[2],c.x[2],c.x[2]),Kr=(0,o.css)(Nr()),qr=t=>{let{comment:e,isClosedForComments:n,isClosedForRecommendations:s,user:i,shortUrl:u,threads:m,commentBeingRepliedTo:p,setCommentBeingRepliedTo:f,commentToScrollTo:h,mutes:x,toggleMuteStatus:g,onPermalinkClick:b,onPreview:y,error:v,setError:j,userNameMissing:w,setUserNameMissing:k,previewBody:C,setPreviewBody:P,reportAbuse:O,expandCommentReplies:M,isExpanded:S}=t;var I;const E=e.responses?e.responses:[];var T;const z=null!==(T=null===(I=e.metaData)||void 0===I?void 0:I.responseCount)&&void 0!==T?T:0,R=E.length>=z,[F,U]=(0,d.useState)(!1),D="unthreaded"!==m&&E.length>0;return(0,r.jsxs)("div",{css:[h===e.id&&Hr],children:[(0,r.jsx)(nn,{comment:e,isClosedForComments:n,isClosedForRecommendations:s,setCommentBeingRepliedTo:f,user:i,isReply:!1,isMuted:x.includes(e.userProfile.userId),toggleMuteStatus:g,onPermalinkClick:b,reportAbuse:O,isExpanded:S}),(0,r.jsxs)(r.Fragment,{children:[D&&E.length>0&&(0,r.jsxs)("div",{css:Ar,children:[(0,r.jsx)("ul",{css:[_r,Kr],children:E.map((t=>(0,r.jsx)("li",{children:(0,r.jsx)(nn,{comment:t,isClosedForComments:n,isClosedForRecommendations:s,setCommentBeingRepliedTo:f,user:i,isReply:!0,wasScrolledTo:h===t.id,isMuted:x.includes(t.userProfile.userId),toggleMuteStatus:g,onPermalinkClick:b,reportAbuse:O,isExpanded:S})},t.id)))}),!R&&(0,r.jsx)("div",{css:[Yr,(0,o.css)(Br(),c.x[3],c.x[3])],children:(0,r.jsx)(un,{priority:"secondary",icon:(0,r.jsx)(a.D,{}),iconSide:"left",linkName:"Show more replies",onClick:()=>{return t=e.id,U(!0),void(0,l.EE)(t).then((e=>{"error"!==e.kind?M(t,e.value):console.error(e.error)})).catch((()=>{})).finally((()=>{U(!1)}));var t},size:"xsmall",children:F?"loading...":(()=>{const t=z-E.length;return 1===t?"Show 1 more reply":"Show ".concat(t," more replies")})()})})]}),p&&(p.id===e.id||E.find((t=>t.id===p.id)))&&i&&(0,r.jsxs)("div",{id:"comment-reply-form-".concat(p.id),css:Ar,children:[(0,r.jsx)(Tr,{commentBeingRepliedTo:p}),(0,r.jsx)(dr,{shortUrl:u,onAddComment:t=>{"responses"in t||((t,e)=>{M(t,[...E,e])})(e.id,t)},user:i,setCommentBeingRepliedTo:f,commentBeingRepliedTo:p,onPreview:y,error:v,setError:j,userNameMissing:w,setUserNameMissing:k,previewBody:C,setPreviewBody:P})]})]})]})};function Gr(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Vr(){const t=Gr(["\n\tposition: relative;\n"]);return Vr=function(){return t},t}function $r(){const t=Gr(["\n\tz-index: 2;\n\tlist-style: none;\n\tborder: 1px solid ",";\n\tmargin-left: -8px;\n\tpadding: 0px;\n\tdisplay: none;\n\tbackground-color: ",";\n\n\tposition: absolute;\n\n\t"," {\n\t\tmargin-top: 4px;\n\t\tborder-radius: 0;\n\t\toverflow: auto;\n\t}\n\n\t"," {\n\t\tmargin-top: 12px;\n\t\tborder-radius: 3px;\n\t}\n"]);return $r=function(){return t},t}function Wr(){const t=Gr(["\n\tdisplay: block;\n"]);return Wr=function(){return t},t}function Jr(){const t=Gr(["\n\t",";\n\ttext-align: left;\n\tcolor: ",";\n\tposition: relative;\n\ttext-decoration: none;\n\tmargin-top: 1px;\n\tpadding-top: 8px;\n\tpadding-right: 30px;\n\tpadding-bottom: 8px;\n\tpadding-left: 8px;\n\twidth: 100%;\n\tcursor: ",";\n\tbackground-color: white;\n\tborder: none;\n\n\t","\n"]);return Jr=function(){return t},t}function Xr(){const t=Gr(["\n\tmargin-top: 0;\n"]);return Xr=function(){return t},t}function Zr(){const t=Gr(["\n\tfont-weight: bold;\n\n\t:after {\n\t\tcontent: '';\n\t\tborder: 2px solid ",";\n\t\tborder-top: 0px;\n\t\tborder-right: 0px;\n\t\tposition: absolute;\n\t\ttop: 12px;\n\t\tright: 12px;\n\t\twidth: 8px;\n\t\theight: 4px;\n\t\ttransform: rotate(-45deg);\n\t}\n"]);return Zr=function(){return t},t}function Qr(){const t=Gr(["\n\t",";\n\t/**\n\t * Typography preset styles should not be overridden.\n\t * This has been done because the styles do not directly map to the new presets.\n\t * Please speak to your team's designer and update this to use a more appropriate preset.\n\t */\n\tfont-weight: 500;\n\tdisplay: block;\n\tcursor: pointer;\n\tbackground: none;\n\tborder: none;\n\t/* Design System: The buttons should be components that handle their own layout using primitives  */\n\tline-height: 1.2;\n\tcolor: ",";\n\ttransition: color 80ms ease-out;\n\tpadding: 0px 10px 6px 0px;\n\tmargin: 1px 0 0;\n\ttext-decoration: none;\n\n\t:hover {\n\t\t:after {\n\t\t\ttransform: translateY(0) rotate(45deg);\n\t\t}\n\t}\n\n\t:after {\n\t\tcontent: '';\n\t\tdisplay: inline-block;\n\t\twidth: 5px;\n\t\theight: 5px;\n\t\ttransform: translateY(-2px) rotate(45deg);\n\t\tborder: 1px solid currentColor;\n\t\tborder-left: transparent;\n\t\tborder-top: transparent;\n\t\tmargin-left: 5px;\n\t\tvertical-align: middle;\n\t\ttransition: transform 250ms ease-out;\n\t}\n"]);return Qr=function(){return t},t}function to(){const t=Gr(["\n\t:hover:after {\n\t\ttransform: translateY(-1px) rotate(-135deg);\n\t}\n\t:after {\n\t\ttransform: translateY(1px) rotate(-135deg);\n\t}\n"]);return to=function(){return t},t}function eo(){const t=Gr(["\n\t",";\n\tcolor: ",";\n"]);return eo=function(){return t},t}const no=(0,o.css)(Vr()),ro=(0,o.css)($r(),(0,g.M)("--discussion-border"),(0,g.M)("--discussion-background"),k.TG.tablet,k.HT.tablet),oo=(0,o.css)(Wr()),so=(0,o.css)(Xr()),io=(0,o.css)(Zr(),(0,g.M)("--discussion-accent-text")),co=(0,o.css)(Qr(),b.PSs,(0,g.M)("--discussion-subdued")),ao=(0,o.css)(to()),uo=(0,o.css)(eo(),b.yui,(0,g.M)("--discussion-subdued")),lo=t=>{let{id:e,label:n,options:s,onSelect:i}=t;const[c,a]=(0,d.useState)(!1);(0,d.useEffect)((()=>{const t=t=>{c&&"Escape"===t.code&&a(!1)};return document.addEventListener("keydown",t,!1),()=>document.removeEventListener("keydown",t)}),[c]),(0,d.useEffect)((()=>{const t=t=>{c&&(t.stopPropagation(),a(!1))};return document.addEventListener("click",t,!1),()=>document.removeEventListener("click",t)}),[c]);const u="dropbox-id-".concat(e),l=s.find((t=>t.isActive));return(0,r.jsxs)("div",{css:no,children:[(0,r.jsxs)("div",{css:uo,children:[n,(0,r.jsx)("button",{onClick:()=>a(!c),css:[co,c&&ao],"aria-controls":u,"aria-expanded":c?"true":"false",type:"button",children:l?l.title:"Please select"})]}),(0,r.jsx)("ul",{id:u,css:[ro,c&&oo],children:s.map(((t,e)=>{return(0,r.jsx)("li",{children:(0,r.jsx)("button",{onClick:()=>i(t.value),css:[(n=!!t.disabled,(0,o.css)(Jr(),b.PSs,n?(0,g.M)("--discussion-text"):(0,g.M)("--discussion-subdued"),n?"default":"pointer",!n&&"\n    :hover {\n      background-color: ".concat((0,g.M)("--discussion-background"),";\n      text-decoration: underline;\n    }\n\n    :focus {\n      text-decoration: underline;\n    }\n  "))),t.isActive&&io,0===e&&so],disabled:!!t.isActive||!!t.disabled,type:"button",children:t.title})},t.title);var n}))})]})};function mo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function po(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){mo(t,e,n[e])}))}return t}function fo(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function ho(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function xo(){const t=ho(["\n\tpadding-top: ","px;\n\tpadding-bottom: ","px;\n\n\tborder-top: 1px solid ",";\n\n\tdisplay: flex;\n\tflex-direction: row;\n"]);return xo=function(){return t},t}function go(){const t=ho(["\n\tposition: relative;\n\tmargin-left: ","px;\n\t:after {\n\t\tcontent: '';\n\t\tdisplay: block;\n\t\twidth: 1px;\n\t\tbackground-color: ",";\n\t\tposition: absolute;\n\t\ttop: -","px;\n\t\tbottom: ","px;\n\t\tleft: -","px;\n\t}\n"]);return go=function(){return t},t}function bo(){const t=ho(["\n\tpadding-right: ","px;\n"]);return bo=function(){return t},t}const yo=(0,o.css)(xo(),c.x[1],c.x[2],(0,g.M)("--discussion-border")),vo=(0,o.css)(go(),c.x[2],(0,g.M)("--discussion-border"),c.x[1],c.x[1],c.x[2]),jo=(0,o.css)(bo(),c.x[3]),wo=t=>{let{filters:e,onFilterChange:n,topLevelCommentCount:o}=t;return(0,r.jsxs)("div",{id:"comment-filters",css:yo,children:[(0,r.jsx)("div",{css:jo,children:(0,r.jsx)(lo,{id:"order-by-dropdown",label:"Sort by",options:[{title:"Newest",value:"newest",isActive:"newest"===e.orderBy},{title:"Oldest",value:"oldest",isActive:"oldest"===e.orderBy},{title:"Recommendations",value:"recommendations",isActive:"recommendations"===e.orderBy}],onSelect:t=>n(fo(po({},e),{orderBy:t}))})}),(0,r.jsx)("div",{css:vo}),(0,r.jsx)("div",{css:jo,children:(0,r.jsx)(lo,{id:"page-size-dropdown",label:"Per page",options:[{title:"25",value:"25",disabled:o<=25,isActive:25===e.pageSize},{title:"50",value:"50",disabled:o<=50,isActive:50===e.pageSize},{title:"100",value:"100",disabled:o<=100,isActive:100===e.pageSize}],onSelect:t=>n(fo(po({},e),{pageSize:parseInt(t)}))})}),(0,r.jsx)("div",{css:vo}),(0,r.jsx)("div",{css:jo,children:(0,r.jsx)(lo,{id:"threads-dropdown",label:"Display threads",options:[{title:"Collapsed",value:"collapsed",isActive:"collapsed"===e.threads},{title:"Expanded",value:"expanded",isActive:"expanded"===e.threads},{title:"Unthreaded",value:"unthreaded",isActive:"unthreaded"===e.threads}],onSelect:t=>n(fo(po({},e),{threads:t}))})})]})};function ko(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Co(){const t=ko(["\n  0% {\n    background-position: -1500px 0;\n  }\n  100% {\n    background-position: 1500px 0;\n  }\n"]);return Co=function(){return t},t}function Po(){const t=ko(["\n\tanimation: "," 2s infinite linear;\n\tbackground: linear-gradient(\n\t\tto right,\n\t\t"," 4%,\n\t\t"," 25%,\n\t\t"," 36%\n\t);\n\tbackground-size: 1500px 100%;\n"]);return Po=function(){return t},t}function Oo(){const t=ko(["\n\tborder-bottom: 1px solid ",";\n\twidth: 620px;\n\tdisplay: flex;\n\tpadding: ","px 0;\n"]);return Oo=function(){return t},t}function Mo(){const t=ko(["\n\tborder-radius: ","px;\n\twidth: ","px;\n\theight: ","px;\n\tbackground-color: ",";\n\tmargin-right: ","px;\n\n\t","\n"]);return Mo=function(){return t},t}function So(){const t=ko(["\n\t\t\theight: ","px;\n\t\t\twidth: ",";\n\t\t\tmargin-bottom: ","px;\n\t\t\tmargin-left: ","px;\n\t\t\tbackground-color: ",";\n\n\t\t\t","\n\t\t"]);return So=function(){return t},t}const Io=(0,g.M)("--discussion-loading-background"),Eo=(0,o.keyframes)(Co()),To=(0,o.css)(Po(),Eo,Io,(0,g.M)("--discussion-loading-shimmer"),Io),zo=(0,o.css)(Oo(),(0,g.M)("--discussion-border"),c.x[2]),Ro=t=>{let{height:e,width:n,spaceBelow:s,spaceLeft:a}=t;return(0,r.jsx)("div",{css:(0,o.css)(So(),e,(0,i.b)(n)||0===n||isNaN(n)?"100%":"".concat(n,"px"),s&&c.x[s],a&&c.x[a],Io,To)})},Fo=()=>(0,r.jsxs)("div",{css:zo,"data-testid":"loading-comments",children:[(0,r.jsx)("div",{css:(48,(0,o.css)(Mo(),58,48,48,Io,c.x[2],To))}),(0,r.jsxs)(Ct,{children:[(0,r.jsxs)(St,{children:[(0,r.jsx)(Ro,{height:20,width:140,spaceBelow:9}),(0,r.jsx)(Ro,{height:15,width:100,spaceBelow:9,spaceLeft:2})]}),(0,r.jsx)(Ro,{height:20,spaceBelow:1}),(0,r.jsx)(Ro,{height:20,spaceBelow:1}),(0,r.jsx)(Ro,{height:20,width:200,spaceBelow:5}),(0,r.jsxs)(St,{children:[(0,r.jsx)(Ro,{height:15,width:40}),(0,r.jsx)(Ro,{height:15,width:40,spaceLeft:6})]})]})]});var Uo=n(78580),Do=n(45717);function Lo(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function No(){const t=Lo(["\n\tcursor: pointer;\n\t","\n\n\ttext-decoration: none;\n\tborder-radius: 62.5rem;\n\tbox-sizing: border-box;\n\n\tcolor: ",";\n\tbackground-color: ",";\n\tborder: none;\n\t:hover {\n\t\tborder-width: 0.0625rem;\n\t\tborder-style: solid;\n\t\tborder-color: ",";\n\t}\n\n\tmargin-right: 2px;\n\tpadding: 0 0.125rem;\n\tmin-width: 1.5rem;\n\ttext-align: center;\n\n\theight: 1.5rem;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n"]);return No=function(){return t},t}function Bo(){const t=Lo(["\n\tline-height: 26px;\n\tmargin-right: 2px;\n"]);return Bo=function(){return t},t}function Ao(){const t=Lo(["\n\t",";\n\tcolor: ",";\n\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\tpadding: ","px 0;\n\tborder-top: 1px solid ",";\n\t"," {\n\t\tflex-direction: column;\n\t}\n"]);return Ao=function(){return t},t}function Yo(){const t=Lo(["\n\tdisplay: flex;\n\tflex-direction: row;\n\theight: 25px;\n\n\tbutton:hover {\n\t\tborder-color: ",";\n\t}\n"]);return Yo=function(){return t},t}function _o(){const t=Lo(["\n\t",";\n\tmargin-left: 5px;\n\t"," {\n\t\tpadding-top: 10px;\n\t}\n"]);return _o=function(){return t},t}function Ho(){const t=Lo(["\n\t\t\t/* theme does not support Tertiary background */\n\t\t\tbackground-color: ",";\n\t\t\t/* the icon is not perfectly centred */\n\t\t\tsvg {\n\t\t\t\ttransform: translateX(1px);\n\t\t\t}\n\t\t"]);return Ho=function(){return t},t}function Ko(){const t=Lo(["\n\t\t\t/* theme does not support Tertiary background */\n\t\t\tbackground-color: ",";\n\t\t\t/* the icon is not perfectly centred */\n\t\t\tsvg {\n\t\t\t\ttransform: translateX(-1px);\n\t\t\t}\n\t\t"]);return Ko=function(){return t},t}const qo=t=>(0,o.css)(No(),b.yui,t?(0,g.M)("--discussion-pagination-background"):(0,g.M)("--discussion-pagination-text"),t?(0,g.M)("--discussion-pagination-text"):"transparent",(0,g.M)("--discussion-pagination-text")),Go={borderTertiary:(0,g.M)("--discussion-pagination-border"),backgroundTertiaryHover:(0,g.M)("--discussion-pagination-background"),textTertiary:(0,g.M)("--discussion-pagination-text")},Vo=(0,o.css)(Bo()),$o=(0,o.css)(Ao(),b.PSs,(0,g.M)("--discussion-pagination-text"),c.x[2],(0,g.M)("--discussion-pagination-border"),k.TG.mobileLandscape),Wo=(0,o.css)(Yo(),(0,g.M)("--discussion-pagination-border-hover")),Jo=(0,o.css)(_o(),b.PSs,k.TG.mobileLandscape),Xo=t=>{let{currentPage:e,setCurrentPage:n}=t;return(0,r.jsx)(O.$,{onClick:()=>n(e+1),"data-link-name":"Pagination view page ".concat(e+1),size:"xsmall",priority:"tertiary",theme:Go,cssOverrides:(0,o.css)(Ho(),(0,g.M)("--discussion-pagination-background")),icon:(0,r.jsx)(Uo.s,{theme:{fill:(0,g.M)("--discussion-pagination-text")}}),hideLabel:!0,children:"Previous discussion page"})},Zo=t=>{let{currentPage:e,setCurrentPage:n}=t;return(0,r.jsx)(O.$,{onClick:()=>n(e-1),"data-link-name":"Pagination view page ".concat(e-1),size:"xsmall",priority:"tertiary",theme:Go,cssOverrides:(0,o.css)(Ko(),(0,g.M)("--discussion-pagination-background")),icon:(0,r.jsx)(Do.P,{theme:{fill:(0,g.M)("--discussion-pagination-text")}}),hideLabel:!0,children:"Previous discussion page"})},Qo=t=>{let{currentPage:e,setCurrentPage:n,isSelected:o}=t;return(0,r.jsx)("button",{css:qo(o),onClick:()=>n(e),"data-link-name":"Pagination view page ".concat(e),type:"button",children:e},e)},ts=(t,e)=>e<=6?[1,2,3,4,5,6].filter((t=>t<=e)):t<=3?[1,2,3,4,"…",e]:t<=e-3?[1,"…",t-1,t,t+1,"…",e]:[1,"…",e-3,e-2,e-1,e],es=t=>{let{currentPage:e,setCurrentPage:n,topLevelCommentCount:o,filters:s}=t;const i=Math.ceil(o/s.pageSize),c=i>4&&e>1,a=i>4&&e!==i,{pageSize:d}=s,u=1+d*(e-1),l=Math.min(d*e,o);return(0,r.jsxs)("div",{css:$o,children:[(0,r.jsxs)("div",{css:Wo,children:[c&&(0,r.jsx)(Zo,{currentPage:e,setCurrentPage:n}),ts(e,i).map(((t,o)=>"…"===t?(0,r.jsx)("div",{css:Vo,children:"…"},1===o?"first-ellipsis":"last-ellipsis"):(0,r.jsx)(Qo,{currentPage:t,setCurrentPage:n,isSelected:t===e},"page-".concat(t)))),a&&(0,r.jsx)(Xo,{currentPage:e,setCurrentPage:n})]}),(0,r.jsx)("div",{css:Jo,children:"Displaying ".concat("unthreaded"===s.threads?"comments":"threads"," ").concat(u," to ").concat(l," of ").concat(o)})]})};function ns(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function rs(){const t=ns(["\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 100%;\n\tmin-width: 250px;\n\tmargin-bottom: ","px;\n\t",";\n\n\tblockquote {\n\t\tmargin-top: ","px;\n\t\tmargin-bottom: ","px;\n\t\tmargin-left: ","px;\n\t\tmargin-right: ","px;\n\t\tpadding-left: ","px;\n\t\tcolor: ",";\n\t}\n"]);return rs=function(){return t},t}function os(){const t=ns(["\n\tmargin-top: 3px;\n\tmargin-bottom: -6px;\n\tfont-weight: bold;\n\tcolor: ",";\n"]);return os=function(){return t},t}function ss(){const t=ns(["\n\tmargin-right: ","px;\n"]);return ss=function(){return t},t}function is(){const t=ns(["\n\ta {\n\t\t","\n\t}\n"]);return is=function(){return t},t}function cs(){const t=ns(["\n\tcolor: ",";\n\ttext-decoration: none;\n\t:hover {\n\t\ttext-decoration: underline;\n\t\tcolor: ",";\n\t}\n"]);return cs=function(){return t},t}function as(){const t=ns(["\n\tcolor: ",";\n\t:hover {\n\t\tcolor: ",";\n\t}\n"]);return as=function(){return t},t}function ds(){const t=ns(["\n\ta {\n\t\tcolor: ",";\n\t\ttext-decoration: none;\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n"]);return ds=function(){return t},t}function us(){const t=ns(["\n\t",";\n\tfont-weight: bold;\n\tmargin: 0px;\n\tmargin-bottom: ","px;\n"]);return us=function(){return t},t}function ls(){const t=ns(["\n\tcolor: inherit;\n"]);return ls=function(){return t},t}function ms(){const t=ns(["\n\tword-break: break-word;\n"]);return ms=function(){return t},t}function ps(){const t=ns(["\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: space-between;\n\n\t\t\tpadding: ","px;\n\t\t\tbackground-color: ",";\n\t\t\tborder-radius: 15px;\n\t\t\tmargin-bottom: ","px;\n\t\t\tposition: relative;\n\n\t\t\t"," {\n\t\t\t\tmin-height: 150px;\n\t\t\t}\n\n\t\t\t:before {\n\t\t\t\tcontent: '';\n\t\t\t\tmargin-left: ","px;\n\t\t\t\tposition: absolute;\n\t\t\t\tborder-right: ","px solid transparent;\n\t\t\t\tborder-top: ","px solid\n\t\t\t\t\t",";\n\t\t\t\tbottom: -","px;\n\t\t\t}\n\n\t\t\tp {\n\t\t\t\tmargin-top: 0;\n\t\t\t\tmargin-bottom: ","px;\n\t\t\t}\n\t\t"]);return ps=function(){return t},t}function fs(){const t=ns(["\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\tpadding-top: ","px;\n\t\t"]);return fs=function(){return t},t}const hs=(0,o.css)(rs(),c.x[5],b.PSs,c.x[3],c.x[3],c.x[5],c.x[5],c.x[2],(0,g.M)("--discussion-subdued")),xs=(0,o.css)(os(),(0,g.M)("--discussion-accent-text")),gs=(0,o.css)(ss(),c.x[2]),bs=(0,o.css)(is(),b.PSs),ys=(0,o.css)(cs(),(0,g.M)("--discussion-top-pick-link"),(0,g.M)("--discussion-top-pick-link")),vs=(0,o.css)(as(),(0,g.M)("--discussion-top-pick-link"),(0,g.M)("--discussion-top-pick-link")),js=(0,o.css)(ds(),(0,g.M)("--discussion-top-pick-link")),ws=(0,o.css)(us(),b.PSs,c.x[1]),ks=(0,o.css)(ls()),Cs=(0,o.css)(ms()),Ps=t=>{let{children:e}=t;return(0,r.jsx)("div",{css:(0,o.css)(ps(),c.x[3],(0,g.M)("--discussion-top-pick-background"),30,k.HT.tablet,c.x[6],25,25,(0,g.M)("--discussion-top-pick-background"),24,c.x[3]),children:e})},Os=t=>{let{children:e}=t;return(0,r.jsx)("div",{children:e})},Ms=t=>{let{children:e}=t;return(0,r.jsx)("div",{children:e})},Ss=t=>{let{children:e}=t;return(0,r.jsx)("div",{css:(0,o.css)(fs(),c.x[1]),children:e})},Is=t=>{let{comment:e,user:n,userMadeComment:o,onPermalinkClick:s,isClosedForRecommendations:i}=t;const c=e.userProfile.badge.some((t=>"Staff"===t.name)),a=e.userProfile.badge.some((t=>"Contributor"===t.name));return(0,r.jsxs)("div",{css:hs,children:[(0,r.jsxs)(Ps,{children:[(0,r.jsxs)(Os,{children:[(0,r.jsx)("h3",{css:ws,children:"Guardian Pick"}),(0,r.jsx)("p",{css:[Cs,js],dangerouslySetInnerHTML:{__html:(d=e.body,450,d.length>450?d.substr(0,450)+"&#8230;":d)}})]}),(0,r.jsx)(Ms,{children:(0,r.jsx)("div",{css:bs,children:(0,r.jsx)(C.N,{priority:"primary",href:e.webUrl,cssOverrides:vs,onClick:t=>{s(e.id),t.preventDefault()},rel:"nofollow",children:"Jump to comment"})})})]}),(0,r.jsxs)(Ss,{children:[(0,r.jsxs)(St,{children:[(0,r.jsx)("div",{css:gs,children:(0,r.jsx)(at,{imageUrl:e.userProfile.avatar,displayName:"",size:"medium"})}),(0,r.jsxs)(Ct,{children:[(0,r.jsx)("span",{css:xs,children:(0,r.jsx)("a",{href:e.userProfile.webUrl,css:[ys,ks],rel:"nofollow",children:e.userProfile.displayName})}),(0,r.jsx)(Kt,{isoDateTime:e.isoDateTime,webUrl:e.webUrl,commentId:e.id,onPermalinkClick:s}),c&&(0,r.jsx)(vt,{}),a&&!c&&(0,r.jsx)(jt,{})]})]}),(0,r.jsx)(Dt,{commentId:e.id,initialCount:e.numRecommends,alreadyRecommended:!1,user:n,userMadeComment:o,isClosedForRecommendations:i})]})]});var d};function Es(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Ts(){const t=Es(["\n\twidth: 50%;\n\tdisplay: flex;\n\tflex-direction: column;\n"]);return Ts=function(){return t},t}function zs(){const t=Es(["\n\tpadding-right: 10px;\n"]);return zs=function(){return t},t}function Rs(){const t=Es(["\n\tpadding-left: 10px;\n"]);return Rs=function(){return t},t}function Fs(){const t=Es(["\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n"]);return Fs=function(){return t},t}function Us(){const t=Es(["\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: row;\n\t"," {\n\t\tdisplay: none;\n\t}\n"]);return Us=function(){return t},t}function Ds(){const t=Es(["\n\twidth: 100%;\n\t"," {\n\t\tdisplay: none;\n\t}\n"]);return Ds=function(){return t},t}const Ls=(0,o.css)(Ts()),Ns=(0,o.css)(zs()),Bs=(0,o.css)(Rs()),As=(0,o.css)(Fs()),Ys=(0,o.css)(Us(),k.TG.tablet),_s=(0,o.css)(Ds(),k.HT.tablet),Hs=t=>{let{user:e,comments:n,onPermalinkClick:o,isClosedForRecommendations:s}=t;const i=[],c=[];for(const[t,e]of n.entries())t%2==0?i.push(e):c.push(e);return(0,r.jsxs)("div",{css:As,children:[(0,r.jsxs)("div",{css:Ys,children:[(0,r.jsx)("div",{css:[Ls,Ns],children:i.map((t=>(0,r.jsx)(Is,{comment:t,user:e,userMadeComment:(null==e?void 0:e.profile.userId)===t.userProfile.userId,onPermalinkClick:o,isClosedForRecommendations:s},t.id)))}),(0,r.jsx)("div",{css:[Ls,Bs],children:c.map((t=>(0,r.jsx)(Is,{comment:t,user:e,userMadeComment:(null==e?void 0:e.profile.userId)===t.userProfile.userId,onPermalinkClick:o,isClosedForRecommendations:s},t.id)))})]}),(0,r.jsx)("div",{css:_s,children:n.map((t=>(0,r.jsx)(Is,{comment:t,userMadeComment:(null==e?void 0:e.profile.userId)===t.userProfile.userId,onPermalinkClick:o,isClosedForRecommendations:s},t.id)))})]})};function Ks(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function qs(){const t=Ks(["\n\tdisplay: flex;\n\tjustify-content: flex-end;\n"]);return qs=function(){return t},t}function Gs(){const t=Ks(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tmax-width: 100%;\n"]);return Gs=function(){return t},t}function Vs(){const t=Ks(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tlist-style-type: none;\n\tpadding-left: 0;\n\tmargin: 0;\n"]);return Vs=function(){return t},t}function $s(){const t=Ks(["\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tjustify-content: space-between;\n"]);return $s=function(){return t},t}function Ws(){const t=Ks(["\n\t\t\tcolor: ",";\n\t\t\t","\n\t\t\tpadding-top: ","px;\n\t\t\tpadding-left: ","px;\n\t\t\tpadding-bottom: ","px;\n\t\t"]);return Ws=function(){return t},t}const Js=(0,o.css)(qs()),Xs=(0,o.css)(Gs()),Zs=(0,o.css)(Vs()),Qs=(0,o.css)($s()),ti=()=>(0,r.jsx)("div",{css:(0,o.css)(Ws(),(0,g.M)("--discussion-subdued"),b.PSs,c.x[5],c.x[1],c.x[9]),children:"No comments found"}),ei=()=>document.dispatchEvent(new CustomEvent("comments-state-change")),ni=t=>{let{baseUrl:e,shortUrl:n,isClosedForComments:o,isClosedForRecommendations:c,commentToScrollTo:a,user:u,additionalHeaders:p,expanded:f,onPermalinkClick:h,apiKey:x,onPreview:g,idApiUrl:b,page:v,filters:w,topLevelCommentCount:k,loading:C,comments:P,topForm:O,replyForm:M,bottomForm:S,reportAbuse:I}=t;const[E,T]=(0,d.useState)([]),[z,R]=(0,d.useState)(),[F,U]=(0,d.useState)((()=>{var t;const e=null!==(t=s.I.local.get("gu.prefs.discussion.mutes"))&&void 0!==t?t:[];return Array.isArray(e)&&e.every(m.K)?e:[]})()),{renderingTarget:D}=(0,y.U)(),L="Web"===D,N=(0,d.useContext)(j),B=(t,e)=>{N({type:"filterChange",filters:t,commentPage:e})},A=t=>N({type:"setReplyFormUserMissing",userNameMissing:t}),Y=t=>N({type:"setReplyFormError",error:t}),_=t=>N({type:"setReplyFormPreviewBody",previewBody:t}),H=(t,e)=>N({type:"expandCommentReplies",commentId:t,responses:e});(0,d.useEffect)((()=>{if(L&&f&&!C){const t=new CustomEvent("comments-loaded");document.dispatchEvent(t)}}),[L,f,C]),(0,d.useEffect)((()=>{(0,l.tn)(n).then((t=>{"error"!==t.kind?T(t.value):console.error(t.error)}))}),[n]),(0,d.useEffect)((()=>{var t;(0,i.b)(a)||C||null===(t=document.getElementById("comment-".concat(a)))||void 0===t||t.scrollIntoView()}),[a,C]);const K=t=>{const e=Math.ceil(k/t.pageSize);v>e?B(t,e):B(t),L&&ei()};(0,d.useEffect)((()=>{const t=document.getElementById("comment-filters");null==t||t.scrollIntoView()}),[v]),(0,d.useEffect)((()=>{(t=>{s.I.local.set("gu.prefs.discussion.mutes",t)})(F)}),[F]);const q=t=>{const e=F.includes(t)?F.filter((e=>e!==t)):[...F,t];U(e)},G=t=>{t.responses?(t=>{N({type:"addComment",comment:t})})(t):(t=>{N({type:"addReply",comment:t})})(t);const e=document.getElementById("comment-".concat(t.id));null==e||e.scrollIntoView()},V=t=>{N({type:"updateCommentPage",commentPage:t}),L&&ei()};(0,l.cU)({additionalHeaders:p,baseUrl:e,apiKey:x,idApiUrl:b});const $=k>w.pageSize;return!f&&C?(0,r.jsx)("span",{"data-testid":"loading-comments"}):f?(0,r.jsxs)("div",{"data-component":"discussion",css:Xs,children:[u&&!o&&(0,r.jsx)(dr,{shortUrl:n,onAddComment:G,user:u,onPreview:g,error:O.error,setError:t=>N({type:"setTopFormError",error:t}),userNameMissing:O.userNameMissing,setUserNameMissing:t=>N({type:"setTopFormUserMissing",userNameMissing:t}),previewBody:O.previewBody,setPreviewBody:t=>N({type:"setTopFormPreviewBody",previewBody:t})}),!!E.length&&(0,r.jsx)(Hs,{comments:E,user:u,onPermalinkClick:h,isClosedForRecommendations:c}),(0,r.jsx)(wo,{filters:w,onFilterChange:K,topLevelCommentCount:k}),$&&(0,r.jsx)(es,{currentPage:v,setCurrentPage:V,topLevelCommentCount:k,filters:w}),C?(0,r.jsx)(Fo,{}):P.length?(0,r.jsx)("ul",{css:[Zs],"data-commercial-id":"comments-column",children:P.map((t=>(0,r.jsx)("li",{children:(0,r.jsx)(qr,{comment:t,isClosedForComments:o,isClosedForRecommendations:c,shortUrl:n,user:u,threads:w.threads,commentBeingRepliedTo:z,setCommentBeingRepliedTo:R,commentToScrollTo:a,mutes:F,toggleMuteStatus:q,onPermalinkClick:h,error:M.error,setError:Y,userNameMissing:M.userNameMissing,setUserNameMissing:A,previewBody:M.previewBody,setPreviewBody:_,reportAbuse:I,expandCommentReplies:H,isExpanded:f})},t.id)))}):(0,r.jsx)(ti,{}),$&&(0,r.jsx)("footer",{css:Js,children:(0,r.jsx)(es,{currentPage:v,setCurrentPage:V,topLevelCommentCount:k,filters:w})}),u&&!o&&P.length>10&&(0,r.jsx)(dr,{shortUrl:n,onAddComment:G,user:u,onPreview:g,error:S.error,setError:t=>N({type:"setBottomFormError",error:t}),userNameMissing:S.userNameMissing,setUserNameMissing:t=>N({type:"setBottomFormUserMissing",userNameMissing:t}),previewBody:S.previewBody,setPreviewBody:t=>N({type:"setBottomFormPreviewBody",previewBody:t})})]}):(0,r.jsx)("div",{"data-component":"discussion",css:Zs,children:0!==E.length?(0,r.jsx)("div",{css:Qs,children:(0,r.jsx)(Hs,{comments:E.slice(0,2),user:u,onPermalinkClick:h,isClosedForRecommendations:c})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(wo,{filters:w,onFilterChange:K,topLevelCommentCount:k}),$&&(0,r.jsx)(es,{currentPage:v,setCurrentPage:V,topLevelCommentCount:k,filters:w}),P.length?(0,r.jsx)("ul",{css:Zs,children:P.slice(0,2).map((t=>(0,r.jsx)("li",{children:(0,r.jsx)(qr,{comment:t,isClosedForComments:o,isClosedForRecommendations:c,shortUrl:n,user:u,threads:w.threads,commentBeingRepliedTo:z,setCommentBeingRepliedTo:R,mutes:F,toggleMuteStatus:q,onPermalinkClick:h,error:M.error,setError:Y,userNameMissing:M.userNameMissing,setUserNameMissing:A,previewBody:M.previewBody,setPreviewBody:_,reportAbuse:I,expandCommentReplies:H,isExpanded:f})},t.id)))}):(0,r.jsx)(ti,{})]})})};var ri=n(22e3),oi=n(11493);function si(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ii(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){si(t,e,n[e])}))}return t}function ci(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function ai(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function di(){const t=ai(["\n\tbackground-image: linear-gradient(\n\t\t0deg,\n\t\t",",\n\t\t"," 40%,\n\t\ttransparent\n\t);\n\theight: 80px;\n\tposition: absolute;\n\tbottom: 0;\n\tright: 0;\n\twidth: 100%;\n\tdisplay: block;\n"]);return di=function(){return t},t}function ui(){const t=ai(["\n\tmax-height: 280px;\n\tmin-height: 280px;\n\toverflow: hidden;\n"]);return ui=function(){return t},t}function li(){const t=ai(["\n\tposition: relative;\n"]);return li=function(){return t},t}function mi(){const t=ai(["\n\t\t\t\t\t\t\tpadding-bottom: ","px;\n\t\t\t\t\t\t"]);return mi=function(){return t},t}const pi=(0,o.css)(di(),(0,g.M)("--discussion-section-background"),(0,g.M)("--discussion-section-background")),fi=(0,o.css)(ui()),hi=(0,o.css)(li()),xi=(t,e)=>e?"collapsed"!==t.threads?t:ci(ii({},t),{threads:"expanded"}):t,gi=t=>e=>e.id===t.commentId?ci(ii({},e),{responses:t.responses}):e,bi={isActive:!1,userNameMissing:!1,error:"",showPreview:!1,previewBody:"",body:""},yi={comments:[],isClosedForComments:!1,isClosedForRecommendation:!1,isExpanded:!1,commentPage:1,commentCount:void 0,topLevelCommentCount:0,filters:(()=>{const t=(e=s.I.local.get("gu.prefs.discussion.order"),(0,m.K)(e)&&(0,p.E)(f)(e)?e:"newest");var e;const n=(t=>(0,m.K)(t)&&(0,p.E)(h)(t)?t:"collapsed")(s.I.local.get("gu.prefs.discussion.threading")),r=(t=>"number"==typeof t&&(0,p.E)(x)(t)?t:25)(s.I.local.get("gu.prefs.discussion.pagesize"));return{orderBy:t,threads:n,pageSize:r}})(),hashCommentId:void 0,loading:!0,topForm:bi,replyForm:bi,bottomForm:bi},vi=(t,e)=>{switch(e.type){case"commentsLoaded":return ci(ii({},t),{comments:e.comments,isClosedForComments:e.isClosedForComments,isClosedForRecommendation:e.isClosedForRecommendation,commentCount:e.commentCount,topLevelCommentCount:e.topLevelCommentCount,loading:!1});case"addComment":return ci(ii({},t),{comments:[e.comment,...t.comments],isExpanded:!0});case"addReply":return ci(ii({},t),{comments:t.comments.map((t=>t.responses&&t.id===e.comment.responseTo.commentId?ci(ii({},t),{responses:[...t.responses,e.comment]}):t)),isExpanded:!0});case"expandComments":return ci(ii({},t),{isExpanded:!0});case"updateCommentPage":return ci(ii({},t),{commentPage:e.commentPage,isExpanded:!0});case"filterChange":var n;return ci(ii({},t),{filters:e.filters,hashCommentId:void 0,isExpanded:!0,commentPage:null!==(n=e.commentPage)&&void 0!==n?n:t.commentPage});case"setLoading":return ci(ii({},t),{loading:e.loading});case"updateHashCommentId":return ci(ii({},t),{hashCommentId:e.hashCommentId,isExpanded:!0});case"setTopFormUserMissing":return ci(ii({},t),{topForm:ci(ii({},t.topForm),{userNameMissing:e.userNameMissing})});case"setReplyFormUserMissing":return ci(ii({},t),{replyForm:ci(ii({},t.replyForm),{userNameMissing:e.userNameMissing})});case"setBottomFormUserMissing":return ci(ii({},t),{bottomForm:ci(ii({},t.bottomForm),{userNameMissing:e.userNameMissing})});case"setTopFormPreviewBody":return ci(ii({},t),{topForm:ci(ii({},t.topForm),{previewBody:e.previewBody})});case"setReplyFormPreviewBody":return ci(ii({},t),{replyForm:ci(ii({},t.replyForm),{previewBody:e.previewBody})});case"setBottomFormPreviewBody":return ci(ii({},t),{bottomForm:ci(ii({},t.bottomForm),{previewBody:e.previewBody})});case"setTopFormError":return ci(ii({},t),{topForm:ci(ii({},t.topForm),{error:e.error})});case"setReplyFormError":return ci(ii({},t),{replyForm:ci(ii({},t.replyForm),{error:e.error})});case"setBottomFormError":return ci(ii({},t),{bottomForm:ci(ii({},t.bottomForm),{error:e.error})});case"expandCommentReplies":return ci(ii({},t),{isExpanded:!0,comments:t.comments.map(gi(e))});default:return(0,u.d)(e),t}},ji=t=>{let{discussionApiUrl:e,shortUrlId:n,discussionD2Uid:u,discussionApiClientHeader:m,enableDiscussionSwitch:p,user:f,idApiUrl:h,reportAbuseUnauthenticated:x}=t;const[{comments:g,isClosedForComments:b,isClosedForRecommendation:y,isExpanded:v,commentPage:j,filters:k,hashCommentId:C,loading:P,topForm:O,replyForm:M,bottomForm:S,topLevelCommentCount:I,commentCount:E},T]=(0,d.useReducer)(vi,yi);(0,d.useEffect)((()=>{const t=(()=>{const{hash:t}=window.location;if(!t.includes("comment"))return;const[,e]=t.split("-");return e||void 0})();(0,i.b)(t)||T({type:"updateHashCommentId",hashCommentId:t})}),[]),(0,d.useEffect)((()=>{T({type:"setLoading",loading:!0});const t=new AbortController;return(0,l.Pu)({shortUrl:n,page:j,filters:xi(k,C),signal:t.signal}).then((t=>{if("error"===t.kind)return void("AbortedSignal"!==t.error&&console.error("getDiscussion - error: ".concat(t.error)));const{discussion:e}=t.value;T({type:"commentsLoaded",comments:e.comments,isClosedForComments:e.isClosedForComments,isClosedForRecommendation:e.isClosedForRecommendation,topLevelCommentCount:e.topLevelCommentCount,commentCount:e.commentCount})})).catch((()=>{})),()=>t.abort()}),[j,k,C,n]);const z=xi(k,C);return(0,d.useEffect)((()=>{(t=>{let{threads:e,pageSize:n,orderBy:r}=t;s.I.local.set("gu.prefs.discussion.threading",e),s.I.local.set("gu.prefs.discussion.pagesize",n),s.I.local.set("gu.prefs.discussion.order",r)})(k)}),[k]),(0,d.useEffect)((()=>{(0,i.b)(C)||(0,l.zy)(e,C,xi(k,C)).then((t=>{"ok"===t.kind?T({type:"updateCommentPage",commentPage:t.value.page}):console.error("getCommentContext - error: ".concat(t.error))})).catch((t=>console.error("getCommentContext - error: ".concat(String(t)))))}),[k,e,C]),(0,d.useEffect)((()=>{"#comments"===window.location.hash&&T({type:"expandComments"})}),[]),(0,d.useEffect)((()=>{0!==E&&1!==E&&2!==E||T({type:"expandComments"})}),[E]),(0,r.jsxs)(w,{value:T,children:[(0,r.jsxs)("div",{css:[hi,!v&&fi],children:[(0,r.jsx)(ri.L,{when:"above",breakpoint:"leftCol",children:(0,r.jsx)("div",{"data-testid":"discussion",css:(0,o.css)(mi(),c.x[2]),children:(0,r.jsx)(oi.C,{enableDiscussionSwitch:p,user:null==f?void 0:f.profile,commentCount:E,isClosedForComments:b})})}),(0,r.jsx)(ni,{user:f,baseUrl:e,isClosedForComments:!!b||!p,isClosedForRecommendations:!!y,shortUrl:n,additionalHeaders:{"D2-X-UID":u,"GU-Client":m},expanded:v,commentToScrollTo:C,onPermalinkClick:t=>(window.location.hash="#comment-".concat(t),T({type:"updateHashCommentId",hashCommentId:t}),!1),apiKey:"dotcom-rendering",idApiUrl:h,page:j,filters:z,topLevelCommentCount:I,loading:P,comments:g,topForm:O,replyForm:M,bottomForm:S,reportAbuse:(0,i.b)(f)?x:f.reportAbuse}),!v&&(0,r.jsx)("div",{id:"discussion-overlay",css:pi})]}),!v&&(0,r.jsx)(un,{onClick:()=>{T({type:"expandComments"})},icon:(0,r.jsx)(a.D,{}),linkName:"view-more-comments",children:"View more comments"})]})}},22e3:(t,e,n)=>{n.d(e,{L:()=>d});var r=n(50484),o=n(24017),s=n(99923);function i(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function c(){const t=i(["\n\t\t\t"," {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t"]);return c=function(){return t},t}function a(){const t=i(["\n\t\t\t"," {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t"]);return a=function(){return t},t}const d=t=>{let e,{children:n,when:i,breakpoint:d,el:u}=t;return e="below"===i?(0,o.css)(c(),s.TG[d]):(0,o.css)(a(),s.HT[d]),"li"===u?(0,r.jsx)("li",{css:e,children:n}):(0,r.jsx)("span",{css:e,children:n})}},16488:(t,e,n)=>{n.d(e,{d:()=>r});const r=t=>{throw new Error("This should be unreachable")}},34793:(t,e,n)=>{n.d(e,{Bq:()=>P,HN:()=>x,L6:()=>m,MR:()=>k,Te:()=>g,mw:()=>c,nI:()=>w,pl:()=>O,qb:()=>f});var r=n(92582),o=n(46061),s=n(40264);const i=(0,o.Ikc)({userId:(0,o.YjP)(),displayName:(0,o.YjP)(),webUrl:(0,o.YjP)(),apiUrl:(0,o.YjP)(),avatar:(0,o.YjP)(),secureAvatarUrl:(0,o.YjP)(),badge:(0,o.YOg)((0,o.Ikc)({name:(0,o.YjP)()})),privateFields:(0,o.lqM)((0,o.Ikc)({canPostComment:(0,o.zMY)(),isPremoderated:(0,o.zMY)(),hasCommented:(0,o.zMY)()}))}),c=t=>{const e=(0,o.xLC)((0,o.Ikc)({status:(0,o.euz)("ok"),userProfile:i}),t);return e.success?(0,s.ok)(e.output.userProfile):(0,s.z)("ParsingError")},a=(0,o.Ikc)({id:(0,o.pdi)((0,o.KCZ)([(0,o.aig)(),(0,o.YjP)()]),(t=>t.toString())),body:(0,o.YjP)(),date:(0,o.YjP)(),isoDateTime:(0,o.YjP)(),status:(0,o.YjP)(),webUrl:(0,o.YjP)(),apiUrl:(0,o.YjP)(),numResponses:(0,o.lqM)((0,o.aig)()),numRecommends:(0,o.aig)(),isHighlighted:(0,o.zMY)(),userProfile:i,discussion:(0,o.lqM)((0,o.Ikc)({key:(0,o.YjP)(),webUrl:(0,o.YjP)(),apiUrl:(0,o.YjP)(),title:(0,o.YjP)(),isClosedForComments:(0,o.zMY)(),isClosedForRecommendation:(0,o.zMY)()})),metaData:(0,o.lqM)((0,o.Ikc)({commentCount:(0,o.aig)(),staffCommenterCount:(0,o.aig)(),editorsPickCount:(0,o.aig)(),blockedCount:(0,o.aig)(),responseCount:(0,o.aig)()}))}),d=(0,o.h1I)([a,(0,o.Ikc)({responses:(0,o.lqM)((0,o.Km6)(),void 0),responseTo:(0,o.Ikc)({displayName:(0,o.YjP)(),commentApiUrl:(0,o.YjP)(),isoDateTime:(0,o.YjP)(),date:(0,o.YjP)(),commentId:(0,o.YjP)(),commentWebUrl:(0,o.YjP)()})})]),u=(0,o.h1I)([a,(0,o.Ikc)({responses:(0,o.lqM)((0,o.YOg)(d),[]),responseTo:(0,o.lqM)((0,o.Km6)(),void 0)})]),l=(0,o.Oxt)("status",[(0,o.Ikc)({status:(0,o.euz)("error")}),(0,o.Ikc)({status:(0,o.euz)("ok"),comment:u})]),m=t=>{const e=(0,o.xLC)(l,t);return e.success?"error"===e.output.status?(0,s.z)("ApiError"):(0,s.ok)(e.output.comment.responses):(0,s.z)("ParsingError")},p=(0,o.Oxt)("status",[(0,o.Ikc)({status:(0,o.euz)("error"),errorCode:(0,o.KIO)(["USERNAME_MISSING","EMPTY_COMMENT_BODY","COMMENT_TOO_LONG","USER_BANNED","IP_THROTTLED","DISCUSSION_CLOSED","PARENT_COMMENT_MODERATED","COMMENT_RATE_LIMIT_EXCEEDED","INVALID_PROTOCOL","AUTH_COOKIE_INVALID","READ-ONLY-MODE","API_CORS_BLOCKED","API_ERROR","EMAIL_NOT_VALIDATED"])}),(0,o.Ikc)({status:(0,o.euz)("ok"),message:(0,o.YjP)()})]),f=t=>{const{success:e,output:n}=(0,o.xLC)(p,t);return e?"error"===n.status?(0,s.z)(n.errorCode):(0,s.ok)(n.message):(0,s.z)("ParsingError")},h=(0,o.Oxt)("status",[(0,o.Ikc)({status:(0,o.euz)("error"),message:(0,o.YjP)()}),(0,o.Ikc)({status:(0,o.euz)("ok")})]),x=t=>{const{success:e,output:n}=(0,o.xLC)(h,t);return e?"ok"===n.status?(0,s.ok)(!0):(0,s.z)(n.message):(0,s.z)("An unknown error occured")},g=(0,o.Oxt)("status",[(0,o.Ikc)({status:(0,o.euz)("error"),errors:(0,o.YOg)((0,o.Ikc)({message:(0,o.YjP)()}),[(0,o.BpQ)(1)])}),(0,o.Ikc)({status:(0,o.euz)("ok")})]),b=["newest","oldest","recommendations"],y=((0,r.E)(b),(0,r.E)(["collapsed","expanded","unthreaded"]),[25,50,100]),v=((0,r.E)(y),(0,o.Ikc)({status:(0,o.euz)("error"),statusCode:(0,o.aig)(),message:(0,o.YjP)(),errorCode:(0,o.lqM)((0,o.YjP)())})),j=(0,o.Ikc)({status:(0,o.euz)("ok"),currentPage:(0,o.aig)(),pages:(0,o.aig)(),pageSize:(0,o.aig)(),orderBy:(0,o.YjP)(),discussion:(0,o.Ikc)({key:(0,o.YjP)(),webUrl:(0,o.YjP)(),apiUrl:(0,o.YjP)(),commentCount:(0,o.aig)(),topLevelCommentCount:(0,o.lqM)((0,o.aig)(),0),isClosedForComments:(0,o.zMY)(),isClosedForRecommendation:(0,o.zMY)(),isThreaded:(0,o.zMY)(),title:(0,o.YjP)(),comments:(0,o.YOg)((0,o.KCZ)([d,u]))})}),w=(0,o.Oxt)("status",[v,j]),k=(0,o.Ikc)({status:(0,o.euz)("ok"),statusCode:(0,o.euz)(200),message:(0,o.YjP)()}),C=(0,o.Ikc)({status:(0,o.euz)("ok"),statusCode:(0,o.euz)(200)}),P=t=>{const{success:e}=(0,o.xLC)(C,t);return e?(0,s.ok)(!0):(0,s.z)("ParsingError")},O=(0,o.Ikc)({status:(0,o.euz)("ok"),commentId:(0,o.aig)(),commentAncestorId:(0,o.aig)(),discussionKey:(0,o.YjP)(),discussionWebUrl:(0,o.YjP)(),discussionApiUrl:(0,o.YjP)(),orderBy:(0,o.KIO)(b),pageSize:(0,o.KIO)(y),page:(0,o.aig)()})},38679:(t,e,n)=>{n.d(e,{S:()=>C,Im:()=>y,EE:()=>M,zy:()=>S,Pu:()=>g,tn:()=>j,cU:()=>h,XH:()=>P,VH:()=>b,vh:()=>k,Tm:()=>v,Vf:()=>w,KW:()=>O});var r=n(88482),o=n(85770),s=n(72762),i=n(46061),c=n(34793),a=n(97656),d=n(40264);const u=async function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];try{const t=await fetch(...e);return(0,d.ok)(await t.json())}catch(t){return t instanceof SyntaxError?(0,d.z)("ApiError"):(0,d.z)("NetworkError")}};function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){l(t,e,n[e])}))}return t}const p={baseUrl:"https://discussion.theguardian.com/discussion-api",apiKey:"discussion-rendering",headers:{},idApiUrl:"https://idapi.theguardian.com"},f={"api-key":p.apiKey},h=t=>{let{baseUrl:e,additionalHeaders:n,apiKey:r,idApiUrl:o}=t;p.baseUrl=e||p.baseUrl,p.headers=n,p.apiKey=r||p.apiKey,p.idApiUrl=o||p.idApiUrl,f["api-key"]=p.apiKey},x=t=>"?"+Object.keys(t).map((e=>"".concat(e,"=").concat(t[e]))).join("&"),g=async t=>{let{shortUrl:e,page:n,filters:o,signal:s}=t;const a=m({},f,{orderBy:"recommendations"===o.orderBy?"mostRecommended":o.orderBy,pageSize:o.pageSize,displayThreaded:"unthreaded"!==o.threads,maxResponses:"collapsed"===o.threads?3:100,page:n}),l=x(a),h=(0,r.w)(p.baseUrl,"discussion",e)+l,b=await u(h,{headers:p.headers,signal:s});if("error"===b.kind)return s.aborted?(0,d.z)("AbortedSignal"):b;const y=(0,i.xLC)(c.nI,b.value);return y.success?"error"===y.output.status&&"DISCUSSION_ONLY_AVAILABLE_IN_LINEAR_FORMAT"===y.output.errorCode?g({shortUrl:e,page:n,filters:(v=m({},o),j={threads:"unthreaded"},j=null!=j?j:{},Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(j)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}(Object(j)).forEach((function(t){Object.defineProperty(v,t,Object.getOwnPropertyDescriptor(j,t))})),v),signal:s}):"error"===y.output.status?(0,d.z)("ApiError"):(0,d.ok)(y.output):(0,d.z)("ParsingError");var v,j},b=async t=>{const e=(0,r.w)(p.baseUrl,"comment/preview")+x(f),n=new URLSearchParams;n.append("body",t);const i=await u(e,{method:"POST",body:n.toString(),headers:m({"Content-Type":"application/x-www-form-urlencoded"},p.headers)});return"error"===i.kind?i:(0,o.G)(i.value)&&(0,s.K)(i.value.commentBody)?(0,d.ok)(i.value.commentBody):(0,d.z)("ParsingError")},y=t=>async(e,n)=>{const o=(0,r.w)(p.baseUrl,"discussion",e,"comment")+x(f),s=new URLSearchParams;s.append("body",n);const i=(0,a.Kv)(t),d=await u(o,{method:"POST",body:s.toString(),headers:m({"Content-Type":"application/x-www-form-urlencoded"},p.headers,i.headers),credentials:i.credentials});return"error"===d.kind?d:(0,c.qb)(d.value)},v=t=>async(e,n,o)=>{const s=(0,r.w)(p.baseUrl,"discussion",e,"comment",o,"reply")+x(f),i=new URLSearchParams;i.append("body",n);const d=(0,a.Kv)(t),l=await u(s,{method:"POST",body:i.toString(),headers:m({"Content-Type":"application/x-www-form-urlencoded"},p.headers,d.headers),credentials:d.credentials});return"error"===l.kind?l:(0,c.qb)(l.value)},j=async t=>{const e=(0,r.w)(p.baseUrl,"discussion",t,"topcomments")+x(f),n=await u(e,{headers:m({},p.headers)});if("error"===n.kind)return n;const o=(0,i.xLC)(c.nI,n.value);return o.success?"error"===o.output.status?(0,d.z)("ApiError"):(0,d.ok)(o.output.discussion.comments):(0,d.z)("ParsingError")},w=t=>async e=>{let{commentId:n,categoryId:o,email:s,reason:i}=e;const l=(0,r.w)(p.baseUrl,"comment",n,"reportAbuse")+x(f),h=new URLSearchParams;h.append("categoryId",o.toString()),s&&h.append("email",s.toString()),i&&h.append("reason",i);const g=t?(0,a.Kv)(t):void 0,b=await u(l,{method:"POST",body:h.toString(),headers:m({"Content-Type":"application/x-www-form-urlencoded"},p.headers,null==g?void 0:g.headers),credentials:null==g?void 0:g.credentials});return"error"===b.kind?(0,d.z)("An unknown error occured"):(0,c.HN)(b.value)},k=t=>async e=>{const n=(0,r.w)(p.baseUrl,"comment",e,"recommend")+x(f),o=(0,a.Kv)(t);var s;const i=await u(n,{method:"POST",headers:m({},p.headers,null!==(s=o.headers)&&void 0!==s?s:{}),credentials:o.credentials});return"error"!==i.kind&&"ok"===(0,c.Bq)(i.value).kind},C=t=>async e=>{const n=p.idApiUrl+"/user/me/username",r=(0,a.Kv)(t),o=await u(n,{method:"POST",body:JSON.stringify({publicFields:{username:e,displayName:e}}),headers:m({"Content-Type":"application/json"},r.headers),credentials:r.credentials});if("error"===o.kind)return o;const s=(0,i.xLC)(c.Te,o.value);return s.success?"error"===s.output.status?(0,d.z)(s.output.errors.map((t=>{let{message:e}=t;return e})).join("\n")):(0,d.ok)(!0):(0,d.z)("An unknown error occured")},P=t=>async e=>{const n=(0,r.w)(p.baseUrl,"comment",e,"highlight")+x(f),o=(0,a.Kv)(t),s=await u(n,{method:"POST",headers:m({"Content-Type":"application/x-www-form-urlencoded"},p.headers,o.headers),credentials:o.credentials});return"error"===s.kind?s:(0,i.xLC)(c.MR,s.value).success?(0,d.ok)(!0):(0,d.z)("ParsingError")},O=t=>async e=>{const n=(0,r.w)(p.baseUrl,"comment",e,"unhighlight")+x(f),o=(0,a.Kv)(t),s=await u(n,{method:"POST",headers:m({"Content-Type":"application/x-www-form-urlencoded"},p.headers,o.headers),credentials:o.credentials});return"error"===s.kind?s:(0,i.xLC)(c.MR,s.value).success?(0,d.ok)(!1):(0,d.z)("ParsingError")},M=async t=>{const e=(0,r.w)(p.baseUrl,"comment",t)+x(m({},f,{displayThreaded:!0,displayResponses:!0})),n=await u(e,{headers:m({},p.headers)});return"error"===n.kind?n:(0,c.L6)(n.value)},S=async(t,e,n)=>{const o=(0,r.w)(t,"comment",e,"context"),s=(t=>new URLSearchParams({orderBy:"recommendations"===t.orderBy?"mostRecommended":t.orderBy,pageSize:String(t.pageSize),displayThreaded:String("collapsed"===t.threads||"expanded"===t.threads)}))(n),a=await u(o+"?"+s.toString());if("error"===a.kind)return a;const l=(0,i.xLC)(c.pl,a.value);return l.success?(0,d.ok)(l.output):(0,d.z)("ParsingError")}},40264:(t,e,n)=>{n.d(e,{ok:()=>r,z:()=>o});const r=t=>({kind:"ok",value:t}),o=t=>({kind:"error",error:t})}}]);
//# sourceMappingURL=3769.client.web.fb68709e0b1e2589ca79.js.map