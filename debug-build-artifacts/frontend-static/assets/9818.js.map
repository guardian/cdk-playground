{"version":3,"file":"9818.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/components/marketing/hooks/useEscapeShortcut.ts","webpack://@guardian/dotcom-rendering/./src/components/marketing/banners/utils/localStorage.ts","webpack://@guardian/dotcom-rendering/./src/components/marketing/banners/utils/withCloseable.tsx","webpack://@guardian/dotcom-rendering/./src/components/marketing/banners/common/BannerWrapper.tsx","webpack://@guardian/dotcom-rendering/./src/components/marketing/lib/articleCountOptOut.ts","webpack://@guardian/dotcom-rendering/./src/components/marketing/shared/ArticleCountOptOutOverlay.tsx","webpack://@guardian/dotcom-rendering/./src/components/marketing/shared/ArticleCountOptOutPopup.tsx","webpack://@guardian/dotcom-rendering/./src/components/marketing/lib/replaceArticleCount.tsx"],"sourcesContent":["/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/0a2439b701586a7a2cc60dce10b4d96cf7a828db/packages/modules/src/hooks/useEscapeShortcut.ts\n */\nimport { useEffect } from 'react';\n\n// Pass a function to run when the user hits the escape key\n// Useful for enabling a keyboard shortcut for dismissing banners\nexport function useEscapeShortcut(\n\teventHandler: (event: KeyboardEvent) => void,\n): void {\n\tuseEffect(() => {\n\t\tfunction handleEscapeKeydown(event: KeyboardEvent) {\n\t\t\t// IE key name is 'Esc', because IE\n\t\t\tconst isEscapeKey = event.key === 'Escape' || event.key === 'Esc';\n\t\t\tif (isEscapeKey) {\n\t\t\t\teventHandler(event);\n\t\t\t}\n\t\t}\n\n\t\twindow.addEventListener('keydown', handleEscapeKeydown);\n\n\t\treturn () => window.removeEventListener('keydown', handleEscapeKeydown);\n\t}, [eventHandler]);\n}\n","/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/0a2439b701586a7a2cc60dce10b4d96cf7a828db/packages/modules/src/modules/banners/localStorage.ts\n */\nimport { storage } from '@guardian/libs';\nimport type { BannerChannel } from '@guardian/support-dotcom-components/dist/shared/types';\n\ntype BannerLastClosedAt =\n\t| 'engagementBannerLastClosedAt'\n\t| 'subscriptionBannerLastClosedAt'\n\t| 'signInBannerLastClosedAt'\n\t| 'abandonedBasketLastClosedAt';\n\nconst setBannerClosedTimestamp = (name: BannerLastClosedAt): void =>\n\tstorage.local.set(`gu.prefs.${name}`, new Date().toISOString());\n\nconst bannerChannelToLastClosedMap = {\n\tcontributions: 'engagementBannerLastClosedAt',\n\tsubscriptions: 'subscriptionBannerLastClosedAt',\n\tsignIn: 'signInBannerLastClosedAt',\n\tabandonedBasket: 'abandonedBasketLastClosedAt',\n} as const satisfies Record<BannerChannel, BannerLastClosedAt>;\n\nexport const setChannelClosedTimestamp = (channel: BannerChannel): void => {\n\tsetBannerClosedTimestamp(bannerChannelToLastClosedMap[channel]);\n};\n","/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/0a2439b701586a7a2cc60dce10b4d96cf7a828db/packages/modules/src/modules/banners/hocs/withCloseable.tsx\n */\nimport type { BannerProps } from '@guardian/support-dotcom-components/dist/shared/types';\nimport { useState } from 'react';\nimport { useEscapeShortcut } from '../../hooks/useEscapeShortcut';\nimport type { ReactComponent } from '../../lib/ReactComponent';\nimport { setChannelClosedTimestamp } from './localStorage';\n\nexport interface CloseableBannerProps extends BannerProps {\n\tonClose: () => void;\n}\n\nconst withCloseable = (\n\tCloseableBanner: ReactComponent<CloseableBannerProps>,\n): ReactComponent<BannerProps> => {\n\tconst Banner: ReactComponent<BannerProps> = (bannerProps: BannerProps) => {\n\t\tconst [isOpen, setIsOpen] = useState(true);\n\n\t\tconst onClose = (): void => {\n\t\t\tsetChannelClosedTimestamp(bannerProps.bannerChannel);\n\t\t\tsetIsOpen(false);\n\t\t\tdocument.body.focus();\n\t\t};\n\n\t\tuseEscapeShortcut(onClose);\n\n\t\treturn isOpen ? (\n\t\t\t<CloseableBanner onClose={onClose} {...bannerProps} />\n\t\t) : (\n\t\t\t<></>\n\t\t);\n\t};\n\treturn Banner;\n};\n\nexport { withCloseable };\n","/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/0a2439b701586a7a2cc60dce10b4d96cf7a828db/packages/modules/src/modules/banners/common/BannerWrapper.tsx\n */\nimport {\n\tbannerSchema,\n\tcontainsNonArticleCountPlaceholder,\n\tgetReminderFields,\n\treplaceNonArticleCountPlaceholders,\n\tSecondaryCtaType,\n} from '@guardian/support-dotcom-components';\nimport type {\n\tBannerContent,\n\tBannerProps,\n\tCta,\n\tSecondaryCta,\n} from '@guardian/support-dotcom-components/dist/shared/types';\nimport { useEffect } from 'react';\nimport { useIsInView } from '../../../../lib/useIsInView';\nimport type { ReactComponent } from '../../lib/ReactComponent';\nimport { replaceArticleCount } from '../../lib/replaceArticleCount';\nimport {\n\taddAbandonedBasketAndTrackingParamsToUrl,\n\taddRegionIdAndTrackingParamsToSupportUrl,\n\taddTrackingParamsToProfileUrl,\n\tcreateClickEventFromTracking,\n\tcreateInsertEventFromTracking,\n\tcreateViewEventFromTracking,\n\tisProfileUrl,\n} from '../../lib/tracking';\nimport type { CloseableBannerProps } from '../utils/withCloseable';\nimport { withCloseable } from '../utils/withCloseable';\nimport type {\n\tBannerEnrichedCta,\n\tBannerEnrichedSecondaryCta,\n\tBannerId,\n\tBannerRenderedContent,\n\tBannerRenderProps,\n} from './types';\n\nfunction getComponentIds(bannerId: BannerId) {\n\treturn {\n\t\tclose: `${bannerId} : close`,\n\t\tcta: `${bannerId} : cta`,\n\t\tsecondaryCta: `${bannerId} : secondary-cta`,\n\t\tnotNow: `${bannerId} : not now`,\n\t\tsignIn: `${bannerId} : sign in`,\n\t\treminderCta: `${bannerId} : reminder-cta`,\n\t\treminderSet: `${bannerId} : reminder-set`,\n\t\treminderClose: `${bannerId} : reminder-close`,\n\t};\n}\n\nexport const getParagraphsOrMessageText = (\n\tparas: string[] | undefined,\n\ttext: string | undefined,\n): string[] => {\n\tconst bodyCopy = [];\n\n\tif (paras != null) {\n\t\tbodyCopy.push(...paras);\n\t} else if (text != null) {\n\t\tbodyCopy.push(text);\n\t}\n\treturn bodyCopy;\n};\n\nconst withBannerData =\n\t(\n\t\tBanner: ReactComponent<BannerRenderProps>,\n\t\tbannerId: BannerId,\n\t): ReactComponent<CloseableBannerProps> =>\n\t(bannerProps) => {\n\t\tconst {\n\t\t\ttracking,\n\t\t\tsubmitComponentEvent,\n\t\t\tonClose,\n\t\t\tcontent,\n\t\t\tmobileContent,\n\t\t\tcountryCode,\n\t\t\tprices,\n\t\t\tfetchEmail,\n\t\t\tarticleCounts,\n\t\t\ttickerSettings,\n\t\t\tisSupporter,\n\t\t\tseparateArticleCount,\n\t\t\tseparateArticleCountSettings,\n\t\t\tchoiceCardAmounts,\n\t\t\tdesign,\n\t\t\tbannerChannel,\n\t\t\tabandonedBasket,\n\t\t} = bannerProps;\n\n\t\tconst [hasBeenSeen, setNode] = useIsInView({\n\t\t\tdebounce: true,\n\t\t\tthreshold: 0,\n\t\t});\n\n\t\tuseEffect(() => {\n\t\t\tif (hasBeenSeen && submitComponentEvent) {\n\t\t\t\tsubmitComponentEvent(\n\t\t\t\t\tcreateViewEventFromTracking(\n\t\t\t\t\t\ttracking,\n\t\t\t\t\t\ttracking.campaignCode,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t}, [hasBeenSeen, submitComponentEvent, tracking]);\n\n\t\tuseEffect(() => {\n\t\t\tif (submitComponentEvent) {\n\t\t\t\tsubmitComponentEvent(\n\t\t\t\t\tcreateInsertEventFromTracking(\n\t\t\t\t\t\ttracking,\n\t\t\t\t\t\ttracking.campaignCode,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t}, [submitComponentEvent, tracking]);\n\n\t\tconst numArticles = articleCounts.forTargetedWeeks;\n\n\t\tconst cleanParagraphsOrMessageText = (\n\t\t\tparas: string[] | undefined,\n\t\t\ttext: string | undefined,\n\t\t): string[] => {\n\t\t\tconst originalCopy = getParagraphsOrMessageText(paras, text);\n\n\t\t\treturn originalCopy.map((p) =>\n\t\t\t\treplaceNonArticleCountPlaceholders(\n\t\t\t\t\tp,\n\t\t\t\t\tcountryCode,\n\t\t\t\t\tprices,\n\t\t\t\t).trim(),\n\t\t\t);\n\t\t};\n\n\t\tconst finaliseParagraphs = (\n\t\t\tparas: string[],\n\t\t): (Array<JSX.Element> | JSX.Element)[] => {\n\t\t\treturn paras.map((p) =>\n\t\t\t\treplaceArticleCount(p, numArticles, 'banner'),\n\t\t\t);\n\t\t};\n\n\t\tconst paragraphsContainNonArticleCountPlaceholder = (\n\t\t\tparas: string[],\n\t\t): boolean => paras.some((p) => containsNonArticleCountPlaceholder(p));\n\n\t\tconst componentIds = getComponentIds(bannerId);\n\n\t\t// For safety, this function throws if not all placeholders are replaced\n\t\tconst buildRenderedContent = (\n\t\t\tbannerContent: BannerContent,\n\t\t): BannerRenderedContent => {\n\t\t\tconst buildEnrichedCta = (cta: Cta): BannerEnrichedCta => {\n\t\t\t\tif (isProfileUrl(cta.baseUrl)) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tctaUrl: addTrackingParamsToProfileUrl(\n\t\t\t\t\t\t\tcta.baseUrl,\n\t\t\t\t\t\t\ttracking,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tctaText: cta.text,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (bannerChannel === 'abandonedBasket' && abandonedBasket) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tctaUrl: addAbandonedBasketAndTrackingParamsToUrl(\n\t\t\t\t\t\t\tcta.baseUrl,\n\t\t\t\t\t\t\tabandonedBasket,\n\t\t\t\t\t\t\ttracking,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tctaText: cta.text,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tctaUrl: addRegionIdAndTrackingParamsToSupportUrl(\n\t\t\t\t\t\tcta.baseUrl,\n\t\t\t\t\t\ttracking,\n\t\t\t\t\t\tnumArticles,\n\t\t\t\t\t\tcountryCode,\n\t\t\t\t\t),\n\t\t\t\t\tctaText: cta.text,\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tconst buildEnrichedSecondaryCta = (\n\t\t\t\tsecondaryCta: SecondaryCta,\n\t\t\t): BannerEnrichedSecondaryCta => {\n\t\t\t\tif (secondaryCta.type === SecondaryCtaType.Custom) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttype: SecondaryCtaType.Custom,\n\t\t\t\t\t\tcta: buildEnrichedCta(secondaryCta.cta),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: SecondaryCtaType.ContributionsReminder,\n\t\t\t\t\treminderFields: getReminderFields(countryCode),\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tconst primaryCta = bannerContent.cta\n\t\t\t\t? buildEnrichedCta(bannerContent.cta)\n\t\t\t\t: null;\n\t\t\tconst secondaryCta = bannerContent.secondaryCta\n\t\t\t\t? buildEnrichedSecondaryCta(bannerContent.secondaryCta)\n\t\t\t\t: null;\n\n\t\t\tconst cleanHighlightedText =\n\t\t\t\tbannerContent.highlightedText &&\n\t\t\t\treplaceNonArticleCountPlaceholders(\n\t\t\t\t\tbannerContent.highlightedText,\n\t\t\t\t\tcountryCode,\n\t\t\t\t\tprices,\n\t\t\t\t).trim();\n\n\t\t\tconst cleanHeading = replaceNonArticleCountPlaceholders(\n\t\t\t\tbannerContent.heading,\n\t\t\t\tcountryCode,\n\t\t\t\tprices,\n\t\t\t).trim();\n\n\t\t\tconst cleanParagraphs = cleanParagraphsOrMessageText(\n\t\t\t\tbannerContent.paragraphs,\n\t\t\t\tbannerContent.messageText,\n\t\t\t);\n\n\t\t\tconst copyHasPlaceholder =\n\t\t\t\tparagraphsContainNonArticleCountPlaceholder(cleanParagraphs) ||\n\t\t\t\t(!!cleanHighlightedText &&\n\t\t\t\t\tcontainsNonArticleCountPlaceholder(cleanHighlightedText)) ||\n\t\t\t\t(!!cleanHeading &&\n\t\t\t\t\tcontainsNonArticleCountPlaceholder(cleanHeading));\n\n\t\t\tconst headingWithArticleCount = cleanHeading\n\t\t\t\t? replaceArticleCount(cleanHeading, numArticles, 'banner')\n\t\t\t\t: null;\n\n\t\t\tconst highlightedTextWithArticleCount = cleanHighlightedText\n\t\t\t\t? replaceArticleCount(\n\t\t\t\t\t\tcleanHighlightedText,\n\t\t\t\t\t\tnumArticles,\n\t\t\t\t\t\t'banner',\n\t\t\t\t  )\n\t\t\t\t: null;\n\n\t\t\tif (copyHasPlaceholder) {\n\t\t\t\tthrow Error('Banner copy contains placeholders, abandoning.');\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\thighlightedText: highlightedTextWithArticleCount,\n\t\t\t\tparagraphs: finaliseParagraphs(cleanParagraphs),\n\t\t\t\theading: headingWithArticleCount,\n\t\t\t\tprimaryCta,\n\t\t\t\tsecondaryCta,\n\t\t\t};\n\t\t};\n\n\t\tconst clickHandlerFor = (componentId: string, close: boolean) => {\n\t\t\treturn (): void => {\n\t\t\t\tconst componentClickEvent = createClickEventFromTracking(\n\t\t\t\t\ttracking,\n\t\t\t\t\tcomponentId,\n\t\t\t\t);\n\t\t\t\tif (submitComponentEvent) {\n\t\t\t\t\tsubmitComponentEvent(componentClickEvent);\n\t\t\t\t}\n\t\t\t\tif (close) {\n\t\t\t\t\tonClose();\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\n\t\tconst onCtaClick = clickHandlerFor(componentIds.cta, true);\n\t\tconst onSecondaryCtaClick = clickHandlerFor(\n\t\t\tcomponentIds.secondaryCta,\n\t\t\ttrue,\n\t\t);\n\t\tconst onReminderCtaClick = clickHandlerFor(\n\t\t\tcomponentIds.reminderCta,\n\t\t\tfalse,\n\t\t);\n\t\tconst onReminderSetClick = clickHandlerFor(\n\t\t\tcomponentIds.reminderSet,\n\t\t\tfalse,\n\t\t);\n\t\tconst onReminderCloseClick = clickHandlerFor(\n\t\t\tcomponentIds.reminderClose,\n\t\t\tfalse,\n\t\t);\n\t\tconst onCloseClick = clickHandlerFor(componentIds.close, true);\n\t\tconst onNotNowClick = clickHandlerFor(componentIds.notNow, true);\n\t\tconst onSignInClick = clickHandlerFor(componentIds.signIn, false);\n\n\t\ttry {\n\t\t\tconst renderedContent = content && buildRenderedContent(content);\n\t\t\tconst renderedMobileContent =\n\t\t\t\tmobileContent && buildRenderedContent(mobileContent);\n\n\t\t\tif (renderedContent) {\n\t\t\t\tconst props: BannerRenderProps = {\n\t\t\t\t\tonCtaClick,\n\t\t\t\t\tonSecondaryCtaClick,\n\t\t\t\t\treminderTracking: {\n\t\t\t\t\t\tonReminderCtaClick,\n\t\t\t\t\t\tonReminderSetClick,\n\t\t\t\t\t\tonReminderCloseClick,\n\t\t\t\t\t},\n\t\t\t\t\tonCloseClick,\n\t\t\t\t\tonSignInClick,\n\t\t\t\t\tonNotNowClick,\n\t\t\t\t\tcontent: {\n\t\t\t\t\t\tmainContent: renderedContent,\n\t\t\t\t\t\tmobileContent: renderedMobileContent ?? renderedContent,\n\t\t\t\t\t},\n\t\t\t\t\tcountryCode,\n\t\t\t\t\tfetchEmail,\n\t\t\t\t\ttickerSettings,\n\t\t\t\t\tisSupporter,\n\t\t\t\t\tarticleCounts,\n\t\t\t\t\tseparateArticleCount,\n\t\t\t\t\tseparateArticleCountSettings,\n\t\t\t\t\tchoiceCardAmounts,\n\t\t\t\t\ttracking,\n\t\t\t\t\tsubmitComponentEvent,\n\t\t\t\t\tdesign,\n\t\t\t\t};\n\n\t\t\t\treturn (\n\t\t\t\t\t<div ref={setNode}>\n\t\t\t\t\t\t<Banner {...props} />\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.log(err);\n\t\t}\n\n\t\treturn <></>;\n\t};\n\nexport const bannerWrapper = (\n\tBanner: ReactComponent<BannerRenderProps>,\n\tbannerId: BannerId,\n): ReactComponent<BannerProps> =>\n\twithCloseable(withBannerData(Banner, bannerId));\n\nconst validate = (props: unknown): props is BannerProps => {\n\tconst result = bannerSchema.safeParse(props);\n\treturn result.success;\n};\n\nexport const validatedBannerWrapper = (\n\tBanner: ReactComponent<BannerRenderProps>,\n\tbannerId: BannerId,\n): ReactComponent<BannerProps> => {\n\treturn (props: BannerProps) => {\n\t\tif (validate(props)) {\n\t\t\tconst Module = bannerWrapper(Banner, bannerId);\n\t\t\treturn <Module {...props} />;\n\t\t}\n\t\treturn <></>;\n\t};\n};\n","/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/9c3eae7cb0b159db4a1c40679d6b37710b0bb937/packages/modules/src/modules/shared/helpers/articleCountOptOut.ts\n */\nimport { getCookie, removeCookie, setCookie, storage } from '@guardian/libs';\n\nconst ARTICLE_COUNT_OPT_OUT_COOKIE = {\n\tname: 'gu_article_count_opt_out',\n\tdaysToLive: 90,\n};\n\nconst DAILY_ARTICLE_COUNT_STORAGE_KEY = 'gu.history.dailyArticleCount';\nconst WEEKLY_ARTICLE_COUNT_STORAGE_KEY = 'gu.history.weeklyArticleCount';\nconst ARTICLES_THIS_WEEK_STORAGE_KEY = 'gu.history.articleCountsThisWeek';\n\nexport const addArticleCountOptOutCookie = (): void =>\n\tsetCookie({\n\t\tname: ARTICLE_COUNT_OPT_OUT_COOKIE.name,\n\t\tvalue: new Date().getTime().toString(),\n\t\tdaysToLive: ARTICLE_COUNT_OPT_OUT_COOKIE.daysToLive,\n\t});\n\nexport const removeArticleCountOptOutCookie = (): void =>\n\tremoveCookie({ name: ARTICLE_COUNT_OPT_OUT_COOKIE.name });\n\nexport const removeArticleCountFromLocalStorage = (): void => {\n\tstorage.local.remove(DAILY_ARTICLE_COUNT_STORAGE_KEY);\n\tstorage.local.remove(WEEKLY_ARTICLE_COUNT_STORAGE_KEY);\n\tstorage.local.remove(ARTICLES_THIS_WEEK_STORAGE_KEY);\n};\n\nexport const hasArticleCountOptOutCookie = (): boolean =>\n\t!!getCookie({ name: ARTICLE_COUNT_OPT_OUT_COOKIE.name });\n","/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/9c3eae7cb0b159db4a1c40679d6b37710b0bb937/packages/modules/src/modules/shared/ArticleCountOptOutOverlay.tsx\n */\nimport type { SerializedStyles } from '@emotion/react';\nimport { css, ThemeProvider } from '@emotion/react';\nimport {\n\tbackground,\n\tbrandAltBackground,\n\tbrandAltLine,\n\tbrandAltText,\n\tfrom,\n\tpalette,\n\tspace,\n\ttextSans14,\n\ttextSans17,\n} from '@guardian/source/foundations';\nimport {\n\tButton,\n\tbuttonThemeBrand,\n\tbuttonThemeBrandAlt,\n\tbuttonThemeDefault,\n\tSvgCross,\n} from '@guardian/source/react-components';\nimport type { ReactComponent } from '../lib/ReactComponent';\nimport type { ArticleCountOptOutType } from './ArticleCountOptOutPopup';\n\nconst { brand, neutral } = palette;\n\nconst COLOURS = {\n\tepic: 'white',\n\tbanner: brandAltText.primary,\n\t['investigations-moment-banner']: neutral[0],\n\t['us-eoy-moment-banner']: neutral[0],\n\t['global-new-year-moment-banner']: neutral[0],\n\t['election-au-moment-banner']: neutral[0],\n};\n\nconst BACKGROUND_COLOURS = {\n\tepic: brand[400],\n\tbanner: brandAltBackground.primary,\n\t['investigations-moment-banner']: neutral[100],\n\t['us-eoy-moment-banner']: '#FFEEDB',\n\t['global-new-year-moment-banner']: '#F79E1B',\n\t['election-au-moment-banner']: '#e4e4e3',\n};\n\nconst BORDER_COLOURS = {\n\tepic: 'transparent',\n\tbanner: brandAltLine.primary,\n\t['investigations-moment-banner']: neutral[0],\n\t['us-eoy-moment-banner']: neutral[0],\n\t['global-new-year-moment-banner']: neutral[0],\n\t['election-au-moment-banner']: neutral[0],\n};\n\nconst BUTTON_THEMES = {\n\tepic: buttonThemeBrand,\n\tbanner: buttonThemeBrandAlt,\n\t['investigations-moment-banner']: buttonThemeDefault,\n\t['us-eoy-moment-banner']: buttonThemeDefault,\n\t['global-new-year-moment-banner']: buttonThemeDefault,\n\t['election-au-moment-banner']: buttonThemeDefault,\n};\n\nconst overlayContainer = (\n\ttype: ArticleCountOptOutType,\n): SerializedStyles => css`\n\tcolor: ${COLOURS[type]};\n\tbackground: ${BACKGROUND_COLOURS[type]};\n\tborder: 1px solid ${BORDER_COLOURS[type]};\n\t${textSans17}\n\tpadding: ${space[2]}px;\n\tbox-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);\n`;\n\nconst overlayHeader = css`\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n`;\n\nconst overlayHeaderText = css`\n\tfont-size: 17px;\n\tfont-weight: bold;\n`;\n\nconst overlayBody = css`\n\tmargin-top: ${space[1]}px;\n\tfont-size: 15px;\n`;\n\nconst overlayCtaContainer = css`\n\tmargin-top: ${space[3]}px;\n\tdisplay: flex;\n\tflex-direction: row;\n\n\t> * + * {\n\t\tmargin-left: ${space[2]}px;\n\t}\n\n\t${from.tablet} {\n\t\t> * + * {\n\t\t\tmargin-left: ${space[3]}px;\n\t\t}\n\t}\n`;\n\nconst NOTE_LINK_COLOURS = {\n\tepic: neutral[100],\n\tbanner: brandAltText.primary,\n\t['investigations-moment-banner']: neutral[0],\n\t['us-eoy-moment-banner']: neutral[0],\n\t['global-new-year-moment-banner']: neutral[0],\n\t['election-au-moment-banner']: neutral[0],\n};\n\nconst BUTTON_OVERRIDES = {\n\tepic: css``,\n\tbanner: css``,\n\t['investigations-moment-banner']: css`\n\t\tbackground-color: ${palette.neutral[100]};\n\t\tcolor: ${palette.neutral[0]};\n\t\tborder: 1px solid ${palette.neutral[0]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${palette.neutral[86]};\n\t\t}\n\t`,\n\t['us-eoy-moment-banner']: css`\n\t\tcolor: ${palette.neutral[7]};\n\t\tborder: 1px solid ${palette.neutral[7]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${palette.culture[350]};\n\t\t\tcolor: ${palette.neutral[100]};\n\t\t\tborder: 1px solid ${palette.culture[350]};\n\t\t}\n\t`,\n\t['global-new-year-moment-banner']: css`\n\t\tcolor: ${palette.neutral[7]};\n\t\tborder: 1px solid ${palette.neutral[7]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${palette.brand[500]};\n\t\t\tcolor: ${palette.neutral[100]};\n\t\t\tborder: 1px solid ${palette.brand[500]};\n\t\t}\n\t`,\n\t['election-au-moment-banner']: css`\n\t\tcolor: ${palette.neutral[7]};\n\t\tborder: 1px solid ${palette.neutral[7]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${palette.brand[500]};\n\t\t\tcolor: ${palette.neutral[100]};\n\t\t\tborder: 1px solid ${palette.brand[500]};\n\t\t}\n\t`,\n};\n\nconst PRIMARY_BUTTON_OVERRIDES = {\n\tepic: css``,\n\tbanner: css``,\n\t['investigations-moment-banner']: css`\n\t\tbackground-color: ${palette.neutral[0]};\n\t\tcolor: ${palette.neutral[100]};\n\t\tborder: 1px solid ${palette.neutral[0]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${palette.neutral[46]};\n\t\t\tborder-color: ${palette.neutral[46]};\n\t\t}\n\t`,\n\t['us-eoy-moment-banner']: css`\n\t\tbackground-color: ${palette.neutral[7]};\n\t\tcolor: ${palette.neutral[100]};\n\t\tborder: 1px solid ${palette.neutral[7]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${palette.culture[350]};\n\t\t\tcolor: ${palette.neutral[100]};\n\t\t\tborder: 1px solid ${palette.culture[350]};\n\t\t}\n\t`,\n\t['global-new-year-moment-banner']: css`\n\t\tbackground-color: ${palette.neutral[0]};\n\t\tcolor: ${palette.neutral[100]};\n\t\tborder: 1px solid ${palette.neutral[0]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${palette.brand[500]};\n\t\t\tcolor: ${palette.neutral[100]};\n\t\t\tborder: 1px solid ${palette.brand[500]};\n\t\t}\n\t`,\n\t['election-au-moment-banner']: css`\n\t\tbackground-color: ${palette.neutral[0]};\n\t\tcolor: ${palette.neutral[100]};\n\t\tborder: 1px solid ${palette.neutral[0]};\n\n\t\t&:hover {\n\t\t\tbackground-color: ${background.ctaPrimaryHover};\n\t\t\tcolor: ${palette.neutral[100]};\n\t\t\tborder: 1px solid ${background.ctaPrimaryHover};\n\t\t}\n\t`,\n};\n\nconst overlayNote = (type: ArticleCountOptOutType): SerializedStyles => css`\n\tmargin-top: ${space[2]}px;\n\t${textSans14}\n\tfont-style: italic;\n\n\ta {\n\t\t/* stylelint-disable-next-line declaration-no-important */\n\t\tcolor: ${NOTE_LINK_COLOURS[type]} !important;\n\t\t/* stylelint-disable-next-line declaration-no-important */\n\t\ttext-decoration: underline !important;\n\t}\n`;\n\nexport interface ArticleCountOptOutOverlayProps {\n\ttype: ArticleCountOptOutType;\n\thasOptedOut: boolean;\n\tonOptOut: () => void;\n\tonClose: () => void;\n}\n\nexport const ArticleCountOptOutOverlay: ReactComponent<\n\tArticleCountOptOutOverlayProps\n> = ({\n\ttype,\n\thasOptedOut,\n\tonClose,\n\tonOptOut,\n}: ArticleCountOptOutOverlayProps) => {\n\treturn (\n\t\t<div css={overlayContainer(type)}>\n\t\t\t<div css={overlayHeader}>\n\t\t\t\t<div css={overlayHeaderText}>\n\t\t\t\t\t{hasOptedOut ? \"You've opted out\" : \"What's this?\"}\n\t\t\t\t</div>\n\t\t\t\t<ThemeProvider theme={BUTTON_THEMES[type]}>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tcssOverrides={BUTTON_OVERRIDES[type]}\n\t\t\t\t\t\ticon={<SvgCross />}\n\t\t\t\t\t\thideLabel={true}\n\t\t\t\t\t\tsize=\"xsmall\"\n\t\t\t\t\t\tpriority=\"tertiary\"\n\t\t\t\t\t>\n\t\t\t\t\t\tClose\n\t\t\t\t\t</Button>\n\t\t\t\t</ThemeProvider>\n\t\t\t</div>\n\n\t\t\t<div css={overlayBody}>\n\t\t\t\t{hasOptedOut\n\t\t\t\t\t? \"Starting from your next page view, we won't count the articles you read or show you this message for three months.\"\n\t\t\t\t\t: 'We would like to remind you how many Guardian articles you’ve enjoyed on this device. Can we continue showing you this?'}\n\t\t\t</div>\n\n\t\t\t{!hasOptedOut && (\n\t\t\t\t<div css={overlayCtaContainer}>\n\t\t\t\t\t<ThemeProvider theme={BUTTON_THEMES[type]}>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tcssOverrides={PRIMARY_BUTTON_OVERRIDES[type]}\n\t\t\t\t\t\t\tpriority=\"primary\"\n\t\t\t\t\t\t\tsize=\"xsmall\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tYes, that&apos;s OK\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ThemeProvider>\n\t\t\t\t\t<ThemeProvider theme={BUTTON_THEMES[type]}>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={onOptOut}\n\t\t\t\t\t\t\tcssOverrides={BUTTON_OVERRIDES[type]}\n\t\t\t\t\t\t\tpriority=\"tertiary\"\n\t\t\t\t\t\t\tsize=\"xsmall\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tNo, opt me out\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ThemeProvider>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<div css={overlayNote(type)}>\n\t\t\t\t{hasOptedOut ? (\n\t\t\t\t\t<span>\n\t\t\t\t\t\tIf you have any questions, please{' '}\n\t\t\t\t\t\t<a href=\"https://www.theguardian.com/help/contact-us\">\n\t\t\t\t\t\t\tcontact us.\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>\n\t\t\t\t) : (\n\t\t\t\t\t\"Please note that opting out is a permanent action and can't be reversed\"\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/9c3eae7cb0b159db4a1c40679d6b37710b0bb937/packages/modules/src/modules/shared/ArticleCountOptOutPopup.tsx\n */\nimport type { SerializedStyles } from '@emotion/react';\nimport { css } from '@emotion/react';\nimport type { OphanComponentEvent, OphanComponentType } from '@guardian/libs';\nimport { from, space } from '@guardian/source/foundations';\nimport { useEffect, useState } from 'react';\nimport { useIsInView } from '../../../lib/useIsInView';\nimport {\n\taddArticleCountOptOutCookie,\n\tremoveArticleCountFromLocalStorage,\n} from '../lib/articleCountOptOut';\nimport type { ReactComponent } from '../lib/ReactComponent';\nimport { ArticleCountOptOutOverlay } from './ArticleCountOptOutOverlay';\n\nconst OPHAN_COMPONENT_ID_OPT_OUT_VIEW = 'article-count-opt-out-view';\nconst OPHAN_COMPONENT_ID_OPT_OUT_OPEN = 'article-count-opt-out-open';\nconst OPHAN_COMPONENT_ID_OPT_OUT_CLOSE = 'article-count-opt-out-close';\nconst OPHAN_COMPONENT_ID_OPT_OUT_CONFIRM = 'article-count-opt-out-confirm';\n\nexport const ophanComponentEventOptOutView = (\n\tcomponentType: OphanComponentType,\n): OphanComponentEvent => ({\n\tcomponent: {\n\t\tcomponentType: 'ACQUISITIONS_OTHER',\n\t\tid: OPHAN_COMPONENT_ID_OPT_OUT_VIEW,\n\t},\n\taction: 'VIEW',\n\tvalue: `article-count-opt-out-popup-${componentType}`,\n});\n\nexport const ophanComponentEventOptOutOpen = (\n\tcomponentType: OphanComponentType,\n): OphanComponentEvent => ({\n\tcomponent: {\n\t\tcomponentType: 'ACQUISITIONS_OTHER',\n\t\tid: OPHAN_COMPONENT_ID_OPT_OUT_OPEN,\n\t},\n\taction: 'CLICK',\n\tvalue: `article-count-opt-out-popup-${componentType}`,\n});\n\nexport const ophanComponentEventOptOutClose = (\n\tcomponentType: OphanComponentType,\n): OphanComponentEvent => ({\n\tcomponent: {\n\t\tcomponentType: 'ACQUISITIONS_OTHER',\n\t\tid: OPHAN_COMPONENT_ID_OPT_OUT_CLOSE,\n\t},\n\taction: 'CLICK',\n\tvalue: `article-count-opt-out-popup-${componentType}`,\n});\n\nexport const ophanComponentEventOptOutConfirm = (\n\tcomponentType: OphanComponentType,\n): OphanComponentEvent => ({\n\tcomponent: {\n\t\tcomponentType: 'ACQUISITIONS_OTHER',\n\t\tid: OPHAN_COMPONENT_ID_OPT_OUT_CONFIRM,\n\t},\n\taction: 'CLICK',\n\tvalue: `article-count-opt-out-popup-${componentType}`,\n});\n\nexport type ArticleCountOptOutType =\n\t| 'epic'\n\t| 'banner'\n\t| 'investigations-moment-banner'\n\t| 'us-eoy-moment-banner'\n\t| 'global-new-year-moment-banner'\n\t| 'election-au-moment-banner';\nconst isBanner = (type: ArticleCountOptOutType): boolean =>\n\ttype === 'banner' ||\n\ttype === 'investigations-moment-banner' ||\n\ttype === 'us-eoy-moment-banner' ||\n\ttype === 'global-new-year-moment-banner' ||\n\ttype === 'election-au-moment-banner';\n\nconst optOutContainer = (type: ArticleCountOptOutType): SerializedStyles => css`\n\tdisplay: inline-block;\n\n\t${from.tablet} {\n\t\t${!isBanner(type) ? 'position: relative;' : ''}\n\t}\n`;\n\nconst articleCountButton = css`\n\tbackground: none;\n\tborder: none;\n\tpadding: 0;\n\tcursor: pointer;\n\tborder-bottom: 1px solid;\n\t/* stylelint-disable-next-line property-disallowed-list */\n\tfont-family: inherit;\n\tfont-size: inherit;\n\tfont-weight: inherit;\n\tfont-style: inherit;\n\tcolor: inherit;\n\t&:focus {\n\t\t/* stylelint-disable-next-line declaration-no-important */\n\t\toutline: none !important;\n\t}\n`;\n\nconst overlayContainer = (\n\ttype: ArticleCountOptOutType,\n): SerializedStyles => css`\n\tposition: absolute;\n\tz-index: 100;\n\t${isBanner(type)\n\t\t? css`\n\t\t\t\ttop: 0px;\n\t\t\t\tleft: 0px;\n\t\t  `\n\t\t: css`\n\t\t\t\tleft: ${space[4]}px;\n\t\t\t\tright: ${space[4]}px;\n\t\t\t\t${isBanner(type) ? 'bottom: 21px;' : ''}\n\t\t  `}\n\tdisplay: block;\n\n\t${from.tablet} {\n\t\t${isBanner(type)\n\t\t\t? css`\n\t\t\t\t\ttop: 10px;\n\t\t\t\t\tleft: 10px;\n\t\t\t\t\twidth: 450px;\n\t\t\t  `\n\t\t\t: css`\n\t\t\t\t\twidth: 400px;\n\t\t\t\t\tleft: 0;\n\t\t\t  `}\n\t}\n`;\n\nexport interface OphanTracking {\n\tcomponentType: OphanComponentType;\n\tsubmitComponentEvent: (componentEvent: OphanComponentEvent) => void;\n}\n\nexport interface ArticleCountOptOutProps {\n\tnumArticles: number;\n\tnextWord: string | null;\n\ttype: ArticleCountOptOutType;\n\ttracking?: OphanTracking;\n}\n\nexport const ArticleCountOptOutPopup: ReactComponent<\n\tArticleCountOptOutProps\n> = ({ numArticles, nextWord, type, tracking }: ArticleCountOptOutProps) => {\n\tconst [isOpen, setIsOpen] = useState(false);\n\tconst [hasOptedOut, setHasOptedOut] = useState(false);\n\tconst [hasBeenSeen, setNode] = useIsInView({\n\t\tdebounce: true,\n\t\trootMargin: '-18px',\n\t\tthreshold: 0,\n\t});\n\n\tuseEffect(() => {\n\t\tif (hasBeenSeen && tracking) {\n\t\t\ttracking.submitComponentEvent(\n\t\t\t\tophanComponentEventOptOutView(tracking.componentType),\n\t\t\t);\n\t\t}\n\t}, [hasBeenSeen, tracking]);\n\n\tconst onOptOut = (): void => {\n\t\taddArticleCountOptOutCookie();\n\t\tremoveArticleCountFromLocalStorage();\n\t\tsetHasOptedOut(true);\n\t\tif (tracking) {\n\t\t\ttracking.submitComponentEvent(\n\t\t\t\tophanComponentEventOptOutConfirm(tracking.componentType),\n\t\t\t);\n\t\t}\n\t};\n\n\tconst onOpen = (): void => {\n\t\tsetIsOpen(true);\n\t\tif (tracking) {\n\t\t\ttracking.submitComponentEvent(\n\t\t\t\tophanComponentEventOptOutOpen(tracking.componentType),\n\t\t\t);\n\t\t}\n\t};\n\n\tconst onClose = (): void => {\n\t\tsetIsOpen(false);\n\t\tif (tracking) {\n\t\t\ttracking.submitComponentEvent(\n\t\t\t\tophanComponentEventOptOutClose(tracking.componentType),\n\t\t\t);\n\t\t}\n\t};\n\n\tconst onToggle = (): void => (isOpen ? onClose() : onOpen());\n\n\treturn (\n\t\t<div ref={setNode} css={optOutContainer(type)}>\n\t\t\t<button css={articleCountButton} onClick={onToggle}>\n\t\t\t\t{`${numArticles}${nextWord ? nextWord : ''}`}\n\t\t\t</button>\n\t\t\t{isOpen && (\n\t\t\t\t<div css={overlayContainer(type)}>\n\t\t\t\t\t<ArticleCountOptOutOverlay\n\t\t\t\t\t\ttype={type}\n\t\t\t\t\t\thasOptedOut={hasOptedOut}\n\t\t\t\t\t\tonOptOut={onOptOut}\n\t\t\t\t\t\tonClose={onClose}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n","/**\n * @file\n * This file was migrated from:\n * https://github.com/guardian/support-dotcom-components/blob/9c3eae7cb0b159db4a1c40679d6b37710b0bb937/packages/modules/src/lib/replaceArticleCount.tsx\n */\nimport type {\n\tArticleCountOptOutType,\n\tOphanTracking,\n} from '../shared/ArticleCountOptOutPopup';\nimport { ArticleCountOptOutPopup } from '../shared/ArticleCountOptOutPopup';\n\nexport const replaceArticleCountWithLink = (\n\ttext: string,\n\tnumArticles: number,\n\tarticleCountOptOutType: ArticleCountOptOutType,\n\ttracking?: OphanTracking,\n): Array<JSX.Element> => {\n\tconst nextWords: Array<string | null> = [];\n\tconst subbedText = text.replace(\n\t\t/%%ARTICLE_COUNT%%( \\w+)?/g,\n\t\t(_, nextWord) => {\n\t\t\tnextWords.push(nextWord);\n\t\t\treturn '%%ARTICLE_COUNT_AND_NEXT_WORD%%';\n\t\t},\n\t);\n\n\tconst parts = subbedText.split(/%%ARTICLE_COUNT_AND_NEXT_WORD%%/);\n\tconst elements = [];\n\tlet key = 0;\n\tfor (let i = 0; i < parts.length - 1; i += 1) {\n\t\telements.push(\n\t\t\t<span\n\t\t\t\tdangerouslySetInnerHTML={{ __html: parts[i] as string }}\n\t\t\t\tkey={key++}\n\t\t\t/>,\n\t\t);\n\t\telements.push(\n\t\t\t<ArticleCountOptOutPopup\n\t\t\t\tnumArticles={numArticles}\n\t\t\t\tnextWord={nextWords[i] as string}\n\t\t\t\ttype={articleCountOptOutType}\n\t\t\t\ttracking={tracking}\n\t\t\t\tkey={key++}\n\t\t\t/>,\n\t\t);\n\t}\n\telements.push(\n\t\t<span\n\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t__html: parts[parts.length - 1] as string,\n\t\t\t}}\n\t\t\tkey={key++}\n\t\t/>,\n\t);\n\n\treturn elements;\n};\n\nexport const replaceArticleCount = (\n\ttext: string,\n\tnumArticles: number,\n\tarticleCountOptOutType: ArticleCountOptOutType,\n\ttracking?: OphanTracking,\n\toptOutLink = true,\n): Array<JSX.Element> | JSX.Element => {\n\tif (optOutLink) {\n\t\treturn replaceArticleCountWithLink(\n\t\t\ttext,\n\t\t\tnumArticles,\n\t\t\tarticleCountOptOutType,\n\t\t\ttracking,\n\t\t);\n\t}\n\treturn (\n\t\t<span\n\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t__html: text.replace(/%%ARTICLE_COUNT%%/, `${numArticles}`),\n\t\t\t}}\n\t\t/>\n\t);\n};\n"],"names":["useEffect","useEscapeShortcut","eventHandler","handleEscapeKeydown","event","isEscapeKey","key","window","addEventListener","removeEventListener","storage","setBannerClosedTimestamp","name","local","set","Date","toISOString","bannerChannelToLastClosedMap","contributions","subscriptions","signIn","abandonedBasket","setChannelClosedTimestamp","channel","useState","withCloseable","CloseableBanner","Banner","bannerProps","isOpen","setIsOpen","onClose","bannerChannel","document","body","focus","bannerSchema","containsNonArticleCountPlaceholder","getReminderFields","replaceNonArticleCountPlaceholders","SecondaryCtaType","useIsInView","replaceArticleCount","addAbandonedBasketAndTrackingParamsToUrl","addRegionIdAndTrackingParamsToSupportUrl","addTrackingParamsToProfileUrl","createClickEventFromTracking","createInsertEventFromTracking","createViewEventFromTracking","isProfileUrl","getComponentIds","bannerId","close","cta","secondaryCta","notNow","reminderCta","reminderSet","reminderClose","getParagraphsOrMessageText","paras","text","bodyCopy","push","withBannerData","tracking","submitComponentEvent","content","mobileContent","countryCode","prices","fetchEmail","articleCounts","tickerSettings","isSupporter","separateArticleCount","separateArticleCountSettings","choiceCardAmounts","design","hasBeenSeen","setNode","debounce","threshold","campaignCode","numArticles","forTargetedWeeks","cleanParagraphsOrMessageText","originalCopy","map","p","trim","finaliseParagraphs","paragraphsContainNonArticleCountPlaceholder","some","componentIds","buildRenderedContent","bannerContent","buildEnrichedCta","baseUrl","ctaUrl","ctaText","buildEnrichedSecondaryCta","type","Custom","ContributionsReminder","reminderFields","primaryCta","cleanHighlightedText","highlightedText","cleanHeading","heading","cleanParagraphs","paragraphs","messageText","copyHasPlaceholder","headingWithArticleCount","highlightedTextWithArticleCount","Error","clickHandlerFor","componentId","componentClickEvent","onCtaClick","onSecondaryCtaClick","onReminderCtaClick","onReminderSetClick","onReminderCloseClick","onCloseClick","onNotNowClick","onSignInClick","renderedContent","renderedMobileContent","props","reminderTracking","mainContent","div","ref","err","console","log","bannerWrapper","validate","result","safeParse","success","validatedBannerWrapper","Module","getCookie","removeCookie","setCookie","ARTICLE_COUNT_OPT_OUT_COOKIE","daysToLive","DAILY_ARTICLE_COUNT_STORAGE_KEY","WEEKLY_ARTICLE_COUNT_STORAGE_KEY","ARTICLES_THIS_WEEK_STORAGE_KEY","addArticleCountOptOutCookie","value","getTime","toString","removeArticleCountOptOutCookie","removeArticleCountFromLocalStorage","remove","hasArticleCountOptOutCookie","css","ThemeProvider","background","brandAltBackground","brandAltLine","brandAltText","from","palette","space","textSans14","textSans17","Button","buttonThemeBrand","buttonThemeBrandAlt","buttonThemeDefault","SvgCross","brand","neutral","COLOURS","epic","banner","primary","BACKGROUND_COLOURS","BORDER_COLOURS","BUTTON_THEMES","overlayContainer","overlayHeader","overlayHeaderText","overlayBody","overlayCtaContainer","tablet","NOTE_LINK_COLOURS","BUTTON_OVERRIDES","culture","PRIMARY_BUTTON_OVERRIDES","ctaPrimaryHover","overlayNote","ArticleCountOptOutOverlay","hasOptedOut","onOptOut","theme","onClick","cssOverrides","icon","hideLabel","size","priority","span","a","href","OPHAN_COMPONENT_ID_OPT_OUT_VIEW","OPHAN_COMPONENT_ID_OPT_OUT_OPEN","OPHAN_COMPONENT_ID_OPT_OUT_CLOSE","OPHAN_COMPONENT_ID_OPT_OUT_CONFIRM","ophanComponentEventOptOutView","componentType","component","id","action","ophanComponentEventOptOutOpen","ophanComponentEventOptOutClose","ophanComponentEventOptOutConfirm","isBanner","optOutContainer","articleCountButton","ArticleCountOptOutPopup","nextWord","setHasOptedOut","rootMargin","onOpen","onToggle","button","replaceArticleCountWithLink","articleCountOptOutType","nextWords","subbedText","replace","_","parts","split","elements","i","length","dangerouslySetInnerHTML","__html","optOutLink"],"sourceRoot":""}