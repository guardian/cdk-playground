{"version":3,"file":"5676.client.web.legacy.faf55bd9c85324321e4f.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/lib/discussionFilters.ts","webpack://@guardian/dotcom-rendering/./src/components/DispatchContext.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/AbuseReportForm.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Avatar.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Badges.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Column.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Row.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/RecommendationCount.tsx","webpack://@guardian/dotcom-rendering/./src/lib/discussionDateFormatter.ts","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Timestamp.tsx","webpack://@guardian/dotcom-rendering/./src/lib/useInterval.ts","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Comment.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/PillarButton.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Preview.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/FirstCommentWelcome.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/CommentForm.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/CommentReplyPreview.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/CommentContainer.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Dropdown.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Filters.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/LoadingComments.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Pagination.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/TopPick.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/TopPicks.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion/Comments.tsx","webpack://@guardian/dotcom-rendering/./src/components/Discussion.tsx","webpack://@guardian/dotcom-rendering/./src/components/Hide.tsx","webpack://@guardian/dotcom-rendering/./src/lib/assert-unreachable.ts","webpack://@guardian/dotcom-rendering/./src/lib/discussion.ts","webpack://@guardian/dotcom-rendering/./src/lib/json.ts","webpack://@guardian/dotcom-rendering/./src/lib/discussionApi.tsx","webpack://@guardian/dotcom-rendering/./src/lib/result.ts"],"sourcesContent":["import { isOneOf, isString, storage } from '@guardian/libs';\nconst orderByTypes = ['newest', 'oldest', 'recommendations'];\nconst threadTypes = ['collapsed', 'expanded', 'unthreaded'];\nconst pageSizeTypes = [25, 50, 100];\nconst getOrderByType = (value) => isString(value) && isOneOf(orderByTypes)(value) ? value : 'newest';\nconst getThreadType = (value) => isString(value) && isOneOf(threadTypes)(value) ? value : 'collapsed';\nconst getPageSizeType = (value) => typeof value === 'number' && isOneOf(pageSizeTypes)(value) ? value : 25;\n/** Retrieves stored values from local storage if available, otherwise it returns defaults */\nexport const initFiltersFromLocalStorage = () => {\n    const orderBy = getOrderByType(storage.local.get('gu.prefs.discussion.order'));\n    const threads = getThreadType(storage.local.get('gu.prefs.discussion.threading'));\n    const pageSize = getPageSizeType(storage.local.get('gu.prefs.discussion.pagesize'));\n    return {\n        orderBy,\n        threads,\n        pageSize,\n    };\n};\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { debug } from '@guardian/libs';\nimport { createContext, useContext } from 'react';\nconst DispatchContext = createContext(() => {\n    debug('dotcom', `The 'dispatch' function in discussion is not defined! Did you remember to include a context provider for it?`);\n});\nexport const DispatchProvider = ({ value, children, }) => (_jsx(DispatchContext.Provider, { value: value, children: children }));\nexport const useDispatch = () => {\n    const context = useContext(DispatchContext);\n    return context;\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { log } from '@guardian/libs';\nimport { space, textSans12 } from '@guardian/source/foundations';\nimport { Button, InlineError, InlineSuccess, Option, Select, SvgCross, TextArea, TextInput, } from '@guardian/source/react-components';\nimport { useEffect, useRef, useState } from 'react';\nimport { palette as schemedPalette } from '../../palette';\nconst formWrapper = css `\n\tz-index: 1;\n\tborder: 1px solid ${schemedPalette('--discussion-border')};\n\tposition: absolute;\n\twidth: 300px;\n\ttop: 0;\n\tright: 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: ${space[3]}px;\n\tbackground-color: ${schemedPalette('--discussion-report-background')};\n\t${textSans12};\n`;\nconst labelColour = schemedPalette('--discussion-report-label-text');\nconst errorColour = schemedPalette('--discussion-report-error-text');\nconst buttonStyles = css `\n\tbackground-color: ${schemedPalette('--discussion-report-button')};\n`;\nconst errorBorderColour = css `\n\tselect,\n\tinput,\n\ttextarea {\n\t\tborder: 1px solid ${schemedPalette('--discussion-report-error-text')};\n\t}\n`;\nconst borderColour = css `\n\tselect,\n\tinput,\n\ttextarea {\n\t\tborder: 1px solid ${schemedPalette('--discussion-report-border')};\n\t}\n`;\nconst inputWrapper = css `\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin-bottom: ${space[2]}px;\n\n\tlabel {\n\t\tdisplay: block;\n\t}\n\n\tselect,\n\tinput,\n\ttextarea {\n\t\tbackground-color: ${schemedPalette('--discussion-report-background')};\n\t\tmin-height: ${space[5]}px;\n\t\twidth: 75%;\n\t\tcolor: inherit;\n\t}\n`;\nconst svgStyles = css `\n\tdiv {\n\t\tsvg {\n\t\t\tright: 80px;\n\t\t\tfill: ${labelColour};\n\t\t}\n\t}\n`;\nconst errorSvgStyles = css `\n\tspan[role='alert'] {\n\t\tsvg {\n\t\t\tfill: ${errorColour};\n\t\t}\n\t}\n`;\nexport const AbuseReportForm = ({ commentId, toggleSetShowForm, reportAbuse, }) => {\n    const modalRef = useRef(null);\n    // TODO: use ref once forwardRef is implemented @guardian/src-button\n    // We want to pull out the 1st and last elements of the form, and highlight the 1st element\n    let firstElement = null;\n    let lastElement = null;\n    useEffect(() => {\n        if (!modalRef.current)\n            return;\n        // eslint-disable-next-line react-hooks/exhaustive-deps -- https://github.com/guardian/discussion-rendering/pull/56 for where this was first introduced\n        firstElement = modalRef.current.querySelector('select[name=\"category\"]');\n        // eslint-disable-next-line react-hooks/exhaustive-deps -- https://github.com/guardian/discussion-rendering/pull/56 for where this was first introduced\n        lastElement = modalRef.current.querySelector('button[custom-guardian=\"close-modal\"]');\n    }, [modalRef]);\n    // We want to highlight the 1st element when the modal is open\n    useEffect(() => {\n        firstElement?.focus();\n    }, [firstElement]);\n    // We want to make sure to close the modal when a user clicks away from the modal\n    useEffect(() => {\n        const closeOnClickAway = (e) => {\n            if (modalRef.current &&\n                !modalRef.current.contains(e.target)) {\n                toggleSetShowForm();\n            }\n        };\n        document.addEventListener('mousedown', closeOnClickAway);\n    }, [modalRef, toggleSetShowForm]);\n    // We want to listen to keydown events for accessibility\n    useEffect(() => {\n        const keyListener = (e) => {\n            if (e.code === 'Escape') {\n                toggleSetShowForm();\n            }\n            else if (e.code === 'Tab') {\n                // If firstElement or lastElement are not defined, do not continue\n                if (!firstElement || !lastElement)\n                    return;\n                // we use `e.shiftKey` internally to determine the direction of the highlighting\n                // using document.activeElement and e.shiftKey we can check what should be the next element to be highlighted\n                if (!e.shiftKey && document.activeElement === lastElement) {\n                    firstElement.focus();\n                    e.preventDefault();\n                }\n                if (e.shiftKey && document.activeElement === firstElement) {\n                    lastElement.focus(); // The shift key is down so loop focus back to the last item\n                    e.preventDefault();\n                }\n            }\n        };\n        document.addEventListener('keydown', keyListener);\n        return () => document.removeEventListener('keydown', keyListener);\n    });\n    const [formVariables, setFormVariables] = useState({\n        categoryId: 0,\n        reason: '',\n        email: '',\n    });\n    const defaultErrorTexts = {\n        categoryId: '',\n        reason: '',\n        email: '',\n        response: '',\n    };\n    const [errors, setErrors] = useState(defaultErrorTexts);\n    const [successMessage, setSuccessMessage] = useState();\n    const onSubmit = (event) => {\n        event.preventDefault();\n        const { categoryId, reason, email } = formVariables;\n        // Reset error messages\n        setErrors(defaultErrorTexts);\n        // Error validation\n        if (!categoryId) {\n            setErrors({\n                ...errors,\n                categoryId: 'You must select a category before submitting',\n            });\n            return;\n        }\n        reportAbuse({\n            categoryId,\n            reason,\n            email,\n            commentId,\n        })\n            .then((response) => {\n            if (response.kind === 'error') {\n                // Fallback to errors returned from the API\n                setErrors({ ...errors, response: response.error });\n            }\n            else {\n                setSuccessMessage('Report submitted');\n            }\n        })\n            .catch(() => {\n            log('dotcom', 'Discussion: error reporting abuse');\n        });\n    };\n    /** If the \"Other\" or the \"Legal Issue\" categories are selected, you must supply a reason */\n    const legalIssueCategoryId = 3;\n    const otherCategoryId = 9;\n    const isReasonRequired = formVariables.categoryId === otherCategoryId ||\n        formVariables.categoryId === legalIssueCategoryId;\n    return (_jsx(\"div\", { \"aria-modal\": \"true\", ref: modalRef, children: _jsxs(\"form\", { css: formWrapper, onSubmit: onSubmit, children: [_jsx(\"div\", { css: [\n                        inputWrapper,\n                        svgStyles,\n                        errorSvgStyles,\n                        errors.categoryId ? errorBorderColour : borderColour,\n                    ], children: _jsxs(Select, { label: 'Category', onChange: (e) => {\n                            setFormVariables({\n                                ...formVariables,\n                                categoryId: Number(e.target.value),\n                            });\n                            errors.categoryId = '';\n                            setErrors(errors);\n                        }, value: formVariables.categoryId, theme: {\n                            textLabel: labelColour,\n                            textOptional: labelColour,\n                            textError: errorColour,\n                            borderError: errorColour,\n                        }, error: errors.categoryId ? errors.categoryId : undefined, children: [_jsx(Option, { value: \"0\", children: \"Please select\" }), _jsx(Option, { value: \"1\", children: \"Personal abuse\" }), _jsx(Option, { value: \"2\", children: \"Off topic\" }), _jsx(Option, { value: legalIssueCategoryId, children: \"Legal issue\" }), _jsx(Option, { value: \"4\", children: \"Trolling\" }), _jsx(Option, { value: \"5\", children: \"Hate speech\" }), _jsx(Option, { value: \"6\", children: \"Offensive/Threatening language\" }), _jsx(Option, { value: \"7\", children: \"Copyright\" }), _jsx(Option, { value: \"8\", children: \"Spam\" }), _jsx(Option, { value: otherCategoryId, children: \"Other\" })] }) }), _jsx(\"div\", { css: [\n                        inputWrapper,\n                        svgStyles,\n                        errorSvgStyles,\n                        errors.reason ? errorBorderColour : borderColour,\n                    ], children: _jsx(TextArea, { id: \"reason\", size: 'medium', label: 'Reason', optional: !isReasonRequired, onChange: (e) => setFormVariables({\n                            ...formVariables,\n                            reason: e.target.value,\n                        }), value: formVariables.reason, required: isReasonRequired, theme: {\n                            textLabel: labelColour,\n                            textOptional: labelColour,\n                            textError: errorColour,\n                            borderError: errorColour,\n                        }, error: errors.reason ? errors.reason : undefined }) }), _jsx(\"div\", { css: [\n                        inputWrapper,\n                        svgStyles,\n                        errorSvgStyles,\n                        errors.email ? errorBorderColour : borderColour,\n                    ], children: _jsx(TextInput, { label: 'Email', optional: true, id: \"email\", type: \"email\", onChange: (e) => setFormVariables({\n                            ...formVariables,\n                            email: e.target.value,\n                        }), value: formVariables.email, theme: {\n                            textLabel: labelColour,\n                            textOptional: labelColour,\n                            textError: errorColour,\n                            borderError: errorColour,\n                        }, error: errors.email ? errors.email : undefined }) }), _jsxs(\"div\", { children: [_jsx(Button, { type: \"submit\", size: \"small\", \"data-link-name\": \"Post report abuse\", cssOverrides: buttonStyles, children: \"Report\" }), !!errors.response && (_jsx(InlineError, { cssOverrides: css `\n\t\t\t\t\t\t\t\tcolor: ${errorColour};\n\t\t\t\t\t\t\t\tpadding-top: ${space[2]}px;\n\t\t\t\t\t\t\t`, children: errors.response })), !!successMessage && (_jsx(InlineSuccess, { cssOverrides: css `\n\t\t\t\t\t\t\t\tcolor: ${schemedPalette('--discussion-report-success-text')};\n\t\t\t\t\t\t\t\tpadding-top: ${space[2]}px;\n\t\t\t\t\t\t\t`, children: successMessage }))] }), _jsx(\"div\", { css: css `\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\tright: ${space[3]}px;\n\t\t\t\t\t\ttop: ${space[3]}px;\n\t\t\t\t\t`, children: _jsx(Button\n                    // TODO: use ref once forwardRef is implemented @guardian/src-button\n                    // ref={lastElement}\n                    , { \"custom-guardian\": \"close-modal\", size: \"small\", iconSide: \"right\", icon: _jsx(SvgCross, {}), onClick: toggleSetShowForm, \"data-link-name\": \"cancel-report-abuse\", hideLabel: true, cssOverrides: buttonStyles, children: \"close report abuse modal\" }) })] }) }));\n};\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nconst imageStyles = (size) => css `\n\tborder-radius: ${size + 10}px;\n\twidth: ${size}px;\n\theight: ${size}px;\n`;\nexport const Avatar = ({ imageUrl = 'https://avatar.guim.co.uk/no-user-image.gif', displayName, size, }) => {\n    switch (size) {\n        case 'small':\n            return (_jsx(\"img\", { src: imageUrl, alt: displayName, css: imageStyles(36) }));\n        case 'large':\n            return (_jsx(\"img\", { src: imageUrl, alt: displayName, css: imageStyles(60) }));\n        case 'medium':\n        default:\n            return (_jsx(\"img\", { src: imageUrl, alt: displayName, css: imageStyles(48) }));\n    }\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { space, textSansBold12 } from '@guardian/source/foundations';\nimport { palette as themePalette } from '../../palette';\nconst staffBadge = css `\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n`;\nconst iconStyles = css `\n\tdisplay: inline-block;\n\twidth: 15px;\n\theight: 15px;\n`;\nconst labelText = css `\n\tdisplay: inline-block;\n\tline-height: 15px;\n\tmargin: 0 0 0 ${space[1]}px;\n\t${textSansBold12};\n`;\nconst staffLabel = css `\n\tcolor: ${themePalette('--discussion-staff-label-text')};\n`;\nconst guardianPickLabel = css `\n\tcolor: ${themePalette('--discussion-pick-label-text')};\n`;\nexport const GuardianStaff = () => (_jsxs(\"div\", { css: staffBadge, children: [_jsxs(\"svg\", { width: \"36\", height: \"36\", viewBox: \"0 0 36 36\", css: iconStyles, fill: themePalette('--staff-contributor-badge'), children: [_jsx(\"path\", { d: \"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36\" }), _jsx(\"path\", { fill: themePalette('--staff-contributor-badge-text'), d: \"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z\" })] }), _jsx(\"p\", { css: [labelText, staffLabel], children: \"Staff\" })] }));\nexport const GuardianContributor = () => (_jsxs(\"div\", { css: staffBadge, children: [_jsxs(\"svg\", { width: \"36\", height: \"36\", viewBox: \"0 0 36 36\", css: iconStyles, fill: themePalette('--staff-contributor-badge'), children: [_jsx(\"path\", { d: \"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36\" }), _jsx(\"path\", { fill: themePalette('--staff-contributor-badge-text'), d: \"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z\" })] }), _jsx(\"p\", { css: [labelText, staffLabel], children: \"Contributor\" })] }));\nexport const GuardianPick = () => (_jsxs(\"div\", { css: staffBadge, children: [_jsxs(\"svg\", { width: \"36\", height: \"36\", viewBox: \"0 0 36 36\", css: iconStyles, fill: themePalette('--staff-pick-badge'), children: [_jsx(\"path\", { d: \"M18 0a18 18 0 1 0 0 36 18 18 0 0 0 0-36\" }), _jsx(\"path\", { fill: themePalette('--staff-pick-badge-text'), d: \"M21.2 4.4c2.3.4 5.3 2 6.3 3.1v5.2H27L21.2 5v-.6zm-2.2.4c-4 0-6.3 5.6-6.3 13.2 0 7.7 2.2 13.3 6.3 13.3v.6c-6 .4-14.4-4.2-14-13.8A13.3 13.3 0 0 1 19 4v.7zm10.4 14.4l-1.9.9v8.6c-1 1-3.8 2.6-6.3 3.1V19.9l-2.2-.7v-.6h10.4v.6z\" })] }), _jsx(\"p\", { css: [labelText, guardianPickLabel], children: \"Guardian Pick\" })] }));\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nexport const Column = ({ children }) => (_jsx(\"div\", { css: css `\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t`, children: children }));\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nconst rowStyles = css `\n\tdisplay: flex;\n\tflex-direction: row;\n`;\nexport const Row = ({ children, wrap = false, cssOverrides }) => (_jsx(\"div\", { css: [rowStyles, cssOverrides], style: { flexWrap: wrap ? 'wrap' : undefined }, children: children }));\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { textSans12 } from '@guardian/source/foundations';\nimport { SvgArrowUpStraight } from '@guardian/source/react-components';\nimport { useState } from 'react';\nimport { palette as themePalette } from '../../palette';\nimport { Row } from './Row';\nconst countStyles = css `\n\t${textSans12};\n\t/**\n\t * Typography preset styles should not be overridden.\n\t * This has been done because the styles do not directly map to the new presets.\n\t * Please speak to your team's designer and update this to use a more appropriate preset.\n\t */\n\tfont-weight: 300;\n\tmin-width: 0.75rem;\n\tcolor: ${themePalette('--discussion-subdued')};\n\tmargin-right: 0.3125rem;\n`;\nconst buttonStyles = (recommended, isSignedIn) => css `\n\tcursor: ${recommended || !isSignedIn ? 'default' : 'pointer'};\n\twidth: 1.1875rem;\n\theight: 1.1875rem;\n\tbackground-color: ${recommended\n    ? themePalette('--recommendation-count-selected')\n    : themePalette('--recommendation-count')};\n\tborder-radius: 62.5rem;\n\tborder: none;\n`;\nconst arrowStyles = (recommended) => css `\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tsvg {\n\t\tfill: ${recommended\n    ? themePalette('--recommendation-count-arrow-selected')\n    : themePalette('--recommendation-count-arrow')};\n\t\theight: 15px;\n\t\twidth: 15px;\n\t}\n`;\nexport const RecommendationCount = ({ commentId, initialCount, alreadyRecommended, user, userMadeComment, isClosedForRecommendations, }) => {\n    const [count, setCount] = useState(initialCount);\n    const [recommended, setRecommended] = useState(alreadyRecommended);\n    const tryToRecommend = () => {\n        if (!user)\n            return;\n        const newCount = count + 1;\n        setCount(newCount);\n        setRecommended(true);\n        user.onRecommend(commentId)\n            .then((accepted) => {\n            if (!accepted) {\n                setCount(newCount - 1);\n                setRecommended(alreadyRecommended);\n            }\n        })\n            // TODO: do some error handling\n            .catch(() => undefined);\n    };\n    return (_jsxs(Row, { children: [_jsx(\"div\", { css: countStyles, children: count }), _jsx(\"button\", { css: buttonStyles(recommended, !!user), onClick: tryToRecommend, disabled: recommended ||\n                    !user ||\n                    userMadeComment ||\n                    isClosedForRecommendations, \"data-link-name\": \"Recommend comment\", \"aria-label\": \"Recommend comment\", type: \"button\", children: _jsx(\"div\", { css: arrowStyles(recommended), children: _jsx(SvgArrowUpStraight, {}) }) })] }));\n};\n","import { timeAgo } from '@guardian/libs';\nconst getMonthString = (month) => {\n    switch (month) {\n        case 0:\n            return 'Jan';\n        case 1:\n            return 'Feb';\n        case 2:\n            return 'Mar';\n        case 3:\n            return 'Apr';\n        case 4:\n            return 'May';\n        case 5:\n            return 'Jun';\n        case 6:\n            return 'Jul';\n        case 7:\n            return 'Aug';\n        case 8:\n            return 'Sep';\n        case 9:\n            return 'Oct';\n        case 10:\n            return 'Nov';\n        case 11:\n            return 'Dec';\n        default:\n            return '';\n    }\n};\nconst isLast24Hrs = (date) => {\n    const timeStamp = Math.round(new Date().getTime() / 1000);\n    const timeStampYesterday = timeStamp - 24 * 3600;\n    return date.getTime() >= new Date(timeStampYesterday * 1000).getTime();\n};\nexport const dateFormatter = (dateString) => {\n    const date = new Date(dateString);\n    if (isLast24Hrs(date)) {\n        return timeAgo(date.getTime(), { verbose: true, daysUntilAbsolute: 1 });\n    }\n    return `${date.getDate()} ${getMonthString(date.getMonth())} ${date.getFullYear()} ${date.getHours()}.${String(date.getMinutes()).padStart(2, '0')}`;\n};\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { textSans12 } from '@guardian/source/foundations';\nimport { useState } from 'react';\nimport { dateFormatter } from '../../lib/discussionDateFormatter';\nimport { useInterval } from '../../lib/useInterval';\nimport { palette as schemedPalette } from '../../palette';\nconst linkStyles = css `\n\tcolor: ${schemedPalette('--discussion-subdued')};\n\ttext-decoration: none;\n\t:hover,\n\t:focus {\n\t\ttext-decoration: underline;\n\t}\n`;\nconst timeStyles = css `\n\t${textSans12};\n\t/**\n\t * Typography preset styles should not be overridden.\n\t * This has been done because the styles do not directly map to the new presets.\n\t * Please speak to your team's designer and update this to use a more appropriate preset.\n\t */\n\tfont-weight: 300;\n\tmin-width: 0.75rem;\n\tmargin-right: 0.3125rem;\n\twhite-space: nowrap;\n`;\nexport const Timestamp = ({ isoDateTime, webUrl, commentId, onPermalinkClick, }) => {\n    const [timeAgo, setTimeAgo] = useState(dateFormatter(isoDateTime));\n    useInterval(() => {\n        setTimeAgo(dateFormatter(isoDateTime));\n    }, 15000);\n    return (_jsx(\"a\", { href: webUrl, css: linkStyles, \"data-link-name\": \"jump-to-comment-timestamp\", onClick: (e) => {\n            onPermalinkClick(commentId);\n            e.preventDefault();\n        }, rel: \"nofollow\", children: _jsx(\"time\", { dateTime: isoDateTime.toString(), css: timeStyles, children: timeAgo }) }));\n};\n","import { useEffect, useRef } from 'react';\n// Why do we have this custom hook?\n// https://overreacted.io/making-setinterval-declarative-with-react-hooks/\nexport const useInterval = (callback, delay) => {\n    const savedCallback = useRef();\n    // Remember the latest callback.\n    useEffect(() => {\n        savedCallback.current = callback;\n    }, [callback]);\n    // Set up the interval.\n    useEffect(() => {\n        function tick() {\n            const currentCallback = savedCallback.current;\n            if (currentCallback) {\n                currentCallback();\n            }\n        }\n        const id = setInterval(tick, delay);\n        return () => clearInterval(id);\n    }, [delay]);\n};\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { from, remSpace, space, textSans12, textSans15, textSansBold12, textSansBold15, until, } from '@guardian/source/foundations';\nimport { Button, Link, SvgIndent } from '@guardian/source/react-components';\nimport { useState } from 'react';\nimport { createAuthenticationEventParams } from '../../lib/identity-component-event';\nimport { palette as schemedPalette } from '../../palette';\nimport { AbuseReportForm } from './AbuseReportForm';\nimport { Avatar } from './Avatar';\nimport { GuardianContributor, GuardianPick, GuardianStaff } from './Badges';\nimport { Column } from './Column';\nimport { RecommendationCount } from './RecommendationCount';\nimport { Row } from './Row';\nimport { Timestamp } from './Timestamp';\nconst commentControlsLink = css `\n\tmargin-top: -2px;\n\n\ta {\n\t\t${textSansBold15}\n\t\tmargin-right: ${space[2]}px;\n\t\tcolor: ${schemedPalette('--discussion-accent-text')};\n\t\t/*\n      We do not want underline to be applied to SVG\n      therefore we override the styles and apply them to the nested <span>\n    */\n\t\t:hover {\n\t\t\ttext-decoration: none;\n\t\t\ttext-decoration-color: none;\n\t\t\tspan {\n\t\t\t\tcolor: ${schemedPalette('--discussion-accent-text')};\n\t\t\t\ttext-decoration: underline;\n\t\t\t\ttext-decoration-color: ${schemedPalette('--discussion-accent-text')};\n\t\t\t}\n\t\t}\n\t}\n`;\nconst spaceBetween = css `\n\tdisplay: flex;\n\tjustify-content: space-between;\n`;\nconst commentCss = css `\n\tdisplay: block;\n\tclear: left;\n\t${textSans15}\n\tmargin-top: ${remSpace[2]};\n\tmargin-bottom: ${remSpace[3]};\n\tword-break: break-word;\n\n\tp {\n\t\tmargin-top: 0;\n\t\tmargin-bottom: ${space[3]}px;\n\t}\n\n\tblockquote {\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t\tmargin-left: ${space[5]}px;\n\t\tmargin-right: ${space[5]}px;\n\t\tpadding-left: ${space[2]}px;\n\t\tcolor: ${schemedPalette('--discussion-subdued')};\n\t}\n\n\ti {\n\t\tfont-style: italic;\n\t}\n\n\tb {\n\t\tfont-weight: bold;\n\t}\n\n\tcode {\n\t\t/* stylelint-disable-next-line property-disallowed-list -- we do not have a monospace Source font */\n\t\tfont-family: monospace;\n\t\tfont-size: 1em;\n\t}\n`;\nconst blockedCommentStyles = css `\n\tcolor: ${schemedPalette('--discussion-subdued')};\n\t${textSans12}\n`;\n// to override a tag styles from dangerouslySetInnerHTML\nconst commentLinkStyling = css `\n\ta {\n\t\tcolor: ${schemedPalette('--discussion-link')};\n\t\ttext-decoration-color: ${schemedPalette('--discussion-comment-underline')};\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n`;\nconst commentWrapper = css `\n\tborder-top: 1px solid ${schemedPalette('--discussion-border')};\n\tdisplay: flex;\n\tpadding: ${space[2]}px 0;\n`;\nconst selectedStyles = css `\n\tbackground-color: ${schemedPalette('--discussion-selected-background')};\n\tmargin-left: -${space[2]}px;\n\tpadding-left: ${space[2]}px;\n\tmargin-right: -${space[2]}px;\n\tpadding-right: ${space[2]}px;\n`;\nconst avatarMargin = css `\n\tmargin-right: ${space[2]}px;\n\n\t${until.mobileLandscape} {\n\t\tdisplay: none;\n\t}\n`;\nconst colourStyles = css `\n\ta {\n\t\tcolor: ${schemedPalette('--discussion-accent-text')};\n\t\ttext-decoration-color: ${schemedPalette('--discussion-accent-text')};\n\t\t:hover {\n\t\t\tcolor: ${schemedPalette('--discussion-accent-text')};\n\t\t\ttext-decoration-color: ${schemedPalette('--discussion-accent-text')};\n\t\t}\n\t}\n`;\nconst boldFont = css `\n\ta {\n\t\t${textSansBold15}\n\t}\n`;\nconst regularFont = css `\n\ta {\n\t\t${textSans15}\n\t}\n`;\n// TODO: fix using !important\nconst svgReplyArrow = css `\n\tsvg {\n\t\t/* stylelint-disable-next-line declaration-no-important */\n\t\tfill: ${schemedPalette('--discussion-subdued')} !important;\n\t}\n`;\nconst commentDetails = css `\n\tflex-grow: 1;\n\twidth: 100%;\n`;\nconst headerStyles = css `\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n`;\nconst iconWrapper = css `\n\tpadding: 2px;\n\twhite-space: nowrap;\n`;\nconst timestampWrapperStyles = css `\n\tmargin-left: ${space[2]}px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n`;\nconst hideBelowMobileLandscape = css `\n\t${until.mobileLandscape} {\n\t\tdisplay: none;\n\t}\n`;\nconst hideAboveMobileLandscape = css `\n\t${from.mobileLandscape} {\n\t\tdisplay: none;\n\t}\n`;\nconst negativeMargin = css `\n\tmargin-top: 0px;\n\tmargin-bottom: -6px;\n`;\nconst cssTextOverflowElip = css `\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n`;\nconst cssReplyToWrapper = css `\n\t${until.mobileLandscape} {\n\t\tpadding-right: 10px;\n\t\twidth: calc(100% - 35px);\n\t\tbox-sizing: border-box;\n\t}\n`;\nconst buttonLinkPillarBaseStyles = css `\n\tbutton {\n\t\tcolor: ${schemedPalette('--discussion-accent-text')};\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ${schemedPalette('--discussion-accent-text')};\n\t\t}\n\t}\n`;\nconst buttonLinkBaseStyles = css `\n\tbutton {\n\t\tcolor: ${schemedPalette('--discussion-subdued')};\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ${schemedPalette('--discussion-subdued')};\n\t\t}\n\t}\n`;\nconst subdued = css `\n\ttext-decoration: none;\n`;\n// In order to show as much of the usernames as possible without fixed widths:\n// - First label should shrink to contents but be no bigger than 60%\n// - Second label should never force first label less than its contents if less than 60%\n// - Second label should fill remaining space after above\n// - Both labels should truncate with ellipsis if they fill their space\n// Test page: https://codepen.io/gtrufitt/pen/LYGKQyY\nconst cssReplyAlphaDisplayName = css `\n\t${until.mobileLandscape} {\n\t\t${cssTextOverflowElip}\n\t\twidth: 100%;\n\t\tmax-width: fit-content;\n\t}\n`;\nconst cssReplyBetaDisplayName = css `\n\tmargin-top: -2px;\n\t${until.mobileLandscape} {\n\t\t${cssTextOverflowElip}\n\t\tmin-width: 40%;\n\t\tflex-grow: 1;\n\t}\n`;\nconst spacedColumnStyles = css `\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: ${space[1]}px;\n`;\nconst Space = ({ amount }) => (_jsx(\"div\", { css: css `\n\t\t\twidth: ${space[amount]}px;\n\t\t` }));\nexport const Comment = ({ comment, isClosedForComments, isClosedForRecommendations, setCommentBeingRepliedTo, user, isReply, wasScrolledTo, isMuted, toggleMuteStatus, onPermalinkClick, reportAbuse, isExpanded, }) => {\n    const [isHighlighted, setIsHighlighted] = useState(comment.isHighlighted);\n    const [showAbuseReportForm, setAbuseReportForm] = useState(false);\n    const [pickError, setPickError] = useState('');\n    const toggleSetShowForm = () => {\n        setAbuseReportForm(!showAbuseReportForm);\n    };\n    const pick = async (staffUser) => {\n        setPickError('');\n        const response = await staffUser.onPick(comment.id);\n        if (response.kind === 'error') {\n            setPickError(response.error);\n        }\n        else {\n            setIsHighlighted(response.value);\n        }\n    };\n    const unPick = async (staffUser) => {\n        setPickError('');\n        const response = await staffUser.onUnpick(comment.id);\n        if (response.kind === 'error') {\n            setPickError(response.error);\n        }\n        else {\n            setIsHighlighted(response.value);\n        }\n    };\n    const showStaffBadge = comment.userProfile.badge.some((obj) => obj['name'] === 'Staff');\n    const showPickBadge = comment.status !== 'blocked' && isHighlighted;\n    // A contributor could be e.g. a freelancer that commonly comments on articles.\n    // In frontend we check/display the Staff badge else we check/display the\n    // Contributor - we shouldn't see both Staff & Contributor badges.\n    // https://github.com/guardian/frontend/blob/main/discussion/app/views/fragments/commentBadges.scala.html#L8\n    const showContributorBadge = comment.userProfile.badge.some((obj) => obj['name'] === 'Contributor');\n    return (_jsxs(_Fragment, { children: [!!pickError && (_jsx(\"span\", { css: css `\n\t\t\t\t\t\tcolor: red;\n\t\t\t\t\t`, children: pickError })), _jsxs(\"div\", { id: `comment-${comment.id}`, \"data-testid\": comment.id, css: [commentWrapper, wasScrolledTo && selectedStyles], children: [_jsx(\"div\", { css: avatarMargin, children: _jsx(Avatar, { imageUrl: comment.userProfile.avatar, displayName: comment.userProfile.displayName, size: isReply ? 'small' : 'medium' }) }), _jsxs(\"div\", { css: commentDetails, children: [_jsxs(\"header\", { css: headerStyles, children: [_jsx(\"div\", { css: cssReplyToWrapper, children: _jsxs(Column, { children: [_jsx(\"div\", { css: [\n                                                        comment.responseTo &&\n                                                            hideBelowMobileLandscape,\n                                                        hideAboveMobileLandscape,\n                                                    ], children: _jsxs(Row, { children: [_jsx(\"div\", { css: css `\n\t\t\t\t\t\t\t\t\t\t\t\tmargin-right: ${space[2]}px;\n\t\t\t\t\t\t\t\t\t\t\t`, children: _jsx(Avatar, { imageUrl: comment.userProfile.avatar, displayName: '', size: \"small\" }) }), _jsxs(\"div\", { css: spacedColumnStyles, children: [_jsx(\"div\", { css: [\n                                                                            colourStyles,\n                                                                            boldFont,\n                                                                            negativeMargin,\n                                                                        ], children: _jsx(Link, { href: comment.userProfile\n                                                                                .webUrl, cssOverrides: subdued, rel: \"nofollow\", children: comment.userProfile\n                                                                                .displayName }) }), _jsx(Timestamp, { isoDateTime: comment.isoDateTime, webUrl: comment.webUrl, commentId: comment.id, onPermalinkClick: onPermalinkClick })] })] }) }), _jsxs(\"div\", { css: [\n                                                        !comment.responseTo &&\n                                                            hideBelowMobileLandscape,\n                                                    ], children: [_jsxs(Row, { children: [_jsx(\"div\", { css: [\n                                                                        colourStyles,\n                                                                        boldFont,\n                                                                        cssReplyAlphaDisplayName,\n                                                                    ], children: _jsx(Link, { href: comment.userProfile.webUrl, cssOverrides: subdued, rel: \"nofollow\", children: comment.userProfile\n                                                                            .displayName }) }), comment.responseTo ? (_jsx(\"div\", { css: [\n                                                                        colourStyles,\n                                                                        regularFont,\n                                                                        svgReplyArrow,\n                                                                        cssReplyBetaDisplayName,\n                                                                    ], children: _jsx(Link, { href: `#comment-${comment.responseTo.commentId}`, cssOverrides: subdued, icon: _jsx(SvgIndent, {}), iconSide: \"left\", rel: \"nofollow\", children: comment.responseTo\n                                                                            .displayName }) })) : (_jsx(_Fragment, {})), _jsx(\"div\", { css: [\n                                                                        timestampWrapperStyles,\n                                                                        comment.responseTo &&\n                                                                            hideBelowMobileLandscape,\n                                                                    ], children: _jsx(Timestamp, { isoDateTime: comment.isoDateTime, webUrl: comment.webUrl, commentId: comment.id, onPermalinkClick: onPermalinkClick }) })] }), _jsxs(Row, { children: [showStaffBadge && (_jsx(\"div\", { css: iconWrapper, children: _jsx(GuardianStaff, {}) })), showContributorBadge &&\n                                                                    !showStaffBadge && (_jsx(\"div\", { css: iconWrapper, children: _jsx(GuardianContributor, {}) })), showPickBadge && (_jsx(\"div\", { css: iconWrapper, children: _jsx(GuardianPick, {}) }))] })] })] }) }), comment.status !== 'blocked' && (_jsx(RecommendationCount, { commentId: comment.id, initialCount: comment.numRecommends, alreadyRecommended: false, user: user, userMadeComment: user?.profile.userId ===\n                                            comment.userProfile.userId, isClosedForRecommendations: isClosedForRecommendations }))] }), _jsx(\"div\", { css: [\n                                    comment.responseTo && hideBelowMobileLandscape,\n                                    hideAboveMobileLandscape,\n                                ], children: _jsxs(Row, { children: [showStaffBadge && (_jsx(\"div\", { css: iconWrapper, children: _jsx(GuardianStaff, {}) })), showContributorBadge && !showStaffBadge && (_jsx(\"div\", { css: iconWrapper, children: _jsx(GuardianContributor, {}) })), showPickBadge && (_jsx(\"div\", { css: iconWrapper, children: _jsx(GuardianPick, {}) }))] }) }), isMuted && (_jsx(\"p\", { css: blockedCommentStyles, children: _jsxs(Row, { children: [_jsx(_Fragment, { children: \"All posts from this user have been muted on this device.\" }), _jsx(Space, { amount: 1 }), _jsx(\"div\", { css: [\n                                                buttonLinkBaseStyles,\n                                                css `\n\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t${textSansBold12}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t`,\n                                            ], children: _jsx(Button, { priority: \"subdued\", size: \"xsmall\", onClick: () => toggleMuteStatus(comment.userProfile.userId), \"data-link-name\": \"unmute-user\", children: \"Unmute?\" }) })] }) })), !isMuted && comment.status === 'blocked' && (_jsx(\"p\", { css: [blockedCommentStyles, commentLinkStyling], dangerouslySetInnerHTML: { __html: comment.body } })), !isMuted && comment.status !== 'blocked' && (_jsxs(_Fragment, { children: [_jsx(\"div\", { css: [commentCss, commentLinkStyling], dangerouslySetInnerHTML: {\n                                            __html: comment.body,\n                                        } }), _jsxs(\"div\", { css: spaceBetween, children: [_jsxs(Row, { children: [!isClosedForComments && (_jsxs(_Fragment, { children: [user ? (_jsx(\"div\", { css: [\n                                                                    svgReplyArrow,\n                                                                    buttonLinkPillarBaseStyles,\n                                                                    css `\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${textSansBold15}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`,\n                                                                ], children: _jsx(Button, { priority: \"subdued\", onClick: () => setCommentBeingRepliedTo(comment), icon: _jsx(SvgIndent, {}), iconSide: \"left\", \"data-link-name\": \"reply to comment\", children: \"Reply\" }) })) : (_jsx(\"div\", { css: [\n                                                                    svgReplyArrow,\n                                                                    commentControlsLink,\n                                                                ], children: _jsx(Link, { href: `https://profile.theguardian.com/signin?returnUrl=${comment.webUrl}&${createAuthenticationEventParams('signin_to_reply_comment')}`, cssOverrides: subdued, icon: _jsx(SvgIndent, {}), iconSide: \"left\", rel: \"nofollow\", children: _jsx(\"span\", { \"data-link-name\": \"reply to comment\", children: \"Reply\" }) }) })), _jsx(Space, { amount: 4 })] })), _jsx(Space, { amount: 4 }), user?.kind === 'Staff' &&\n                                                        user.profile.userId !==\n                                                            comment.userProfile.userId && (_jsx(\"div\", { css: [\n                                                            buttonLinkPillarBaseStyles,\n                                                            css `\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${textSansBold15}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t`,\n                                                        ], children: _jsx(Button, { priority: \"subdued\", onClick: isHighlighted\n                                                                ? () => unPick(user)\n                                                                : () => pick(user), \"data-link-name\": isHighlighted\n                                                                ? 'unpick-comment'\n                                                                : 'pick-comment', children: isHighlighted\n                                                                ? 'Unpick'\n                                                                : 'Pick' }) }))] }), _jsxs(Row, { children: [user &&\n                                                        comment.userProfile.userId !==\n                                                            user.profile.userId ? (_jsx(\"div\", { css: [\n                                                            buttonLinkBaseStyles,\n                                                            css `\n\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${textSans12}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t`,\n                                                        ], children: _jsx(Button, { priority: \"subdued\", size: \"small\", onClick: () => toggleMuteStatus(comment.userProfile\n                                                                .userId), \"data-link-name\": \"mute-user\", children: \"Mute\" }) })) : (_jsx(_Fragment, {})), _jsx(Space, { amount: 4 }), isExpanded && (_jsx(\"div\", { css: [\n                                                            buttonLinkBaseStyles,\n                                                            css `\n\t\t\t\t\t\t\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${textSans12}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t`,\n                                                        ], children: _jsx(Button, { priority: \"subdued\", size: \"small\", onClick: toggleSetShowForm, \"data-link-name\": \"Open report abuse\", children: \"Report\" }) })), showAbuseReportForm && (_jsx(\"div\", { css: css `\n\t\t\t\t\t\t\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\t\t\t\t\t\t`, children: _jsx(AbuseReportForm, { toggleSetShowForm: toggleSetShowForm, commentId: comment.id, reportAbuse: reportAbuse }) }))] })] })] }))] })] })] }));\n};\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { textSansBold15 } from '@guardian/source/foundations';\nimport { Button } from '@guardian/source/react-components';\nimport { palette as themePalette } from '../../palette';\nconst buttonOverrides = (priority) => {\n    switch (priority) {\n        case 'primary':\n            return css `\n\t\t\t\tbutton {\n\t\t\t\t\t${textSansBold15}\n\t\t\t\t\tbackground-color: ${themePalette('--discussion-primary-button-background')};\n\t\t\t\t\tcolor: ${themePalette('--discussion-button-text')};\n\n\t\t\t\t\t:hover {\n\t\t\t\t\t\tbackground-color: ${themePalette('--discussion-button-background-hover')};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`;\n        case 'secondary':\n            return css `\n\t\t\t\tbutton {\n\t\t\t\t\t${textSansBold15}\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tborder: 1px solid\n\t\t\t\t\t\t${themePalette('--discussion-accent-text')};\n\t\t\t\t\tcolor: ${themePalette('--discussion-accent-text')};\n\n\t\t\t\t\t:hover {\n\t\t\t\t\t\tbackground-color: ${themePalette('--discussion-button-background-hover')};\n\t\t\t\t\t\tborder: 1px solid\n\t\t\t\t\t\t\t${themePalette('--discussion-button-background-hover')};\n\t\t\t\t\t\tcolor: ${themePalette('--discussion-button-text')};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`;\n        case 'subdued':\n            return css `\n\t\t\t\tbutton {\n\t\t\t\t\t${textSansBold15}\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tcolor: ${themePalette('--discussion-accent-text')};\n\t\t\t\t\tborder-radius: 0;\n\t\t\t\t}\n\t\t\t`;\n    }\n};\nexport const PillarButton = ({ onClick, type, priority = 'primary', children, icon, iconSide, linkName, size = 'default', }) => (_jsx(\"div\", { css: buttonOverrides(priority), children: _jsx(Button, { priority: priority, size: size, onClick: onClick, type: type, icon: icon, iconSide: iconSide, \"data-link-name\": linkName, children: children }) }));\n","import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { space, textSans15 } from '@guardian/source/foundations';\nimport { palette as schemedPalette } from '../../palette';\nconst previewStyle = css `\n\t${textSans15}\n\tpadding: ${space[2]}px ${space[4]}px;\n\tbackground-color: ${schemedPalette('--discussion-preview-background')};\n\tborder-radius: 5px;\n\tmargin-top: 0;\n\tmargin-bottom: ${20}px;\n\tword-break: break-word;\n\n\tblockquote {\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t\tmargin-left: ${space[5]}px;\n\t\tmargin-right: ${space[5]}px;\n\t\tpadding-left: ${space[2]}px;\n\t\tcolor: ${schemedPalette('--discussion-subdued')};\n\t}\n\n\ti {\n\t\tfont-style: italic;\n\t}\n\n\tb {\n\t\tfont-weight: bold;\n\t}\n\n\tcode {\n\t\t/* stylelint-disable-next-line property-disallowed-list -- Source doesn't have a monospace font */\n\t\tfont-family: monospace;\n\t\tfont-size: 1em;\n\t}\n\n\t/*\n\t\ttodo: this spacing is currently repeated here, on regular comments, and\n\t\ton TopPick comments; can we factor out the common styling for these\n\t\tthree components?\n\t*/\n\tp {\n\t\tmargin-top: 0;\n\t\tmargin-bottom: ${space[3]}px;\n\t}\n`;\nconst spout = css `\n\tdisplay: block;\n\tleft: 0;\n\twidth: 0;\n\theight: 0;\n\tborder-right: 1rem solid transparent;\n\tborder-bottom: 1rem solid\n\t\t${schemedPalette('--discussion-preview-background')};\n\tmargin-left: 12.5rem;\n\tborder-right-style: inset;\n`;\nexport const Preview = ({ previewHtml, showSpout }) => (_jsxs(_Fragment, { children: [showSpout && _jsx(\"div\", { css: spout }), _jsx(\"div\", { css: previewStyle, dangerouslySetInnerHTML: { __html: previewHtml || '' } })] }));\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { headlineBold20, space, textSans15, } from '@guardian/source/foundations';\nimport { Link, TextInput } from '@guardian/source/react-components';\nimport { useState } from 'react';\nimport { palette as schemedPalette } from '../../palette';\nimport { useConfig } from '../ConfigContext';\nimport { PillarButton } from './PillarButton';\nimport { Preview } from './Preview';\nimport { Row } from './Row';\nconst textStyling = css `\n\t${textSans15};\n`;\nconst linkStyles = css `\n\tcolor: ${schemedPalette('--discussion-link')};\n`;\nconst Text = ({ children }) => (_jsx(\"p\", { css: textStyling, children: children }));\nconst inputLabelStyles = css `\n\t> label {\n\t\t> * {\n\t\t\tcolor: inherit;\n\t\t}\n\t}\n`;\nconst textInputStyles = css `\n\tbackground-color: transparent;\n\tcolor: inherit;\n`;\nconst h3Style = css `\n\t${headlineBold20};\n`;\nexport const FirstCommentWelcome = ({ error = '', submitForm, cancelSubmit, previewBody, }) => {\n    const { renderingTarget } = useConfig();\n    const [userName, setUserName] = useState('');\n    if (renderingTarget === 'Apps') {\n        return (_jsxs(\"div\", { css: css `\n\t\t\t\t\tpadding: ${space[2]}px;\n\t\t\t\t`, children: [_jsx(\"h3\", { css: h3Style, children: \"Welcome, you\\u2019re about to make your first comment!\" }), _jsx(Text, { children: \"Before you can post, you need to choose a username. Please do this in your profile settings.\" })] }));\n    }\n    return (_jsx(\"div\", { css: css `\n\t\t\t\tpadding: ${space[2]}px;\n\t\t\t`, children: _jsxs(\"form\", { onSubmit: (e) => {\n                e.preventDefault();\n                void submitForm(userName);\n            }, children: [_jsx(\"h3\", { css: h3Style, children: \"Welcome, you\\u2019re about to make your first comment!\" }), _jsx(Text, { children: \"Before you post, we\\u2019d like to thank you for joining the debate - we\\u2019re glad you\\u2019ve chosen to participate and we value your opinions and experiences.\" }), _jsx(Text, { children: \"Please choose your username under which you would like all your comments to show up. You can only set your username once.\" }), _jsx(\"div\", { css: inputLabelStyles, children: _jsx(TextInput, { label: \"Username:\", supporting: \"Must be 6-20 characters, letters and/or numbers only, no spaces.\", value: userName, onChange: (e) => setUserName(e.target.value), width: 30, error: error, cssOverrides: textInputStyles }) }), _jsx(Text, { children: _jsxs(_Fragment, { children: [\"Please keep your posts respectful and abide by the\", ' ', _jsx(Link, { href: \"/community-standards\", priority: \"primary\", subdued: true, rel: \"nofollow\", cssOverrides: linkStyles, children: _jsx(\"span\", { css: textStyling, children: \"community guidelines\" }) }), ` -`, \" and if you spot a comment you think doesn\\u2019t adhere to the guidelines, please use the \\u2018Report\\u2019 link next to it to let us know.\"] }) }), _jsx(Text, { children: \"Please preview your comment below and click \\u2018post\\u2019 when you\\u2019re happy with it.\" }), _jsx(Preview, { previewHtml: previewBody, showSpout: false }), _jsxs(Row, { children: [_jsx(PillarButton, { onClick: () => void submitForm(userName), linkName: \"post comment\", size: \"small\", children: \"Post your comment\" }), _jsx(\"div\", { css: css `\n\t\t\t\t\t\t\twidth: ${space[3]}px;\n\t\t\t\t\t\t` }), _jsx(PillarButton, { priority: \"subdued\", onClick: cancelSubmit, linkName: \"cancel-post-comment\", size: \"small\", children: \"Cancel\" })] })] }) }));\n};\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { space, textSans12, textSans15, textSansBold12, until, } from '@guardian/source/foundations';\nimport { Link, TextArea } from '@guardian/source/react-components';\nimport { InfoSummary } from '@guardian/source-development-kitchen/react-components';\nimport { useEffect, useState } from 'react';\nimport { preview as defaultPreview } from '../../lib/discussionApi';\nimport { palette as schemedPalette } from '../../palette';\nimport { FirstCommentWelcome } from './FirstCommentWelcome';\nimport { PillarButton } from './PillarButton';\nimport { Preview } from './Preview';\nimport { Row } from './Row';\nconst boldString = (str) => `<b>${str}</b>`;\nconst italicsString = (str) => `<i>${str}</i>`;\nconst strikethroughString = (str) => `<del>${str}</del>`;\nconst codeString = (str) => `<code>${str}</code>`;\nconst quoteString = (str) => `<blockquote>${str}</blockquote>`;\nconst linkStringFunc = (url, highlightedText) => `<a href=\"${url}\" rel=\"nofollow\">${highlightedText ? highlightedText : url}</a>`;\nconst formWrapper = css `\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tmargin-bottom: ${space[5]}px;\n`;\nconst commentTextArea = css `\n\twidth: 100%;\n\tmargin-bottom: ${space[3]}px;\n\tpadding: 8px 10px 10px 8px;\n\t${textSans15};\n\tborder-color: ${schemedPalette('--discussion-border')};\n\t:focus {\n\t\tborder-color: ${schemedPalette('--discussion-subdued')};\n\t\toutline: none;\n\t}\n\tcolor: inherit;\n\tbackground-color: ${schemedPalette('--comment-form-input-background')};\n`;\nconst greyPlaceholder = css `\n\t::placeholder {\n\t\tcolor: ${schemedPalette('--discussion-subdued')};\n\t}\n`;\n// Opacity? See: https://stackoverflow.com/questions/19621306/css-placeholder-text-color-on-firefox\nconst blackPlaceholder = css `\n\t::placeholder {\n\t\tfont-weight: bold;\n\t\topacity: 1;\n\t\tcolor: inherit;\n\t}\n`;\nconst headerTextStyles = css `\n\tmargin: 0 0 10px 0;\n\t${textSans12};\n`;\nconst linkStyles = css `\n\ta {\n\t\tcolor: ${schemedPalette('--discussion-link')};\n\t\ttext-decoration: none;\n\t\t:hover,\n\t\t:focus {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n`;\nconst wrapperHeaderTextStyles = css `\n\tbackground-color: ${schemedPalette('--comment-form-header-background')};\n\tpadding: 8px 10px 10px 8px;\n\twidth: 100%;\n\tmargin-top: 8px;\n\tmargin-bottom: 2px;\n`;\nconst commentAddOns = css `\n\theight: 22px;\n\tfont-size: 13px;\n\tline-height: 17px;\n\tborder: 1px solid ${schemedPalette('--discussion-background')};\n\tbackground-color: ${schemedPalette('--discussion-background')};\n\tcolor: inherit;\n\ttext-align: center;\n\tcursor: pointer;\n\tmargin-left: 4px;\n\tpadding: 2px 5px 0px 5px;\n\tmin-width: 11px;\n\tlist-style-type: none;\n`;\nconst preModMessage = css `\n\t& div {\n\t\tcolor: inherit;\n\t\t${textSansBold12};\n\t\tsvg {\n\t\t\tfill: ${schemedPalette('--discussion-pre-mod')};\n\t\t}\n\t}\n`;\nconst preModLink = css `\n\tcolor: ${schemedPalette('--discussion-pre-mod')};\n\t${textSansBold12};\n`;\nconst bottomContainer = css `\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex-wrap: wrap;\n\tjustify-content: space-between;\n\talign-items: stretch;\n\talign-content: space-between;\n\tgap: ${space[3]}px;\n\t${until.wide} {\n\t\tflex-direction: column-reverse;\n\t}\n`;\nconst Space = ({ amount }) => (_jsx(\"div\", { css: css `\n\t\t\twidth: ${space[amount]}px;\n\t\t` }));\n/**\n * The returned object below is a simulation of the comment that was created that\n * we add to our local state so that the reader has immediate feedback.\n * We do this because the API has a 1 minute cache expiry so simply refreshing\n * the main list of comments often will not return the comment just added.\n *\n * Edge case: If the user _does_ refresh then this local state will be overridden\n * by the new API response and - if the refresh was within 60 seconds - the\n * reader's comment will not be present. The same edge case exists in frontend.\n */\nconst simulateNewComment = (commentId, body, userProfile) => ({\n    id: commentId,\n    body,\n    date: Date(),\n    isoDateTime: new Date().toISOString(),\n    status: 'visible',\n    webUrl: `https://discussion.theguardian.com/comment-permalink/${commentId}`,\n    apiUrl: `https://discussion.guardianapis.com/discussion-api/comment/${commentId}`,\n    numRecommends: 0,\n    isHighlighted: false,\n    userProfile,\n    responses: [],\n});\nconst simulateNewReply = (commentId, body, userProfile, commentBeingRepliedTo) => ({\n    id: commentId,\n    body,\n    date: Date(),\n    isoDateTime: new Date().toISOString(),\n    status: 'visible',\n    webUrl: `https://discussion.theguardian.com/comment-permalink/${commentId}`,\n    apiUrl: `https://discussion.guardianapis.com/discussion-api/comment/${commentId}`,\n    numRecommends: 0,\n    isHighlighted: false,\n    userProfile,\n    responseTo: {\n        displayName: commentBeingRepliedTo.userProfile.displayName,\n        commentApiUrl: `https://discussion.guardianapis.com/discussion-api/comment/${commentBeingRepliedTo.id}`,\n        isoDateTime: commentBeingRepliedTo.isoDateTime,\n        date: commentBeingRepliedTo.date,\n        commentId: String(commentBeingRepliedTo.id),\n        commentWebUrl: `https://discussion.theguardian.com/comment-permalink/${commentBeingRepliedTo.id}`,\n    },\n});\nexport const CommentForm = ({ shortUrl, onAddComment, user, setCommentBeingRepliedTo, commentBeingRepliedTo, onPreview, error, setError, userNameMissing, setUserNameMissing, previewBody, setPreviewBody, }) => {\n    const [isActive, setIsActive] = useState(false);\n    const [isDisabled, setIsDisabled] = useState(false);\n    const [selectionStart, setSelectionStart] = useState(0);\n    const [selectionEnd, setSelectionEnd] = useState(0);\n    const [textValue, setTextValue] = useState('');\n    const handleSelect = (event) => {\n        setSelectionStart(event.target.selectionStart);\n        setSelectionEnd(event.target.selectionEnd);\n    };\n    const handleTextChange = (event) => {\n        setTextValue(event.target.value);\n    };\n    const setBody = (body) => {\n        setTextValue(body);\n    };\n    useEffect(() => {\n        if (commentBeingRepliedTo) {\n            document\n                .getElementById(`comment-${commentBeingRepliedTo.id}`)\n                ?.scrollIntoView();\n            document\n                .querySelector(`#comment-reply-form-${commentBeingRepliedTo.id} textarea`)\n                ?.focus();\n        }\n    }, [commentBeingRepliedTo]);\n    const getHighlightedString = () => {\n        const value = textValue;\n        const startString = value.substring(0, selectionStart);\n        const highlightedString = value.substring(selectionStart, selectionEnd);\n        const endString = value.substring(selectionEnd, value.length);\n        return { startString, highlightedString, endString };\n    };\n    const transformText = (transfromFunc) => {\n        const textAreaStrings = getHighlightedString();\n        if (!textAreaStrings)\n            return;\n        const { startString, highlightedString, endString } = textAreaStrings;\n        setBody(startString.concat(transfromFunc(highlightedString), endString));\n    };\n    const transformLink = () => {\n        const url = prompt('Your URL:', 'http://www.');\n        if (url === null)\n            return;\n        const textAreaStrings = getHighlightedString();\n        if (!textAreaStrings)\n            return;\n        const { startString, highlightedString, endString } = textAreaStrings;\n        setBody(startString.concat(linkStringFunc(url, highlightedString), endString));\n    };\n    const fetchShowPreview = async () => {\n        const body = textValue;\n        if (!body)\n            return;\n        const preview = onPreview ?? defaultPreview;\n        const response = await preview(body);\n        if (response.kind === 'error') {\n            setError('Preview request failed, please try again');\n            setPreviewBody('');\n            return;\n        }\n        setPreviewBody(response.value);\n    };\n    const handleError = (commentError) => {\n        switch (commentError) {\n            // Reader has never posted before and needs to choose a username\n            case 'USERNAME_MISSING':\n                return setUserNameMissing(true);\n            case 'EMPTY_COMMENT_BODY':\n                return setError('Please write a comment.');\n            case 'COMMENT_TOO_LONG':\n                return setError('Your comment must be fewer than 5000 characters long.');\n            case 'USER_BANNED':\n                return setError('Commenting has been disabled for this account (<a href=\"/community-faqs#321a\">why?</a>).');\n            case 'IP_THROTTLED':\n                return setError('Commenting has been temporarily blocked for this IP address (<a href=\"/community-faqs\">why?</a>).');\n            case 'DISCUSSION_CLOSED':\n                return setError('Sorry your comment can not be published as the discussion is now closed for comments.');\n            case 'PARENT_COMMENT_MODERATED':\n                return setError('Sorry the comment can not be published as the comment you replied to has been moderated since.');\n            case 'COMMENT_RATE_LIMIT_EXCEEDED':\n                return setError('You can only post one comment every minute. Please try again in a moment.');\n            case 'INVALID_PROTOCOL':\n                return setError(`Sorry your comment can not be published as it was not sent over\n\t\t\t\t\ta secure channel. Please report us this issue using the technical issue link\n\t\t\t\t\tin the page footer.`);\n            case 'AUTH_COOKIE_INVALID':\n                return setError('Sorry, your comment was not published as you are no longer signed in. Please sign in and try again.');\n            case 'READ-ONLY-MODE':\n                return setError(`Sorry your comment can not currently be published as\n\t\t\t\t\tcommenting is undergoing maintenance but will be back shortly. Please try\n\t\t\t\t\tagain in a moment.`);\n            case 'API_CORS_BLOCKED':\n                return setError(`Could not post due to your internet settings, which might be\n\t\t\t\t   controlled by your provider. Please contact your administrator\n\t\t\t\t   or disable any proxy servers or VPNs and try again.`);\n            case 'API_ERROR':\n                return setError(`Sorry, there was a problem posting your comment. Please try\n\t\t\t\t\tanother browser or network connection.  Reference code `);\n            case 'EMAIL_NOT_VALIDATED':\n                // TODO: Support resending verification email\n                return setError(`Please confirm your email address to comment.<br />\n\t\t\t\t\tIf you can't find the email, we can\n\t\t\t\t\t<a href=\"#\">\n\t\t\t\t\t<strong>resend the verification email</strong></a> to your email\n\t\t\t\t\taddress.`);\n            default:\n                return setError('Sorry, there was a problem posting your comment.');\n        }\n    };\n    const resetForm = () => {\n        setError('');\n        setBody('');\n        setPreviewBody('');\n        setIsActive(false);\n        setCommentBeingRepliedTo?.();\n    };\n    const submitForm = async () => {\n        if (isDisabled)\n            return;\n        setIsDisabled(true);\n        setError('');\n        const body = textValue;\n        if (body) {\n            const response = commentBeingRepliedTo\n                ? await user.onReply(shortUrl, body, commentBeingRepliedTo.id)\n                : await user.onComment(shortUrl, body);\n            // Check response message for error states\n            if (response.kind === 'error') {\n                handleError(response.error);\n            }\n            else {\n                onAddComment(commentBeingRepliedTo\n                    ? simulateNewReply(response.value, body, user.profile, commentBeingRepliedTo)\n                    : simulateNewComment(response.value, body, user.profile));\n                resetForm();\n            }\n        }\n        setIsDisabled(false);\n    };\n    const submitUserName = async (userName) => {\n        setError('');\n        if (!userName) {\n            setError('Username field cannot be empty');\n            return;\n        }\n        const response = await user.addUsername(userName);\n        if (response.kind === 'ok') {\n            // If we are able to submit userName we should continue with submitting comment\n            void submitForm();\n            setUserNameMissing(false);\n        }\n        else {\n            setError(response.error);\n        }\n    };\n    if (isActive && userNameMissing) {\n        return (_jsx(FirstCommentWelcome, { error: error, submitForm: submitUserName, cancelSubmit: () => setUserNameMissing(false), previewBody: previewBody }));\n    }\n    return (_jsxs(_Fragment, { children: [_jsxs(\"form\", { css: formWrapper, onSubmit: (e) => {\n                    e.preventDefault();\n                    void submitForm();\n                }, children: [isActive && (_jsxs(\"div\", { css: wrapperHeaderTextStyles, children: [_jsxs(\"p\", { css: [headerTextStyles, linkStyles], children: [\"Please keep comments respectful and abide by the\", ' ', _jsx(\"a\", { href: \"/community-standards\", children: \"community guidelines\" }), \".\"] }), user.profile.privateFields?.isPremoderated && (_jsx(InfoSummary, { message: 'Your comments are currently being pre-moderated', context: _jsx(Link, { href: \"/community-faqs#311\", target: \"_blank\", rel: \"nofollow\", cssOverrides: preModLink, children: \"(why?)\" }), cssOverrides: preModMessage }))] })), _jsx(TextArea, { \"data-testid\": \"comment-input\", placeholder: !!commentBeingRepliedTo || !isActive\n                            ? 'Join the discussion'\n                            : '', cssOverrides: css([\n                            commentTextArea,\n                            commentBeingRepliedTo && isActive && greyPlaceholder,\n                            !commentBeingRepliedTo && !isActive && blackPlaceholder,\n                        ]), style: { height: isActive ? '132px' : '50px' }, onFocus: () => setIsActive(true), value: textValue, onChange: handleTextChange, onSelect: handleSelect, label: '', error: error }), _jsxs(\"div\", { css: bottomContainer, children: [_jsx(Row, { wrap: true, children: _jsxs(_Fragment, { children: [_jsx(PillarButton, { type: \"submit\", linkName: \"post comment\", size: \"small\", children: \"Post your comment\" }), isActive && (_jsxs(_Fragment, { children: [_jsx(Space, { amount: 3 }), _jsx(PillarButton, { onClick: fetchShowPreview, priority: \"secondary\", linkName: \"preview-comment\", size: \"small\", children: \"Preview\" }), _jsx(Space, { amount: 3 }), _jsx(PillarButton, { onClick: resetForm, priority: \"subdued\", linkName: \"cancel-post-comment\", size: \"small\", children: \"Cancel\" })] }))] }) }), isActive && (_jsxs(Row, { wrap: true, children: [_jsx(\"button\", { onClick: (e) => {\n                                            e.preventDefault();\n                                            transformText(boldString);\n                                        }, css: commentAddOns, style: { fontWeight: 'bold' }, \"data-link-name\": \"formatting-controls-bold\", type: \"button\", title: \"Bold\", children: \"bold\" }), _jsx(\"button\", { onClick: (e) => {\n                                            e.preventDefault();\n                                            transformText(italicsString);\n                                        }, css: commentAddOns, style: { fontStyle: 'italic' }, \"data-link-name\": \"formatting-controls-italic\", type: \"button\", title: \"Italic\", children: \"italic\" }), _jsx(\"button\", { onClick: (e) => {\n                                            e.preventDefault();\n                                            transformText(strikethroughString);\n                                        }, css: commentAddOns, style: { textDecoration: 'line-through' }, \"data-link-name\": \"formatting-controls-strikethrough\", type: \"button\", title: \"Strikethrough\", children: \"strikethrough\" }), _jsx(\"button\", { onClick: (e) => {\n                                            e.preventDefault();\n                                            transformText(codeString);\n                                        }, css: commentAddOns, style: { fontFamily: 'monospace' }, \"data-link-name\": \"formatting-controls-code\", type: \"button\", title: \"Code\", children: `<code>` }), _jsx(\"button\", { onClick: (e) => {\n                                            e.preventDefault();\n                                            transformText(quoteString);\n                                        }, css: commentAddOns, \"data-link-name\": \"formatting-controls-quote\", type: \"button\", title: \"Quote\", children: \"\\\"quote\\\"\" }), _jsx(\"button\", { onClick: (e) => {\n                                            e.preventDefault();\n                                            transformLink();\n                                        }, css: commentAddOns, style: { textDecoration: 'underline' }, \"data-link-name\": \"formatting-controls-link\", type: \"button\", title: \"Link\", children: \"Link\" })] }))] })] }), previewBody.trim() !== '' && (_jsx(Preview, { previewHtml: previewBody, showSpout: true }))] }));\n};\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { space, textSans15, textSansBold15, } from '@guardian/source/foundations';\nimport { Button, SvgIndent } from '@guardian/source/react-components';\nimport { useState } from 'react';\nimport { palette as schemedPalette } from '../../palette';\nimport { Row } from './Row';\nconst Space = ({ amount }) => (_jsx(\"div\", { css: css `\n\t\t\twidth: ${space[amount]}px;\n\t\t` }));\nconst indentStyles = css `\n\twidth: 18px;\n\tsvg {\n\t\t/* stylelint-disable-next-line declaration-no-important */\n\t\tfill: ${schemedPalette('--discussion-subdued')} !important;\n\t}\n`;\nconst smallFontStyles = css `\n\t${textSans15};\n\tline-height: 19px;\n`;\nconst replyPreviewHeaderStyle = css `\n\t${textSansBold15};\n\tmargin-top: 0px;\n\tmargin-bottom: ${space[2]}px;\n`;\nconst arrowSize = 15;\nconst previewStyle = css `\n\tpadding-top: ${space[3]}px;\n\tpadding-bottom: ${space[3]}px;\n\tpadding-left: ${space[5]}px;\n\tpadding-right: ${space[5]}px;\n\tbackground-color: ${schemedPalette('--discussion-top-pick-background')};\n\tmargin-top: ${arrowSize}px;\n\tmargin-bottom: ${arrowSize + 5}px;\n\tposition: relative;\n\tdisplay: flex;\n\tflex-direction: column;\n\t:before {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tborder-left: ${arrowSize}px solid\n\t\t\t${schemedPalette('--discussion-top-pick-background')};\n\t\tborder-top: ${arrowSize}px solid transparent;\n\t\ttop: -${arrowSize - 1}px;\n\t\tmargin-left: ${space[9]}px;\n\t}\n`;\nconst commentStyles = css `\n\tp {\n\t\t${textSans15};\n\t\tmargin-top: 0px;\n\t\tmargin-bottom: ${space[3]}px;\n\t}\n`;\nconst blueLink = css `\n\tcolor: ${schemedPalette('--discussion-link')};\n`;\nconst buttonLinkPillarBaseStyles = css `\n\tbutton {\n\t\tcolor: ${schemedPalette('--discussion-accent-text')};\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ${schemedPalette('--discussion-accent-text')};\n\t\t}\n\t}\n`;\nconst buttonLinkBaseStyles = css `\n\tbutton {\n\t\tcolor: ${schemedPalette('--discussion-subdued')};\n\t\tbackground-color: transparent;\n\t\theight: 18px;\n\t\tmin-height: 18px;\n\t\t/* Radius 0 is used to style focus halo */\n\t\tborder-radius: 0;\n\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t\ttext-decoration-color: ${schemedPalette('--discussion-subdued')};\n\t\t}\n\t}\n`;\nexport const CommentReplyPreview = ({ commentBeingRepliedTo }) => {\n    const [displayReplyComment, setDisplayReplyComment] = useState(false);\n    return (_jsxs(_Fragment, { children: [_jsxs(Row, { children: [_jsx(\"div\", { css: indentStyles, children: _jsx(SvgIndent, {}) }), _jsx(Space, { amount: 1 }), _jsx(\"div\", { css: smallFontStyles, children: commentBeingRepliedTo.userProfile.displayName }), _jsx(Space, { amount: 3 }), _jsx(\"div\", { css: [\n                            buttonLinkPillarBaseStyles,\n                            css `\n\t\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t\t${textSansBold15}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t`,\n                        ], children: _jsx(Button, { priority: \"subdued\", onClick: () => setDisplayReplyComment(!displayReplyComment), \"data-link-name\": displayReplyComment\n                                ? 'reply-comment-hide'\n                                : 'reply-comment-show', children: displayReplyComment ? 'Hide Comment' : 'Show comment' }) })] }), displayReplyComment && (_jsx(Preview, { commentBeingRepliedTo: commentBeingRepliedTo, setDisplayReplyComment: setDisplayReplyComment, displayReplyComment: displayReplyComment }))] }));\n};\nexport const Preview = ({ commentBeingRepliedTo, setDisplayReplyComment, displayReplyComment, }) => {\n    return (_jsxs(\"div\", { css: previewStyle, children: [_jsxs(\"p\", { css: replyPreviewHeaderStyle, children: [commentBeingRepliedTo.userProfile.displayName, \" @\", ' ', commentBeingRepliedTo.date, \" said:\"] }), _jsx(\"div\", { css: commentStyles, dangerouslySetInnerHTML: {\n                    __html: commentBeingRepliedTo.body || '',\n                } }), _jsx(\"div\", { css: [\n                    buttonLinkBaseStyles,\n                    css `\n\t\t\t\t\t\tbutton {\n\t\t\t\t\t\t\t${textSans15}\n\t\t\t\t\t\t}\n\t\t\t\t\t`,\n                ], children: _jsx(Button, { priority: \"subdued\", onClick: () => setDisplayReplyComment(!displayReplyComment), \"data-link-name\": \"hide-comment\", children: _jsx(\"span\", { css: blueLink, children: \"Hide Comment\" }) }) })] }));\n};\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { space } from '@guardian/source/foundations';\nimport { SvgPlus } from '@guardian/source/react-components';\nimport { useState } from 'react';\nimport { getAllReplies } from '../../lib/discussionApi';\nimport { palette as schemedPalette } from '../../palette';\nimport { Comment } from './Comment';\nimport { CommentForm } from './CommentForm';\nimport { CommentReplyPreview } from './CommentReplyPreview';\nimport { PillarButton } from './PillarButton';\nconst nestingStyles = css `\n\tlist-style-type: none;\n\tpadding-left: ${space[2]}px;\n\tmargin-left: ${space[12]}px;\n`;\nconst topBorder = css `\n\tborder-top: 1px solid ${schemedPalette('--discussion-border')};\n`;\nconst commentContainerStyles = css `\n\tlist-style-type: none;\n\tpadding-left: 0;\n`;\nconst selectedStyles = css `\n\tbackground-color: ${schemedPalette('--discussion-selected-background')};\n\tmargin-left: -${space[2]}px;\n\tpadding-left: ${space[2]}px;\n\tmargin-right: -${space[2]}px;\n\tpadding-right: ${space[2]}px;\n`;\nconst removeMargin = css `\n\tmargin: 0px;\n`;\nexport const avatar = (avatarSize) => css `\n\tborder-radius: ${avatarSize + 10}px;\n\twidth: ${avatarSize}px;\n\theight: ${avatarSize}px;\n`;\nexport const CommentContainer = ({ comment, isClosedForComments, isClosedForRecommendations, user, shortUrl, threads, commentBeingRepliedTo, setCommentBeingRepliedTo, commentToScrollTo, mutes, toggleMuteStatus, onPermalinkClick, onPreview, error, setError, userNameMissing, setUserNameMissing, previewBody, setPreviewBody, reportAbuse, expandCommentReplies, isExpanded, }) => {\n    const responses = comment.responses ? comment.responses : [];\n    const totalResponseCount = comment.metaData?.responseCount ?? 0;\n    // Filter logic\n    const expanded = responses.length >= totalResponseCount;\n    const [loading, setLoading] = useState(false);\n    const showResponses = threads !== 'unthreaded' && responses.length > 0;\n    const decideShowMoreText = () => {\n        const remainingResponses = totalResponseCount - responses.length;\n        return remainingResponses === 1\n            ? `Show 1 more reply`\n            : `Show ${remainingResponses} more replies`;\n    };\n    const expand = (commentId) => {\n        setLoading(true);\n        getAllReplies(commentId)\n            .then((result) => {\n            if (result.kind === 'error') {\n                console.error(result.error);\n                return;\n            }\n            expandCommentReplies(commentId, result.value);\n        })\n            .catch(() => {\n            // do nothing\n        })\n            .finally(() => {\n            setLoading(false);\n        });\n    };\n    const onAddReply = (commentId, response) => expandCommentReplies(commentId, [...responses, response]);\n    return (_jsxs(\"div\", { css: [commentToScrollTo === comment.id && selectedStyles], children: [_jsx(Comment, { comment: comment, isClosedForComments: isClosedForComments, isClosedForRecommendations: isClosedForRecommendations, setCommentBeingRepliedTo: setCommentBeingRepliedTo, user: user, isReply: false, isMuted: mutes.includes(comment.userProfile.userId), toggleMuteStatus: toggleMuteStatus, onPermalinkClick: onPermalinkClick, reportAbuse: reportAbuse, isExpanded: isExpanded }), _jsxs(_Fragment, { children: [showResponses && responses.length > 0 && (_jsxs(\"div\", { css: nestingStyles, children: [_jsx(\"ul\", { css: [commentContainerStyles, removeMargin], children: responses.map((responseComment) => (_jsx(\"li\", { children: _jsx(Comment, { comment: responseComment, isClosedForComments: isClosedForComments, isClosedForRecommendations: isClosedForRecommendations, setCommentBeingRepliedTo: setCommentBeingRepliedTo, user: user, isReply: true, wasScrolledTo: commentToScrollTo ===\n                                            responseComment.id, isMuted: mutes.includes(responseComment.userProfile.userId), toggleMuteStatus: toggleMuteStatus, onPermalinkClick: onPermalinkClick, reportAbuse: reportAbuse, isExpanded: isExpanded }) }, responseComment.id))) }), !expanded && (_jsx(\"div\", { css: [\n                                    topBorder,\n                                    css `\n\t\t\t\t\t\t\t\t\t\tpadding-top: ${space[3]}px;\n\t\t\t\t\t\t\t\t\t\tpadding-bottom: ${space[3]}px;\n\t\t\t\t\t\t\t\t\t`,\n                                ], children: _jsx(PillarButton, { priority: \"secondary\", icon: _jsx(SvgPlus, {}), iconSide: \"left\", linkName: \"Show more replies\", onClick: () => expand(comment.id), size: \"xsmall\", children: loading\n                                        ? 'loading...'\n                                        : decideShowMoreText() }) }))] })), commentBeingRepliedTo &&\n                        (commentBeingRepliedTo.id === comment.id ||\n                            responses.find((response) => response.id === commentBeingRepliedTo.id)) &&\n                        user && (_jsxs(\"div\", { id: `comment-reply-form-${commentBeingRepliedTo.id}`, css: nestingStyles, children: [_jsx(CommentReplyPreview, { commentBeingRepliedTo: commentBeingRepliedTo }), _jsx(CommentForm, { shortUrl: shortUrl, onAddComment: (response) => {\n                                    if ('responses' in response)\n                                        return;\n                                    onAddReply(comment.id, response);\n                                }, user: user, setCommentBeingRepliedTo: setCommentBeingRepliedTo, commentBeingRepliedTo: commentBeingRepliedTo, onPreview: onPreview, error: error, setError: setError, userNameMissing: userNameMissing, setUserNameMissing: setUserNameMissing, previewBody: previewBody, setPreviewBody: setPreviewBody })] }))] })] }));\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { from, textSans15, textSansBold15, until, } from '@guardian/source/foundations';\nimport { useEffect, useState } from 'react';\nimport { palette as schemedPalette } from '../../palette';\nconst containerStyles = css `\n\tposition: relative;\n`;\nconst ulStyles = css `\n\tz-index: 2;\n\tlist-style: none;\n\tborder: 1px solid ${schemedPalette('--discussion-border')};\n\tmargin-left: -8px;\n\tpadding: 0px;\n\tdisplay: none;\n\tbackground-color: ${schemedPalette('--discussion-background')};\n\n\tposition: absolute;\n\n\t${until.tablet} {\n\t\tmargin-top: 4px;\n\t\tborder-radius: 0;\n\t\toverflow: auto;\n\t}\n\n\t${from.tablet} {\n\t\tmargin-top: 12px;\n\t\tborder-radius: 3px;\n\t}\n`;\nconst ulExpanded = css `\n\tdisplay: block;\n`;\nconst linkStyles = (disabled) => css `\n\t${textSans15};\n\ttext-align: left;\n\tcolor: ${disabled\n    ? schemedPalette('--discussion-text')\n    : schemedPalette('--discussion-subdued')};\n\tposition: relative;\n\ttext-decoration: none;\n\tmargin-top: 1px;\n\tpadding-top: 8px;\n\tpadding-right: 30px;\n\tpadding-bottom: 8px;\n\tpadding-left: 8px;\n\twidth: 100%;\n\tcursor: ${disabled ? 'default' : 'pointer'};\n\tbackground-color: white;\n\tborder: none;\n\n\t${!disabled &&\n    `\n    :hover {\n      background-color: ${schemedPalette('--discussion-background')};\n      text-decoration: underline;\n    }\n\n    :focus {\n      text-decoration: underline;\n    }\n  `}\n`;\nconst firstStyles = css `\n\tmargin-top: 0;\n`;\nconst activeStyles = css `\n\tfont-weight: bold;\n\n\t:after {\n\t\tcontent: '';\n\t\tborder: 2px solid ${schemedPalette('--discussion-accent-text')};\n\t\tborder-top: 0px;\n\t\tborder-right: 0px;\n\t\tposition: absolute;\n\t\ttop: 12px;\n\t\tright: 12px;\n\t\twidth: 8px;\n\t\theight: 4px;\n\t\ttransform: rotate(-45deg);\n\t}\n`;\nconst buttonStyles = css `\n\t${textSans15};\n\t/**\n\t * Typography preset styles should not be overridden.\n\t * This has been done because the styles do not directly map to the new presets.\n\t * Please speak to your team's designer and update this to use a more appropriate preset.\n\t */\n\tfont-weight: 500;\n\tdisplay: block;\n\tcursor: pointer;\n\tbackground: none;\n\tborder: none;\n\t/* Design System: The buttons should be components that handle their own layout using primitives  */\n\tline-height: 1.2;\n\tcolor: ${schemedPalette('--discussion-subdued')};\n\ttransition: color 80ms ease-out;\n\tpadding: 0px 10px 6px 0px;\n\tmargin: 1px 0 0;\n\ttext-decoration: none;\n\n\t:hover {\n\t\t:after {\n\t\t\ttransform: translateY(0) rotate(45deg);\n\t\t}\n\t}\n\n\t:after {\n\t\tcontent: '';\n\t\tdisplay: inline-block;\n\t\twidth: 5px;\n\t\theight: 5px;\n\t\ttransform: translateY(-2px) rotate(45deg);\n\t\tborder: 1px solid currentColor;\n\t\tborder-left: transparent;\n\t\tborder-top: transparent;\n\t\tmargin-left: 5px;\n\t\tvertical-align: middle;\n\t\ttransition: transform 250ms ease-out;\n\t}\n`;\nconst expandedStyles = css `\n\t:hover:after {\n\t\ttransform: translateY(-1px) rotate(-135deg);\n\t}\n\t:after {\n\t\ttransform: translateY(1px) rotate(-135deg);\n\t}\n`;\nconst labelStyles = css `\n\t${textSansBold15};\n\tcolor: ${schemedPalette('--discussion-subdued')};\n`;\nexport const Dropdown = ({ id, label, options, onSelect }) => {\n    const [isExpanded, setIsExpanded] = useState(false);\n    useEffect(() => {\n        const dismissOnEsc = (event) => {\n            if (isExpanded && event.code === 'Escape') {\n                setIsExpanded(false);\n            }\n        };\n        document.addEventListener('keydown', dismissOnEsc, false);\n        // Remove listener on unmount\n        return () => document.removeEventListener('keydown', dismissOnEsc);\n    }, [isExpanded]);\n    useEffect(() => {\n        const dismissOnClick = (event) => {\n            if (isExpanded) {\n                event.stopPropagation();\n                setIsExpanded(false);\n            }\n        };\n        document.addEventListener('click', dismissOnClick, false);\n        // Remove listener on unmount\n        return () => document.removeEventListener('click', dismissOnClick);\n    }, [isExpanded]);\n    // needs to be unique to allow multiple dropdowns on same page\n    // this should be unique because JS is single-threaded\n    const dropdownID = `dropbox-id-${id}`;\n    const activeLink = options.find((option) => option.isActive);\n    return (_jsxs(\"div\", { css: containerStyles, children: [_jsxs(\"div\", { css: labelStyles, children: [label, _jsx(\"button\", { onClick: () => setIsExpanded(!isExpanded), css: [buttonStyles, isExpanded && expandedStyles], \"aria-controls\": dropdownID, \"aria-expanded\": isExpanded ? 'true' : 'false', type: \"button\", children: activeLink ? activeLink.title : 'Please select' })] }), _jsx(\"ul\", { id: dropdownID, css: [ulStyles, isExpanded && ulExpanded], children: options.map((option, index) => (_jsx(\"li\", { children: _jsx(\"button\", { onClick: () => onSelect(option.value), css: [\n                            linkStyles(!!option.disabled),\n                            option.isActive && activeStyles,\n                            index === 0 && firstStyles,\n                        ], disabled: !!option.isActive || !!option.disabled, type: \"button\", children: option.title }) }, option.title))) })] }));\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { space } from '@guardian/source/foundations';\nimport { palette as schemedPalette } from '../../palette';\nimport { Dropdown } from './Dropdown';\nconst filterBar = css `\n\tpadding-top: ${space[1]}px;\n\tpadding-bottom: ${space[2]}px;\n\n\tborder-top: 1px solid ${schemedPalette('--discussion-border')};\n\n\tdisplay: flex;\n\tflex-direction: row;\n`;\nconst dividerStyles = css `\n\tposition: relative;\n\tmargin-left: ${space[2]}px;\n\t:after {\n\t\tcontent: '';\n\t\tdisplay: block;\n\t\twidth: 1px;\n\t\tbackground-color: ${schemedPalette('--discussion-border')};\n\t\tposition: absolute;\n\t\ttop: -${space[1]}px;\n\t\tbottom: ${space[1]}px;\n\t\tleft: -${space[2]}px;\n\t}\n`;\nconst filterPadding = css `\n\tpadding-right: ${space[3]}px;\n`;\nexport const Filters = ({ filters, onFilterChange, topLevelCommentCount, }) => (_jsxs(\"div\", { id: \"comment-filters\", css: filterBar, children: [_jsx(\"div\", { css: filterPadding, children: _jsx(Dropdown, { id: \"order-by-dropdown\", label: \"Sort by\", options: [\n                    {\n                        title: 'Newest',\n                        value: 'newest',\n                        isActive: filters.orderBy === 'newest',\n                    },\n                    {\n                        title: 'Oldest',\n                        value: 'oldest',\n                        isActive: filters.orderBy === 'oldest',\n                    },\n                    {\n                        title: 'Recommendations',\n                        value: 'recommendations',\n                        isActive: filters.orderBy === 'recommendations',\n                    },\n                ], onSelect: (value) => onFilterChange({\n                    ...filters,\n                    orderBy: value,\n                }) }) }), _jsx(\"div\", { css: dividerStyles }), _jsx(\"div\", { css: filterPadding, children: _jsx(Dropdown, { id: \"page-size-dropdown\", label: \"Per page\", options: [\n                    {\n                        title: '25',\n                        value: '25',\n                        disabled: topLevelCommentCount <= 25,\n                        isActive: filters.pageSize === 25,\n                    },\n                    {\n                        title: '50',\n                        value: '50',\n                        disabled: topLevelCommentCount <= 50,\n                        isActive: filters.pageSize === 50,\n                    },\n                    {\n                        title: '100',\n                        value: '100',\n                        disabled: topLevelCommentCount <= 100,\n                        isActive: filters.pageSize === 100,\n                    },\n                ], onSelect: (value) => onFilterChange({\n                    ...filters,\n                    pageSize: parseInt(value),\n                }) }) }), _jsx(\"div\", { css: dividerStyles }), _jsx(\"div\", { css: filterPadding, children: _jsx(Dropdown, { id: \"threads-dropdown\", label: \"Display threads\", options: [\n                    {\n                        title: 'Collapsed',\n                        value: 'collapsed',\n                        isActive: filters.threads === 'collapsed',\n                    },\n                    {\n                        title: 'Expanded',\n                        value: 'expanded',\n                        isActive: filters.threads === 'expanded',\n                    },\n                    {\n                        title: 'Unthreaded',\n                        value: 'unthreaded',\n                        isActive: filters.threads === 'unthreaded',\n                    },\n                ], onSelect: (value) => onFilterChange({\n                    ...filters,\n                    threads: value,\n                }) }) })] }));\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css, keyframes } from '@emotion/react';\nimport { isUndefined } from '@guardian/libs';\nimport { space } from '@guardian/source/foundations';\nimport { palette as schemedPalette } from '../../palette';\nimport { Column } from './Column';\nimport { Row } from './Row';\nconst BACKGROUND_COLOUR = schemedPalette('--discussion-loading-background');\nconst shimmer = keyframes `\n  0% {\n    background-position: -1500px 0;\n  }\n  100% {\n    background-position: 1500px 0;\n  }\n`;\nconst shimmerStyles = css `\n\tanimation: ${shimmer} 2s infinite linear;\n\tbackground: linear-gradient(\n\t\tto right,\n\t\t${BACKGROUND_COLOUR} 4%,\n\t\t${schemedPalette('--discussion-loading-shimmer')} 25%,\n\t\t${BACKGROUND_COLOUR} 36%\n\t);\n\tbackground-size: 1500px 100%;\n`;\nconst containerStyles = css `\n\tborder-bottom: 1px solid ${schemedPalette('--discussion-border')};\n\twidth: 620px;\n\tdisplay: flex;\n\tpadding: ${space[2]}px 0;\n`;\nconst avatarStyles = (size) => css `\n\tborder-radius: ${size + 10}px;\n\twidth: ${size}px;\n\theight: ${size}px;\n\tbackground-color: ${BACKGROUND_COLOUR};\n\tmargin-right: ${space[2]}px;\n\n\t${shimmerStyles}\n`;\nconst Grey = ({ height, width, spaceBelow, spaceLeft, }) => (_jsx(\"div\", { css: css `\n\t\t\theight: ${height}px;\n\t\t\twidth: ${!isUndefined(width) && width !== 0 && !isNaN(width)\n        ? `${width}px`\n        : '100%'};\n\t\t\tmargin-bottom: ${spaceBelow && space[spaceBelow]}px;\n\t\t\tmargin-left: ${spaceLeft && space[spaceLeft]}px;\n\t\t\tbackground-color: ${BACKGROUND_COLOUR};\n\n\t\t\t${shimmerStyles}\n\t\t` }));\nexport const LoadingComments = () => (_jsxs(\"div\", { css: containerStyles, \"data-testid\": \"loading-comments\", children: [_jsx(\"div\", { css: avatarStyles(48) }), _jsxs(Column, { children: [_jsxs(Row, { children: [_jsx(Grey, { height: 20, width: 140, spaceBelow: 9 }), _jsx(Grey, { height: 15, width: 100, spaceBelow: 9, spaceLeft: 2 })] }), _jsx(Grey, { height: 20, spaceBelow: 1 }), _jsx(Grey, { height: 20, spaceBelow: 1 }), _jsx(Grey, { height: 20, width: 200, spaceBelow: 5 }), _jsxs(Row, { children: [_jsx(Grey, { height: 15, width: 40 }), _jsx(Grey, { height: 15, width: 40, spaceLeft: 6 })] })] })] }));\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { space, textSans15, textSansBold15, until, } from '@guardian/source/foundations';\nimport { Button, SvgChevronLeftSingle, SvgChevronRightSingle, } from '@guardian/source/react-components';\nimport { palette as schemedPalette } from '../../palette';\nconst pageButtonStyles = (isSelected) => css `\n\tcursor: pointer;\n\t${textSansBold15}\n\n\ttext-decoration: none;\n\tborder-radius: 62.5rem;\n\tbox-sizing: border-box;\n\n\tcolor: ${isSelected\n    ? schemedPalette('--discussion-pagination-background')\n    : schemedPalette('--discussion-pagination-text')};\n\tbackground-color: ${isSelected\n    ? schemedPalette('--discussion-pagination-text')\n    : 'transparent'};\n\tborder: none;\n\t:hover {\n\t\tborder-width: 0.0625rem;\n\t\tborder-style: solid;\n\t\tborder-color: ${schemedPalette('--discussion-pagination-text')};\n\t}\n\n\tmargin-right: 2px;\n\tpadding: 0 0.125rem;\n\tmin-width: 1.5rem;\n\ttext-align: center;\n\n\theight: 1.5rem;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n`;\nconst theme = {\n    borderTertiary: schemedPalette('--discussion-pagination-border'),\n    backgroundTertiaryHover: schemedPalette('--discussion-pagination-background'),\n    textTertiary: schemedPalette('--discussion-pagination-text'),\n};\nconst ellipsisStyles = css `\n\tline-height: 26px;\n\tmargin-right: 2px;\n`;\nconst wrapperStyles = css `\n\t${textSans15};\n\tcolor: ${schemedPalette('--discussion-pagination-text')};\n\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\tpadding: ${space[2]}px 0;\n\tborder-top: 1px solid ${schemedPalette('--discussion-pagination-border')};\n\t${until.mobileLandscape} {\n\t\tflex-direction: column;\n\t}\n`;\nconst paginationButtons = css `\n\tdisplay: flex;\n\tflex-direction: row;\n\theight: 25px;\n\n\tbutton:hover {\n\t\tborder-color: ${schemedPalette('--discussion-pagination-border-hover')};\n\t}\n`;\nconst paginationText = css `\n\t${textSans15};\n\tmargin-left: 5px;\n\t${until.mobileLandscape} {\n\t\tpadding-top: 10px;\n\t}\n`;\nconst Forward = ({ currentPage, setCurrentPage, }) => (_jsx(Button, { onClick: () => setCurrentPage(currentPage + 1), \"data-link-name\": `Pagination view page ${currentPage + 1}`, size: \"xsmall\", priority: \"tertiary\", theme: theme, \n    // @TODO: These overrides should be removed once fixed upstream\n    cssOverrides: css `\n\t\t\t/* theme does not support Tertiary background */\n\t\t\tbackground-color: ${schemedPalette('--discussion-pagination-background')};\n\t\t\t/* the icon is not perfectly centred */\n\t\t\tsvg {\n\t\t\t\ttransform: translateX(1px);\n\t\t\t}\n\t\t`, icon: _jsx(SvgChevronRightSingle, { theme: { fill: schemedPalette('--discussion-pagination-text') } }), hideLabel: true, children: \"Previous discussion page\" }));\nconst Back = ({ currentPage, setCurrentPage, }) => (_jsx(Button, { onClick: () => setCurrentPage(currentPage - 1), \"data-link-name\": `Pagination view page ${currentPage - 1}`, size: \"xsmall\", priority: \"tertiary\", theme: theme, \n    // @TODO: These overrides should be removed once fixed upstream\n    cssOverrides: css `\n\t\t\t/* theme does not support Tertiary background */\n\t\t\tbackground-color: ${schemedPalette('--discussion-pagination-background')};\n\t\t\t/* the icon is not perfectly centred */\n\t\t\tsvg {\n\t\t\t\ttransform: translateX(-1px);\n\t\t\t}\n\t\t`, icon: _jsx(SvgChevronLeftSingle, { theme: { fill: schemedPalette('--discussion-pagination-text') } }), hideLabel: true, children: \"Previous discussion page\" }));\nconst PageButton = ({ currentPage, setCurrentPage, isSelected, }) => (_jsx(\"button\", { css: pageButtonStyles(isSelected), onClick: () => setCurrentPage(currentPage), \"data-link-name\": `Pagination view page ${currentPage}`, type: \"button\", children: currentPage }, currentPage));\nexport const getPages = (currentPage, totalPages) => {\n    if (totalPages <= 6) {\n        return [1, 2, 3, 4, 5, 6].filter((page) => page <= totalPages);\n    }\n    else if (currentPage <= 3) {\n        return [1, 2, 3, 4, '', totalPages];\n    }\n    else if (currentPage <= totalPages - 3) {\n        return [\n            1,\n            '',\n            currentPage - 1,\n            currentPage,\n            currentPage + 1,\n            '',\n            totalPages,\n        ];\n    }\n    else {\n        return [\n            1,\n            '',\n            totalPages - 3,\n            totalPages - 2,\n            totalPages - 1,\n            totalPages,\n        ];\n    }\n};\nexport const Pagination = ({ currentPage, setCurrentPage, topLevelCommentCount, filters, }) => {\n    const totalPages = Math.ceil(topLevelCommentCount / filters.pageSize);\n    // Make decisions about which pagination elements to show\n    const showBackButton = totalPages > 4 && currentPage > 1;\n    const showForwardButton = totalPages > 4 && currentPage !== totalPages;\n    // Pagination Text\n    const { pageSize } = filters;\n    /**\n     * Starting index of **1**\n     *\n     * For example, with a page size of 25, and 63 comments total:\n     * 1. from 1\n     * 2. from 26\n     * 3. from 51\n     */\n    const startIndex = 1 + pageSize * (currentPage - 1);\n    /**\n     * Starting index of **1**\n     *\n     * For example, with a page size of 25, and 63 comments total:\n     * 1. until 25\n     * 2. until 50\n     * 3. until 63\n     */\n    const endIndex = Math.min(pageSize * currentPage, topLevelCommentCount);\n    return (_jsxs(\"div\", { css: wrapperStyles, children: [_jsxs(\"div\", { css: paginationButtons, children: [showBackButton && (_jsx(Back, { currentPage: currentPage, setCurrentPage: setCurrentPage })), getPages(currentPage, totalPages).map((page, index) => page === '' ? (_jsx(\"div\", { css: ellipsisStyles, children: \"\\u2026\" }, index === 1 ? 'first-ellipsis' : 'last-ellipsis')) : (_jsx(PageButton, { currentPage: page, setCurrentPage: setCurrentPage, isSelected: page === currentPage }, `page-${page}`))), showForwardButton && (_jsx(Forward, { currentPage: currentPage, setCurrentPage: setCurrentPage }))] }), _jsx(\"div\", { css: paginationText, children: `Displaying ${filters.threads === 'unthreaded' ? 'comments' : 'threads'} ${startIndex} to ${endIndex} of ${topLevelCommentCount}` })] }));\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { from, space, textSans15 } from '@guardian/source/foundations';\nimport { Link } from '@guardian/source/react-components';\nimport { palette as schemedPalette } from '../../palette';\nimport { Avatar } from './Avatar';\nimport { GuardianContributor, GuardianStaff } from './Badges';\nimport { Column } from './Column';\nimport { RecommendationCount } from './RecommendationCount';\nimport { Row } from './Row';\nimport { Timestamp } from './Timestamp';\nconst pickStyles = css `\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 100%;\n\tmin-width: 250px;\n\tmargin-bottom: ${space[5]}px;\n\t${textSans15};\n\n\tblockquote {\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t\tmargin-left: ${space[5]}px;\n\t\tmargin-right: ${space[5]}px;\n\t\tpadding-left: ${space[2]}px;\n\t\tcolor: ${schemedPalette('--discussion-subdued')};\n\t}\n`;\nconst arrowSize = 25;\nconst userNameStyles = css `\n\tmargin-top: 3px;\n\tmargin-bottom: -6px;\n\tfont-weight: bold;\n\tcolor: ${schemedPalette('--discussion-accent-text')};\n`;\nconst avatarMargin = css `\n\tmargin-right: ${space[2]}px;\n`;\nconst smallFontSize = css `\n\ta {\n\t\t${textSans15}\n\t}\n`;\nconst linkStyles = css `\n\tcolor: ${schemedPalette('--discussion-top-pick-link')};\n\ttext-decoration: none;\n\t:hover {\n\t\ttext-decoration: underline;\n\t\tcolor: ${schemedPalette('--discussion-top-pick-link')};\n\t}\n`;\nconst jumpToLinkStyles = css `\n\tcolor: ${schemedPalette('--discussion-top-pick-link')};\n\t:hover {\n\t\tcolor: ${schemedPalette('--discussion-top-pick-link')};\n\t}\n`;\n// to override a tag styles from dangerouslySetInnerHTML\nconst inCommentLinkStyling = css `\n\ta {\n\t\tcolor: ${schemedPalette('--discussion-top-pick-link')};\n\t\ttext-decoration: none;\n\t\t:hover {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n`;\nconst titleStyles = css `\n\t${textSans15};\n\tfont-weight: bold;\n\tmargin: 0px;\n\tmargin-bottom: ${space[1]}px;\n`;\nconst inheritColour = css `\n\tcolor: inherit;\n`;\nconst wrapStyles = css `\n\tword-break: break-word;\n`;\nconst PickBubble = ({ children }) => (_jsx(\"div\", { css: css `\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: space-between;\n\n\t\t\tpadding: ${space[3]}px;\n\t\t\tbackground-color: ${schemedPalette('--discussion-top-pick-background')};\n\t\t\tborder-radius: 15px;\n\t\t\tmargin-bottom: ${arrowSize + 5}px;\n\t\t\tposition: relative;\n\n\t\t\t${from.tablet} {\n\t\t\t\tmin-height: 150px;\n\t\t\t}\n\n\t\t\t:before {\n\t\t\t\tcontent: '';\n\t\t\t\tmargin-left: ${space[6]}px;\n\t\t\t\tposition: absolute;\n\t\t\t\tborder-right: ${arrowSize}px solid transparent;\n\t\t\t\tborder-top: ${arrowSize}px solid\n\t\t\t\t\t${schemedPalette('--discussion-top-pick-background')};\n\t\t\t\tbottom: -${arrowSize - 1}px;\n\t\t\t}\n\n\t\t\tp {\n\t\t\t\tmargin-top: 0;\n\t\t\t\tmargin-bottom: ${space[3]}px;\n\t\t\t}\n\t\t`, children: children }));\nconst Top = ({ children }) => (_jsx(\"div\", { children: children }));\nconst Bottom = ({ children }) => (_jsx(\"div\", { children: children }));\nconst PickMeta = ({ children }) => (_jsx(\"div\", { css: css `\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\tpadding-top: ${space[1]}px;\n\t\t`, children: children }));\nconst truncateText = (input, limit) => {\n    // If input greater than limit trucate by limit and append an ellipsis\n    if (input.length > limit)\n        return input.substr(0, limit) + '&#8230;';\n    return input;\n};\nexport const TopPick = ({ comment, user, userMadeComment, onPermalinkClick, isClosedForRecommendations, }) => {\n    const showStaffBadge = comment.userProfile.badge.some((obj) => obj['name'] === 'Staff');\n    const showContributorBadge = comment.userProfile.badge.some((obj) => obj['name'] === 'Contributor');\n    return (_jsxs(\"div\", { css: pickStyles, children: [_jsxs(PickBubble, { children: [_jsxs(Top, { children: [_jsx(\"h3\", { css: titleStyles, children: \"Guardian Pick\" }), _jsx(\"p\", { css: [wrapStyles, inCommentLinkStyling], dangerouslySetInnerHTML: {\n                                    __html: truncateText(comment.body, 450),\n                                } })] }), _jsx(Bottom, { children: _jsx(\"div\", { css: smallFontSize, children: _jsx(Link, { priority: \"primary\", href: comment.webUrl, cssOverrides: jumpToLinkStyles, onClick: (e) => {\n                                    onPermalinkClick(comment.id);\n                                    e.preventDefault();\n                                }, rel: \"nofollow\", children: \"Jump to comment\" }) }) })] }), _jsxs(PickMeta, { children: [_jsxs(Row, { children: [_jsx(\"div\", { css: avatarMargin, children: _jsx(Avatar, { imageUrl: comment.userProfile.avatar, displayName: '', size: \"medium\" }) }), _jsxs(Column, { children: [_jsx(\"span\", { css: userNameStyles, children: _jsx(\"a\", { href: comment.userProfile.webUrl, css: [linkStyles, inheritColour], rel: \"nofollow\", children: comment.userProfile.displayName }) }), _jsx(Timestamp, { isoDateTime: comment.isoDateTime, webUrl: comment.webUrl, commentId: comment.id, onPermalinkClick: onPermalinkClick }), showStaffBadge && _jsx(GuardianStaff, {}), showContributorBadge && !showStaffBadge && (_jsx(GuardianContributor, {}))] })] }), _jsx(RecommendationCount, { commentId: comment.id, initialCount: comment.numRecommends, alreadyRecommended: false, user: user, userMadeComment: userMadeComment, isClosedForRecommendations: isClosedForRecommendations })] })] }));\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { from, until } from '@guardian/source/foundations';\nimport { TopPick } from './TopPick';\nconst columWrapperStyles = css `\n\twidth: 50%;\n\tdisplay: flex;\n\tflex-direction: column;\n`;\nconst paddingRight = css `\n\tpadding-right: 10px;\n`;\nconst paddingLeft = css `\n\tpadding-left: 10px;\n`;\nconst picksWrapper = css `\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n`;\nconst twoColCommentsStyles = css `\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: row;\n\t${until.tablet} {\n\t\tdisplay: none;\n\t}\n`;\nconst oneColCommentsStyles = css `\n\twidth: 100%;\n\t${from.tablet} {\n\t\tdisplay: none;\n\t}\n`;\nexport const TopPicks = ({ user, comments, onPermalinkClick, isClosedForRecommendations, }) => {\n    const leftColComments = [];\n    const rightColComments = [];\n    for (const [index, comment] of comments.entries()) {\n        index % 2 === 0\n            ? leftColComments.push(comment)\n            : rightColComments.push(comment);\n    }\n    return (_jsxs(\"div\", { css: picksWrapper, children: [_jsxs(\"div\", { css: twoColCommentsStyles, children: [_jsx(\"div\", { css: [columWrapperStyles, paddingRight], children: leftColComments.map((comment) => (_jsx(TopPick, { comment: comment, user: user, userMadeComment: user?.profile.userId ===\n                                comment.userProfile.userId, onPermalinkClick: onPermalinkClick, isClosedForRecommendations: isClosedForRecommendations }, comment.id))) }), _jsx(\"div\", { css: [columWrapperStyles, paddingLeft], children: rightColComments.map((comment) => (_jsx(TopPick, { comment: comment, user: user, userMadeComment: user?.profile.userId ===\n                                comment.userProfile.userId, onPermalinkClick: onPermalinkClick, isClosedForRecommendations: isClosedForRecommendations }, comment.id))) })] }), _jsx(\"div\", { css: oneColCommentsStyles, children: comments.map((comment) => (_jsx(TopPick, { comment: comment, userMadeComment: user?.profile.userId === comment.userProfile.userId, onPermalinkClick: onPermalinkClick, isClosedForRecommendations: isClosedForRecommendations }, comment.id))) })] }));\n};\n","import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { isString, isUndefined, storage } from '@guardian/libs';\nimport { space, textSans15 } from '@guardian/source/foundations';\nimport { useEffect, useState } from 'react';\nimport { getPicks, initialiseApi } from '../../lib/discussionApi';\nimport { palette as schemedPalette } from '../../palette';\nimport { useConfig } from '../ConfigContext';\nimport { useDispatch } from '../DispatchContext';\nimport { CommentContainer } from './CommentContainer';\nimport { CommentForm } from './CommentForm';\nimport { Filters } from './Filters';\nimport { LoadingComments } from './LoadingComments';\nimport { Pagination } from './Pagination';\nimport { TopPicks } from './TopPicks';\nconst footerStyles = css `\n\tdisplay: flex;\n\tjustify-content: flex-end;\n`;\nconst commentColumnWrapperStyles = css `\n\tdisplay: flex;\n\tflex-direction: column;\n\tmax-width: 100%;\n`;\nconst commentContainerStyles = css `\n\tdisplay: flex;\n\tflex-direction: column;\n\tlist-style-type: none;\n\tpadding-left: 0;\n\tmargin: 0;\n`;\nconst picksWrapper = css `\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tjustify-content: space-between;\n`;\nconst NoComments = () => (_jsx(\"div\", { css: css `\n\t\t\tcolor: ${schemedPalette('--discussion-subdued')};\n\t\t\t${textSans15}\n\t\t\tpadding-top: ${space[5]}px;\n\t\t\tpadding-left: ${space[1]}px;\n\t\t\tpadding-bottom: ${space[9]}px;\n\t\t`, children: \"No comments found\" }));\n/** Reads mutes from local storage, if available. */\nconst readMutes = () => {\n    const mutes = storage.local.get('gu.prefs.discussion.mutes') ?? [];\n    return Array.isArray(mutes) && mutes.every(isString) ? mutes : [];\n};\n/** Writes mutes to local storage. */\nconst writeMutes = (mutes) => {\n    storage.local.set('gu.prefs.discussion.mutes', mutes);\n};\n/** Dispatches a custom event which is handled by @guardian/commercial */\nconst dispatchCommentsStateChange = () => document.dispatchEvent(new CustomEvent('comments-state-change'));\nexport const Comments = ({ baseUrl, shortUrl, isClosedForComments, isClosedForRecommendations, commentToScrollTo, user, additionalHeaders, expanded, onPermalinkClick, apiKey, onPreview, idApiUrl, page, filters, topLevelCommentCount, loading, comments, topForm, replyForm, bottomForm, reportAbuse, }) => {\n    const [picks, setPicks] = useState([]);\n    const [commentBeingRepliedTo, setCommentBeingRepliedTo] = useState();\n    const [mutes, setMutes] = useState(readMutes());\n    const { renderingTarget } = useConfig();\n    const isWeb = renderingTarget === 'Web';\n    const dispatch = useDispatch();\n    const addComment = (comment) => {\n        dispatch({ type: 'addComment', comment });\n    };\n    const setPage = (newPage) => {\n        dispatch({\n            type: 'updateCommentPage',\n            commentPage: newPage,\n        });\n    };\n    const handleFilterChange = (newFilters, newPage) => {\n        dispatch({\n            type: 'filterChange',\n            filters: newFilters,\n            commentPage: newPage,\n        });\n    };\n    const setTopFormUserMissing = (userNameMissing) => dispatch({\n        type: 'setTopFormUserMissing',\n        userNameMissing,\n    });\n    const setReplyFormUserMissing = (userNameMissing) => dispatch({\n        type: 'setReplyFormUserMissing',\n        userNameMissing,\n    });\n    const setBottomFormUserMissing = (userNameMissing) => dispatch({\n        type: 'setBottomFormUserMissing',\n        userNameMissing,\n    });\n    const setTopFormError = (error) => dispatch({\n        type: 'setTopFormError',\n        error,\n    });\n    const setReplyFormError = (error) => dispatch({\n        type: 'setReplyFormError',\n        error,\n    });\n    const setBottomFormError = (error) => dispatch({\n        type: 'setBottomFormError',\n        error,\n    });\n    const setTopFormPreviewBody = (previewBody) => dispatch({\n        type: 'setTopFormPreviewBody',\n        previewBody,\n    });\n    const setReplyFormPreviewBody = (previewBody) => dispatch({\n        type: 'setReplyFormPreviewBody',\n        previewBody,\n    });\n    const setBottomFormPreviewBody = (previewBody) => dispatch({\n        type: 'setBottomFormPreviewBody',\n        previewBody,\n    });\n    const expandCommentReplies = (commentId, responses) => dispatch({\n        type: 'expandCommentReplies',\n        commentId,\n        responses,\n    });\n    const addReply = (comment) => {\n        dispatch({ type: 'addReply', comment });\n    };\n    useEffect(() => {\n        if (isWeb && expanded && !loading) {\n            const event = new CustomEvent('comments-loaded');\n            document.dispatchEvent(event);\n        }\n    }, [isWeb, expanded, loading]);\n    useEffect(() => {\n        void getPicks(shortUrl).then((result) => {\n            if (result.kind === 'error') {\n                console.error(result.error);\n                return;\n            }\n            setPicks(result.value);\n        });\n    }, [shortUrl]);\n    /**\n     * Verify if there is a comment to scroll to; if found, scroll to the corresponding div.\n     * This JavaScript is necessary because the comments list isn't initially loaded with the\n     * page and is added to the DOM later, following an API call.\n     * */\n    useEffect(() => {\n        if (isUndefined(commentToScrollTo))\n            return;\n        if (loading)\n            return;\n        document\n            .getElementById(`comment-${commentToScrollTo}`)\n            ?.scrollIntoView();\n    }, [commentToScrollTo, loading]);\n    const onFilterChange = (newFilterObject) => {\n        /**\n         * When decreasing the page size, we adjust the current page\n         * to avoid requesting non-existent pages. For example,\n         * if we had 102 comments with a page size of 25, and the current\n         * page was 5 (showing 2 comments), reducing the page size to 50 eliminates page 5.\n         * To respect the reader's preference to stay on the last page,\n         * we calculate and use the maximum possible page instead.\n         */\n        const maxPagePossible = Math.ceil(topLevelCommentCount / newFilterObject.pageSize);\n        if (page > maxPagePossible) {\n            handleFilterChange(newFilterObject, maxPagePossible);\n        }\n        else {\n            handleFilterChange(newFilterObject);\n        }\n        isWeb && dispatchCommentsStateChange();\n    };\n    useEffect(() => {\n        const element = document.getElementById('comment-filters');\n        element?.scrollIntoView();\n    }, [page]);\n    /** Remember updated mutes locally */\n    useEffect(() => {\n        writeMutes(mutes);\n    }, [mutes]);\n    const toggleMuteStatus = (userId) => {\n        const updatedMutes = mutes.includes(userId)\n            ? mutes.filter((id) => id !== userId) // Already muted, unmute them\n            : [...mutes, userId]; // Add this user to our list of mutes\n        setMutes(updatedMutes); // Update local state\n    };\n    const onAddComment = (comment) => {\n        if (comment.responses) {\n            addComment(comment);\n        }\n        else {\n            addReply(comment);\n        }\n        const commentElement = document.getElementById(`comment-${comment.id}`);\n        commentElement?.scrollIntoView();\n    };\n    const onPageChange = (pageNumber) => {\n        setPage(pageNumber);\n        isWeb && dispatchCommentsStateChange();\n    };\n    initialiseApi({ additionalHeaders, baseUrl, apiKey, idApiUrl });\n    const showPagination = topLevelCommentCount > filters.pageSize;\n    if (!expanded && loading) {\n        return _jsx(\"span\", { \"data-testid\": \"loading-comments\" });\n    }\n    if (!expanded) {\n        return (_jsx(\"div\", { \"data-component\": \"discussion\", css: commentContainerStyles, children: picks.length !== 0 ? (_jsx(\"div\", { css: picksWrapper, children: _jsx(TopPicks, { comments: picks.slice(0, 2), user: user, onPermalinkClick: onPermalinkClick, isClosedForRecommendations: isClosedForRecommendations }) })) : (_jsxs(_Fragment, { children: [_jsx(Filters, { filters: filters, onFilterChange: onFilterChange, topLevelCommentCount: topLevelCommentCount }), showPagination && (_jsx(Pagination, { currentPage: page, setCurrentPage: onPageChange, topLevelCommentCount: topLevelCommentCount, filters: filters })), !comments.length ? (_jsx(NoComments, {})) : (_jsx(\"ul\", { css: commentContainerStyles, children: comments.slice(0, 2).map((comment) => (_jsx(\"li\", { children: _jsx(CommentContainer, { comment: comment, isClosedForComments: isClosedForComments, isClosedForRecommendations: isClosedForRecommendations, shortUrl: shortUrl, user: user, threads: filters.threads, commentBeingRepliedTo: commentBeingRepliedTo, setCommentBeingRepliedTo: setCommentBeingRepliedTo, mutes: mutes, toggleMuteStatus: toggleMuteStatus, onPermalinkClick: onPermalinkClick, error: replyForm.error, setError: setReplyFormError, userNameMissing: replyForm.userNameMissing, setUserNameMissing: setReplyFormUserMissing, previewBody: replyForm.previewBody, setPreviewBody: setReplyFormPreviewBody, reportAbuse: reportAbuse, expandCommentReplies: expandCommentReplies, isExpanded: expanded }) }, comment.id))) }))] })) }));\n    }\n    return (_jsxs(\"div\", { \"data-component\": \"discussion\", css: commentColumnWrapperStyles, children: [user && !isClosedForComments && (_jsx(CommentForm, { shortUrl: shortUrl, onAddComment: onAddComment, user: user, onPreview: onPreview, error: topForm.error, setError: setTopFormError, userNameMissing: topForm.userNameMissing, setUserNameMissing: setTopFormUserMissing, previewBody: topForm.previewBody, setPreviewBody: setTopFormPreviewBody })), !!picks.length && (_jsx(TopPicks, { comments: picks, user: user, onPermalinkClick: onPermalinkClick, isClosedForRecommendations: isClosedForRecommendations })), _jsx(Filters, { filters: filters, onFilterChange: onFilterChange, topLevelCommentCount: topLevelCommentCount }), showPagination && (_jsx(Pagination, { currentPage: page, setCurrentPage: onPageChange, topLevelCommentCount: topLevelCommentCount, filters: filters })), loading ? (_jsx(LoadingComments, {})) : !comments.length ? (_jsx(NoComments, {})) : (_jsx(\"ul\", { css: [commentContainerStyles], \"data-commercial-id\": \"comments-column\", children: comments.map((comment) => (_jsx(\"li\", { children: _jsx(CommentContainer, { comment: comment, isClosedForComments: isClosedForComments, isClosedForRecommendations: isClosedForRecommendations, shortUrl: shortUrl, user: user, threads: filters.threads, commentBeingRepliedTo: commentBeingRepliedTo, setCommentBeingRepliedTo: setCommentBeingRepliedTo, commentToScrollTo: commentToScrollTo, mutes: mutes, toggleMuteStatus: toggleMuteStatus, onPermalinkClick: onPermalinkClick, error: replyForm.error, setError: setReplyFormError, userNameMissing: replyForm.userNameMissing, setUserNameMissing: setReplyFormUserMissing, previewBody: replyForm.previewBody, setPreviewBody: setReplyFormPreviewBody, reportAbuse: reportAbuse, expandCommentReplies: expandCommentReplies, isExpanded: expanded }) }, comment.id))) })), showPagination && (_jsx(\"footer\", { css: footerStyles, children: _jsx(Pagination, { currentPage: page, setCurrentPage: onPageChange, topLevelCommentCount: topLevelCommentCount, filters: filters }) })), user && !isClosedForComments && comments.length > 10 && (_jsx(CommentForm, { shortUrl: shortUrl, onAddComment: onAddComment, user: user, onPreview: onPreview, error: bottomForm.error, setError: setBottomFormError, userNameMissing: bottomForm.userNameMissing, setUserNameMissing: setBottomFormUserMissing, previewBody: bottomForm.previewBody, setPreviewBody: setBottomFormPreviewBody }))] }));\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { isUndefined, storage } from '@guardian/libs';\nimport { space } from '@guardian/source/foundations';\nimport { SvgPlus } from '@guardian/source/react-components';\nimport { useEffect, useReducer } from 'react';\nimport { assertUnreachable } from '../lib/assert-unreachable';\nimport { getCommentContext, getDiscussion, } from '../lib/discussionApi';\nimport { initFiltersFromLocalStorage } from '../lib/discussionFilters';\nimport { palette as themePalette } from '../palette';\nimport { Comments } from './Discussion/Comments';\nimport { PillarButton } from './Discussion/PillarButton';\nimport { DispatchProvider } from './DispatchContext';\nimport { Hide } from './Hide';\nimport { SignedInAs } from './SignedInAs';\nconst overlayStyles = css `\n\tbackground-image: linear-gradient(\n\t\t0deg,\n\t\t${themePalette('--discussion-section-background')},\n\t\t${themePalette('--discussion-section-background')} 40%,\n\t\ttransparent\n\t);\n\theight: 80px;\n\tposition: absolute;\n\tbottom: 0;\n\tright: 0;\n\twidth: 100%;\n\tdisplay: block;\n`;\nconst fixHeight = css `\n\tmax-height: 280px;\n\tmin-height: 280px;\n\toverflow: hidden;\n`;\nconst positionRelative = css `\n\tposition: relative;\n`;\nconst rememberFilters = ({ threads, pageSize, orderBy }) => {\n    storage.local.set('gu.prefs.discussion.threading', threads);\n    storage.local.set('gu.prefs.discussion.pagesize', pageSize);\n    storage.local.set('gu.prefs.discussion.order', orderBy);\n};\nconst commentIdFromUrl = () => {\n    const { hash } = window.location;\n    if (!hash.includes('comment'))\n        return;\n    const [, commentId] = hash.split('-');\n    if (!commentId)\n        return;\n    return commentId;\n};\n/**\n * If a permalink is used and the threading is set to collapsed, this function remaps the threading filter to expanded.\n * We do this to ensure that threads are expanded in the UI while respecting the user's local preference.\n */\nconst remapToValidFilters = (filters, hashCommentId) => {\n    const permalinkBeingUsed = !!hashCommentId;\n    if (!permalinkBeingUsed)\n        return filters;\n    if (filters.threads !== 'collapsed')\n        return filters;\n    return {\n        ...filters,\n        threads: 'expanded',\n    };\n};\n/**\n * Finds the matching comment for which to expand the replies,\n * and replaces its responses with a new list.\n\n * @example\n * ```txt\n * Comment ID: 1234\n *\n * Before\n *  1233\n *  1234\n *   0001\n *   0002\n *   0003\n *    (show 4 more replies)\n *  1235\n *\n * After\n *  1233\n *  1234\n *   0001\n *   0002\n *   0003\n *   0004\n *   0005\n *   0006\n *   0007\n *  1235\n * ```\n */\nexport const replaceMatchingCommentResponses = (action) => (comment) => comment.id === action.commentId\n    ? { ...comment, responses: action.responses }\n    : comment;\nconst initialCommentFormState = {\n    isActive: false,\n    userNameMissing: false,\n    error: '',\n    showPreview: false,\n    previewBody: '',\n    body: '',\n};\nconst initialState = {\n    comments: [],\n    isClosedForComments: false,\n    isClosedForRecommendation: false,\n    isExpanded: false,\n    commentPage: 1,\n    commentCount: undefined,\n    topLevelCommentCount: 0,\n    filters: initFiltersFromLocalStorage(),\n    hashCommentId: undefined,\n    loading: true,\n    topForm: initialCommentFormState,\n    replyForm: initialCommentFormState,\n    bottomForm: initialCommentFormState,\n};\nconst reducer = (state, action) => {\n    switch (action.type) {\n        case 'commentsLoaded':\n            return {\n                ...state,\n                comments: action.comments,\n                isClosedForComments: action.isClosedForComments,\n                isClosedForRecommendation: action.isClosedForRecommendation,\n                commentCount: action.commentCount,\n                topLevelCommentCount: action.topLevelCommentCount,\n                loading: false,\n            };\n        case 'addComment':\n            return {\n                ...state,\n                comments: [action.comment, ...state.comments],\n                isExpanded: true,\n            };\n        case 'addReply':\n            return {\n                ...state,\n                comments: state.comments.map((comment) => comment.responses &&\n                    comment.id === action.comment.responseTo.commentId\n                    ? {\n                        ...comment,\n                        responses: [\n                            ...comment.responses,\n                            action.comment,\n                        ],\n                    }\n                    : comment),\n                isExpanded: true,\n            };\n        case 'expandComments':\n            return {\n                ...state,\n                isExpanded: true,\n            };\n        case 'updateCommentPage':\n            return {\n                ...state,\n                commentPage: action.commentPage,\n                isExpanded: true,\n            };\n        case 'filterChange':\n            return {\n                ...state,\n                filters: action.filters,\n                hashCommentId: undefined,\n                isExpanded: true,\n                commentPage: action.commentPage ?? state.commentPage,\n            };\n        case 'setLoading': {\n            return {\n                ...state,\n                loading: action.loading,\n            };\n        }\n        case 'updateHashCommentId': {\n            return {\n                ...state,\n                hashCommentId: action.hashCommentId,\n                isExpanded: true,\n            };\n        }\n        case 'setTopFormUserMissing': {\n            return {\n                ...state,\n                topForm: {\n                    ...state.topForm,\n                    userNameMissing: action.userNameMissing,\n                },\n            };\n        }\n        case 'setReplyFormUserMissing': {\n            return {\n                ...state,\n                replyForm: {\n                    ...state.replyForm,\n                    userNameMissing: action.userNameMissing,\n                },\n            };\n        }\n        case 'setBottomFormUserMissing': {\n            return {\n                ...state,\n                bottomForm: {\n                    ...state.bottomForm,\n                    userNameMissing: action.userNameMissing,\n                },\n            };\n        }\n        case 'setTopFormPreviewBody': {\n            return {\n                ...state,\n                topForm: {\n                    ...state.topForm,\n                    previewBody: action.previewBody,\n                },\n            };\n        }\n        case 'setReplyFormPreviewBody': {\n            return {\n                ...state,\n                replyForm: {\n                    ...state.replyForm,\n                    previewBody: action.previewBody,\n                },\n            };\n        }\n        case 'setBottomFormPreviewBody': {\n            return {\n                ...state,\n                bottomForm: {\n                    ...state.bottomForm,\n                    previewBody: action.previewBody,\n                },\n            };\n        }\n        case 'setTopFormError': {\n            return {\n                ...state,\n                topForm: {\n                    ...state.topForm,\n                    error: action.error,\n                },\n            };\n        }\n        case 'setReplyFormError': {\n            return {\n                ...state,\n                replyForm: {\n                    ...state.replyForm,\n                    error: action.error,\n                },\n            };\n        }\n        case 'setBottomFormError': {\n            return {\n                ...state,\n                bottomForm: {\n                    ...state.bottomForm,\n                    error: action.error,\n                },\n            };\n        }\n        case 'expandCommentReplies': {\n            return {\n                ...state,\n                isExpanded: true,\n                comments: state.comments.map(replaceMatchingCommentResponses(action)),\n            };\n        }\n        default:\n            assertUnreachable(action);\n            return state;\n    }\n};\nexport const Discussion = ({ discussionApiUrl, shortUrlId, discussionD2Uid, discussionApiClientHeader, enableDiscussionSwitch, user, idApiUrl, reportAbuseUnauthenticated, }) => {\n    const [{ comments, isClosedForComments, isClosedForRecommendation, isExpanded, commentPage, filters, hashCommentId, loading, topForm, replyForm, bottomForm, topLevelCommentCount, commentCount, }, dispatch,] = useReducer(reducer, initialState);\n    useEffect(() => {\n        const newHashCommentId = commentIdFromUrl();\n        if (!isUndefined(newHashCommentId)) {\n            dispatch({\n                type: 'updateHashCommentId',\n                hashCommentId: newHashCommentId,\n            });\n        }\n    }, []);\n    useEffect(() => {\n        dispatch({ type: 'setLoading', loading: true });\n        const controller = new AbortController();\n        void getDiscussion({\n            shortUrl: shortUrlId,\n            page: commentPage,\n            filters: remapToValidFilters(filters, hashCommentId),\n            signal: controller.signal,\n        })\n            .then((result) => {\n            if (result.kind === 'error') {\n                if (result.error !== 'AbortedSignal') {\n                    console.error(`getDiscussion - error: ${result.error}`);\n                }\n                return;\n            }\n            const { discussion } = result.value;\n            dispatch({\n                type: 'commentsLoaded',\n                comments: discussion.comments,\n                isClosedForComments: discussion.isClosedForComments,\n                isClosedForRecommendation: discussion.isClosedForRecommendation,\n                topLevelCommentCount: discussion.topLevelCommentCount,\n                commentCount: discussion.commentCount,\n            });\n        })\n            .catch(() => {\n            // do nothing\n        });\n        return () => controller.abort();\n    }, [commentPage, filters, hashCommentId, shortUrlId]);\n    const validFilters = remapToValidFilters(filters, hashCommentId);\n    useEffect(() => {\n        rememberFilters(filters);\n    }, [filters]);\n    const handlePermalink = (commentId) => {\n        window.location.hash = `#comment-${commentId}`;\n        // Put this comment id into the hashCommentId state which will\n        // trigger an api call to get the comment context and then expand\n        // and reload the discussion based on the resuts\n        dispatch({ type: 'updateHashCommentId', hashCommentId: commentId });\n        return false;\n    };\n    // Check the url to see if there is a comment hash, e.g. ...crisis#comment-139113120\n    // If so, make a call to get the context of this comment so we know what page it is\n    // on.\n    useEffect(() => {\n        if (!isUndefined(hashCommentId)) {\n            getCommentContext(discussionApiUrl, hashCommentId, remapToValidFilters(filters, hashCommentId))\n                .then((context) => {\n                if (context.kind === 'ok') {\n                    dispatch({\n                        type: 'updateCommentPage',\n                        commentPage: context.value.page,\n                    });\n                }\n                else {\n                    console.error(`getCommentContext - error: ${context.error}`);\n                }\n            })\n                .catch((e) => console.error(`getCommentContext - error: ${String(e)}`));\n        }\n    }, [filters, discussionApiUrl, hashCommentId]);\n    useEffect(() => {\n        if (window.location.hash === '#comments') {\n            dispatch({ type: 'expandComments' });\n        }\n    }, []);\n    useEffect(() => {\n        // There's no point showing the view more button if there isn't much more to view\n        if (commentCount === 0 || commentCount === 1 || commentCount === 2) {\n            dispatch({ type: 'expandComments' });\n        }\n    }, [commentCount]);\n    return (_jsxs(DispatchProvider, { value: dispatch, children: [_jsxs(\"div\", { css: [positionRelative, !isExpanded && fixHeight], children: [_jsx(Hide, { when: \"above\", breakpoint: \"leftCol\", children: _jsx(\"div\", { \"data-testid\": \"discussion\", css: css `\n\t\t\t\t\t\t\tpadding-bottom: ${space[2]}px;\n\t\t\t\t\t\t`, children: _jsx(SignedInAs, { enableDiscussionSwitch: enableDiscussionSwitch, user: user?.profile, commentCount: commentCount, isClosedForComments: isClosedForComments }) }) }), _jsx(Comments, { user: user, baseUrl: discussionApiUrl, isClosedForComments: !!isClosedForComments || !enableDiscussionSwitch, isClosedForRecommendations: !!isClosedForRecommendation, shortUrl: shortUrlId, additionalHeaders: {\n                            'D2-X-UID': discussionD2Uid,\n                            'GU-Client': discussionApiClientHeader,\n                        }, expanded: isExpanded, commentToScrollTo: hashCommentId, onPermalinkClick: handlePermalink, apiKey: \"dotcom-rendering\", idApiUrl: idApiUrl, page: commentPage, filters: validFilters, topLevelCommentCount: topLevelCommentCount, loading: loading, comments: comments, topForm: topForm, replyForm: replyForm, bottomForm: bottomForm, reportAbuse: !isUndefined(user)\n                            ? user.reportAbuse\n                            : reportAbuseUnauthenticated }), !isExpanded && (_jsx(\"div\", { id: \"discussion-overlay\", css: overlayStyles }))] }), !isExpanded && (_jsx(PillarButton, { onClick: () => {\n                    dispatch({ type: 'expandComments' });\n                }, icon: _jsx(SvgPlus, {}), linkName: \"view-more-comments\", children: \"View more comments\" }))] }));\n};\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { from, until } from '@guardian/source/foundations';\nexport const Hide = ({ children, when, breakpoint, el, }) => {\n    let whenToHide;\n    if (when === 'below') {\n        whenToHide = css `\n\t\t\t${until[breakpoint]} {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t`;\n    }\n    else {\n        whenToHide = css `\n\t\t\t${from[breakpoint]} {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t`;\n    }\n    return el === 'li' ? (_jsx(\"li\", { css: whenToHide, children: children })) : (_jsx(\"span\", { css: whenToHide, children: children }));\n};\n","/**\n * A function that asserts it should never be called\n *\n * Useful for checking exhaustiveness of switch cases\n *\n * @see https://tinytip.co/tips/ts-switch-assert-unreachable/\n *\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars -- We don't actually use the value\nexport const assertUnreachable = (value) => {\n    throw new Error('This should be unreachable');\n};\n","import { isOneOf } from '@guardian/libs';\nimport { array, boolean, literal, merge, minLength, number, object, optional, picklist, safeParse, string, transform, undefined_, union, variant, } from 'valibot';\nimport { error, ok } from './result';\nconst userProfile = object({\n    userId: string(),\n    displayName: string(),\n    webUrl: string(),\n    apiUrl: string(),\n    avatar: string(),\n    secureAvatarUrl: string(),\n    badge: array(object({ name: string() })),\n    // only included from /profile/me endpoint\n    privateFields: optional(object({\n        canPostComment: boolean(),\n        isPremoderated: boolean(),\n        hasCommented: boolean(),\n    })),\n});\nexport const parseUserProfile = (data) => {\n    const result = safeParse(object({ status: literal('ok'), userProfile }), data);\n    if (!result.success) {\n        return error('ParsingError');\n    }\n    return ok(result.output.userProfile);\n};\nconst baseCommentSchema = object({\n    id: transform(union([number(), string()]), (id) => id.toString()),\n    body: string(),\n    date: string(),\n    isoDateTime: string(),\n    status: string(),\n    webUrl: string(),\n    apiUrl: string(),\n    numResponses: optional(number()),\n    numRecommends: number(),\n    isHighlighted: boolean(),\n    userProfile,\n    discussion: optional(object({\n        key: string(),\n        webUrl: string(),\n        apiUrl: string(),\n        title: string(),\n        isClosedForComments: boolean(),\n        isClosedForRecommendation: boolean(),\n    })),\n    metaData: optional(object({\n        commentCount: number(),\n        staffCommenterCount: number(),\n        editorsPickCount: number(),\n        blockedCount: number(),\n        responseCount: number(),\n    })),\n});\nconst replySchema = merge([\n    baseCommentSchema,\n    object({\n        responses: optional(undefined_(), undefined),\n        responseTo: object({\n            displayName: string(),\n            commentApiUrl: string(),\n            isoDateTime: string(),\n            date: string(),\n            commentId: string(),\n            commentWebUrl: string(),\n        }),\n    }),\n]);\nconst commentSchema = merge([\n    baseCommentSchema,\n    object({\n        responses: optional(array(replySchema), []),\n        responseTo: optional(undefined_(), undefined),\n    }),\n]);\nconst commentRepliesResponseSchema = variant('status', [\n    object({\n        status: literal('error'),\n    }),\n    object({\n        status: literal('ok'),\n        comment: commentSchema,\n    }),\n]);\nexport const parseRepliesResponse = (data) => {\n    const result = safeParse(commentRepliesResponseSchema, data);\n    if (!result.success) {\n        return error('ParsingError');\n    }\n    if (result.output.status === 'error') {\n        return error('ApiError');\n    }\n    return ok(result.output.comment.responses);\n};\nconst errorCodes = [\n    'USERNAME_MISSING',\n    'EMPTY_COMMENT_BODY',\n    'COMMENT_TOO_LONG',\n    'USER_BANNED',\n    'IP_THROTTLED',\n    'DISCUSSION_CLOSED',\n    'PARENT_COMMENT_MODERATED',\n    'COMMENT_RATE_LIMIT_EXCEEDED',\n    'INVALID_PROTOCOL',\n    'AUTH_COOKIE_INVALID',\n    'READ-ONLY-MODE',\n    'API_CORS_BLOCKED',\n    'API_ERROR',\n    'EMAIL_NOT_VALIDATED',\n];\nconst commentResponseSchema = variant('status', [\n    object({\n        status: literal('error'),\n        errorCode: picklist(errorCodes),\n    }),\n    object({\n        status: literal('ok'),\n        // response.message is the id of the comment that was created on the server\n        message: string(),\n    }),\n]);\nexport const parseCommentResponse = (data) => {\n    const { success, output } = safeParse(commentResponseSchema, data);\n    if (!success) {\n        return error('ParsingError');\n    }\n    if (output.status === 'error') {\n        return error(output.errorCode);\n    }\n    return ok(output.message);\n};\nconst abuseResponseSchema = variant('status', [\n    object({\n        status: literal('error'),\n        message: string(),\n    }),\n    object({\n        status: literal('ok'),\n    }),\n]);\nexport const parseAbuseResponse = (data) => {\n    const { success, output } = safeParse(abuseResponseSchema, data);\n    if (!success) {\n        return error('An unknown error occured');\n    }\n    return output.status === 'ok' ? ok(true) : error(output.message);\n};\nexport const postUsernameResponseSchema = variant('status', [\n    object({\n        status: literal('error'),\n        errors: array(object({\n            message: string(),\n        }), [minLength(1)]),\n    }),\n    object({\n        status: literal('ok'),\n    }),\n]);\nconst orderBy = ['newest', 'oldest', 'recommendations'];\nexport const isOrderBy = isOneOf(orderBy);\nconst threads = ['collapsed', 'expanded', 'unthreaded'];\nexport const isThreads = isOneOf(threads);\nconst pageSize = [25, 50, 100];\nexport const isPageSize = isOneOf(pageSize);\nconst discussionApiErrorSchema = object({\n    status: literal('error'),\n    statusCode: number(),\n    message: string(),\n    errorCode: optional(string()),\n});\nconst discussionApiSuccessSchema = object({\n    status: literal('ok'),\n    currentPage: number(),\n    pages: number(),\n    pageSize: number(),\n    orderBy: string(),\n    discussion: object({\n        key: string(),\n        webUrl: string(),\n        apiUrl: string(),\n        commentCount: number(),\n        topLevelCommentCount: optional(number(), 0),\n        isClosedForComments: boolean(),\n        isClosedForRecommendation: boolean(),\n        isThreaded: boolean(),\n        title: string(),\n        comments: array(union([replySchema, commentSchema])),\n    }),\n});\nexport const discussionApiResponseSchema = variant('status', [\n    discussionApiErrorSchema,\n    discussionApiSuccessSchema,\n]);\nexport const pickResponseSchema = object({\n    status: literal('ok'),\n    statusCode: literal(200),\n    message: string(),\n});\nconst recommendResponseSchema = object({\n    status: literal('ok'),\n    statusCode: literal(200),\n});\nexport const parseRecommendResponse = (data) => {\n    const { success } = safeParse(recommendResponseSchema, data);\n    return success ? ok(true) : error('ParsingError');\n};\nexport const getCommentContextResponseSchema = object({\n    status: literal('ok'),\n    commentId: number(),\n    commentAncestorId: number(),\n    discussionKey: string(),\n    discussionWebUrl: string(),\n    discussionApiUrl: string(),\n    orderBy: picklist(orderBy),\n    pageSize: picklist(pageSize),\n    page: number(),\n});\n/** for development purposes only! */\nexport const stubUser = {\n    kind: 'Reader',\n    addUsername: () => Promise.resolve(error('This is a stub user')),\n    onComment: () => Promise.resolve(ok(String(Number.MAX_SAFE_INTEGER - Math.ceil(Math.random() * 12_000)))),\n    onRecommend: () => Promise.resolve(true),\n    onReply: () => Promise.resolve(error('API_ERROR')),\n    reportAbuse: () => Promise.resolve(error('Invalid')),\n    profile: {\n        userId: 'stub-user-000',\n        displayName: 'Stub User',\n        webUrl: '',\n        apiUrl: '',\n        avatar: '',\n        secureAvatarUrl: '',\n        badge: [],\n        privateFields: {\n            canPostComment: true,\n            isPremoderated: false,\n            hasCommented: true,\n        },\n    },\n};\n","import { error, ok } from './result';\n/**\n * Safely fetch JSON from a URL.\n *\n * If successful, the value is typed as `unknown`.\n */\nexport const fetchJSON = async (...args) => {\n    try {\n        const response = await fetch(...args);\n        return ok(await response.json());\n    }\n    catch (err) {\n        if (err instanceof SyntaxError) {\n            return error('ApiError');\n        }\n        return error('NetworkError');\n    }\n};\n","import { isObject, isString, joinUrl } from '@guardian/libs';\nimport { safeParse } from 'valibot';\nimport { discussionApiResponseSchema, getCommentContextResponseSchema, parseAbuseResponse, parseCommentResponse, parseRecommendResponse, parseRepliesResponse, pickResponseSchema, postUsernameResponseSchema, } from './discussion';\nimport { getOptionsHeadersWithOkta } from './identity';\nimport { fetchJSON } from './json';\nimport { error, ok } from './result';\nconst options = {\n    // Defaults\n    baseUrl: 'https://discussion.theguardian.com/discussion-api',\n    apiKey: 'discussion-rendering',\n    headers: {},\n    idApiUrl: 'https://idapi.theguardian.com',\n};\nconst defaultParams = {\n    'api-key': options.apiKey,\n};\nexport const initialiseApi = ({ baseUrl, additionalHeaders, apiKey, idApiUrl, }) => {\n    options.baseUrl = baseUrl || options.baseUrl;\n    options.headers = additionalHeaders;\n    options.apiKey = apiKey || options.apiKey;\n    options.idApiUrl = idApiUrl || options.idApiUrl;\n    defaultParams['api-key'] = options.apiKey;\n};\nconst objAsParams = (obj) => {\n    const params = Object.keys(obj)\n        .map((key) => {\n        // TODO: Refactor this for better typesafety. See https://github.com/guardian/dotcom-rendering/pull/8057/commits/da4667399d4a7726589f1944ac60380f1f3f36e1\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/restrict-template-expressions -- type issues here cannot be avoided with this implementation\n        return `${key}=${obj[key]}`;\n    })\n        .join('&');\n    return '?' + params;\n};\n//todo: figure out the different return types and consider error handling\nexport const getDiscussion = async ({ shortUrl, page, filters, signal, }) => {\n    const apiOpts = {\n        ...defaultParams,\n        ...{\n            // Frontend uses the 'recommendations' key to store this options but the api expects\n            // 'mostRecommended' so we have to map here to support both\n            orderBy: filters.orderBy === 'recommendations'\n                ? 'mostRecommended'\n                : filters.orderBy,\n            pageSize: filters.pageSize,\n            displayThreaded: filters.threads !== 'unthreaded',\n            maxResponses: filters.threads === 'collapsed' ? 3 : 100,\n            page,\n        },\n    };\n    const params = objAsParams(apiOpts);\n    const url = joinUrl(options.baseUrl, 'discussion', shortUrl) + params;\n    const jsonResult = await fetchJSON(url, {\n        headers: options.headers,\n        signal,\n    });\n    if (jsonResult.kind === 'error') {\n        return signal.aborted ? error('AbortedSignal') : jsonResult;\n    }\n    const result = safeParse(discussionApiResponseSchema, jsonResult.value);\n    if (!result.success) {\n        return error('ParsingError');\n    }\n    if (result.output.status === 'error' &&\n        // We need force a refetch with unthreaded set, as we don't know\n        // that this discussion is only available in linear format until\n        // we get the response to tell us\n        result.output.errorCode === 'DISCUSSION_ONLY_AVAILABLE_IN_LINEAR_FORMAT') {\n        return getDiscussion({\n            shortUrl,\n            page,\n            filters: {\n                ...filters,\n                threads: 'unthreaded',\n            },\n            signal,\n        });\n    }\n    if (result.output.status === 'error') {\n        return error('ApiError');\n    }\n    return ok(result.output);\n};\nexport const preview = async (body) => {\n    const url = joinUrl(options.baseUrl, 'comment/preview') +\n        objAsParams(defaultParams);\n    const data = new URLSearchParams();\n    data.append('body', body);\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        body: data.toString(),\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n            ...options.headers,\n        },\n    });\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    return isObject(jsonResult.value) && isString(jsonResult.value.commentBody)\n        ? ok(jsonResult.value.commentBody)\n        : error('ParsingError');\n};\nexport const comment = (authStatus) => async (shortUrl, body) => {\n    const url = joinUrl(options.baseUrl, 'discussion', shortUrl, 'comment') +\n        objAsParams(defaultParams);\n    const data = new URLSearchParams();\n    data.append('body', body);\n    const authOptions = getOptionsHeadersWithOkta(authStatus);\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        body: data.toString(),\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n            ...options.headers,\n            ...authOptions.headers,\n        },\n        credentials: authOptions.credentials,\n    });\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    return parseCommentResponse(jsonResult.value);\n};\nexport const reply = (authStatus) => async (shortUrl, body, parentCommentId) => {\n    const url = joinUrl(options.baseUrl, 'discussion', shortUrl, 'comment', parentCommentId, 'reply') + objAsParams(defaultParams);\n    const data = new URLSearchParams();\n    data.append('body', body);\n    const authOptions = getOptionsHeadersWithOkta(authStatus);\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        body: data.toString(),\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n            ...options.headers,\n            ...authOptions.headers,\n        },\n        credentials: authOptions.credentials,\n    });\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    return parseCommentResponse(jsonResult.value);\n};\nexport const getPicks = async (shortUrl) => {\n    const url = joinUrl(options.baseUrl, 'discussion', shortUrl, 'topcomments') +\n        objAsParams(defaultParams);\n    const jsonResult = await fetchJSON(url, {\n        headers: {\n            ...options.headers,\n        },\n    });\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    const result = safeParse(discussionApiResponseSchema, jsonResult.value);\n    if (!result.success) {\n        return error('ParsingError');\n    }\n    if (result.output.status === 'error') {\n        return error('ApiError');\n    }\n    return ok(result.output.discussion.comments);\n};\nexport const reportAbuse = (authStatus) => async ({ commentId, categoryId, email, reason, }) => {\n    const url = joinUrl(options.baseUrl, 'comment', commentId, 'reportAbuse') +\n        objAsParams(defaultParams);\n    const data = new URLSearchParams();\n    data.append('categoryId', categoryId.toString());\n    email && data.append('email', email.toString());\n    reason && data.append('reason', reason);\n    const authOptions = authStatus\n        ? getOptionsHeadersWithOkta(authStatus)\n        : undefined;\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        body: data.toString(),\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n            ...options.headers,\n            ...authOptions?.headers,\n        },\n        credentials: authOptions?.credentials,\n    });\n    if (jsonResult.kind === 'error') {\n        return error('An unknown error occured');\n    }\n    return parseAbuseResponse(jsonResult.value);\n};\nexport const recommend = (authStatus) => async (commentId) => {\n    const url = joinUrl(options.baseUrl, 'comment', commentId, 'recommend') +\n        objAsParams(defaultParams);\n    const authOptions = getOptionsHeadersWithOkta(authStatus);\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        headers: {\n            ...options.headers,\n            ...(authOptions.headers ?? {}),\n        },\n        credentials: authOptions.credentials,\n    });\n    if (jsonResult.kind === 'error')\n        return false;\n    return parseRecommendResponse(jsonResult.value).kind === 'ok';\n};\nexport const addUserName = (authStatus) => async (userName) => {\n    const url = options.idApiUrl + `/user/me/username`;\n    const authOptions = getOptionsHeadersWithOkta(authStatus);\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        body: JSON.stringify({\n            publicFields: {\n                username: userName,\n                displayName: userName,\n            },\n        }),\n        headers: {\n            'Content-Type': 'application/json',\n            ...authOptions.headers,\n        },\n        credentials: authOptions.credentials,\n    });\n    if (jsonResult.kind === 'error') {\n        return jsonResult;\n    }\n    const result = safeParse(postUsernameResponseSchema, jsonResult.value);\n    if (!result.success) {\n        return error('An unknown error occured');\n    }\n    if (result.output.status === 'error') {\n        return error(result.output.errors.map(({ message }) => message).join('\\n'));\n    }\n    return ok(true);\n};\nexport const pickComment = (authStatus) => async (commentId) => {\n    const url = joinUrl(options.baseUrl, 'comment', commentId, 'highlight') +\n        objAsParams(defaultParams);\n    const authOptions = getOptionsHeadersWithOkta(authStatus);\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n            ...options.headers,\n            ...authOptions.headers,\n        },\n        credentials: authOptions.credentials,\n    });\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    const result = safeParse(pickResponseSchema, jsonResult.value);\n    if (!result.success)\n        return error('ParsingError');\n    return ok(true);\n};\nexport const unPickComment = (authStatus) => async (commentId) => {\n    const url = joinUrl(options.baseUrl, 'comment', commentId, 'unhighlight') +\n        objAsParams(defaultParams);\n    const authOptions = getOptionsHeadersWithOkta(authStatus);\n    const jsonResult = await fetchJSON(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n            ...options.headers,\n            ...authOptions.headers,\n        },\n        credentials: authOptions.credentials,\n    });\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    const result = safeParse(pickResponseSchema, jsonResult.value);\n    if (!result.success)\n        return error('ParsingError');\n    return ok(false);\n};\nexport const getAllReplies = async (commentId) => {\n    const url = joinUrl(options.baseUrl, 'comment', commentId) +\n        objAsParams({\n            ...defaultParams,\n            ...{\n                displayThreaded: true,\n                displayResponses: true,\n            },\n        });\n    const jsonResult = await fetchJSON(url, {\n        headers: {\n            ...options.headers,\n        },\n    });\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    return parseRepliesResponse(jsonResult.value);\n};\nconst buildParams = (filters) => {\n    return new URLSearchParams({\n        // Frontend uses the 'recommendations' key to store this options but the api expects\n        // 'mostRecommended' so we have to map here to support both\n        orderBy: filters.orderBy === 'recommendations'\n            ? 'mostRecommended'\n            : filters.orderBy,\n        pageSize: String(filters.pageSize),\n        displayThreaded: String(filters.threads === 'collapsed' || filters.threads === 'expanded'),\n    });\n};\nexport const getCommentContext = async (ajaxUrl, commentId, filters) => {\n    const url = joinUrl(ajaxUrl, 'comment', commentId, 'context');\n    const params = buildParams(filters);\n    const jsonResult = await fetchJSON(url + '?' + params.toString());\n    if (jsonResult.kind === 'error')\n        return jsonResult;\n    const result = safeParse(getCommentContextResponseSchema, jsonResult.value);\n    if (!result.success) {\n        return error('ParsingError');\n    }\n    return ok(result.output);\n};\n","const ok = (value) => ({\n    kind: 'ok',\n    value,\n});\nconst error = (err) => ({\n    kind: 'error',\n    error: err,\n});\nexport { ok, error };\n"],"names":["threadTypes","pageSizeTypes","DispatchContext","createContext","debug","DispatchProvider","_ref","value","children","_jsx","Provider","formWrapper","css","schemedPalette","space","textSans12","labelColour","errorColour","buttonStyles","errorBorderColour","borderColour","inputWrapper","svgStyles","errorSvgStyles","AbuseReportForm","commentId","toggleSetShowForm","reportAbuse","modalRef","useRef","firstElement","lastElement","useEffect","current","querySelector","_firstElement","focus","document","addEventListener","e","contains","target","keyListener","code","shiftKey","activeElement","preventDefault","removeEventListener","_useState","useState","categoryId","reason","email","_useState2","_slicedToArray","formVariables","setFormVariables","defaultErrorTexts","response","_useState3","_useState4","errors","setErrors","_useState5","_useState6","successMessage","setSuccessMessage","isReasonRequired","ref","_jsxs","onSubmit","event","then","kind","_objectSpread","error","catch","log","Select","label","onChange","Number","theme","textLabel","textOptional","textError","borderError","undefined","Option","TextArea","id","size","optional","required","TextInput","type","Button","cssOverrides","InlineError","InlineSuccess","iconSide","icon","SvgCross","onClick","hideLabel","imageStyles","Avatar","_ref$imageUrl","imageUrl","displayName","src","alt","staffBadge","name","styles","iconStyles","labelText","textSansBold12","staffLabel","themePalette","guardianPickLabel","GuardianStaff","width","height","viewBox","fill","d","GuardianContributor","GuardianPick","Column","_ref2","rowStyles","Row","_ref$wrap","wrap","style","flexWrap","countStyles","recommended","isSignedIn","arrowStyles","RecommendationCount","initialCount","alreadyRecommended","user","userMadeComment","isClosedForRecommendations","count","setCount","setRecommended","newCount","onRecommend","accepted","disabled","SvgArrowUpStraight","dateFormatter","dateString","date","Date","timeStampYesterday","Math","round","getTime","isLast24Hrs","timeAgo","verbose","daysUntilAbsolute","concat","getDate","month","getMonthString","getMonth","getFullYear","getHours","String","getMinutes","padStart","linkStyles","timeStyles","Timestamp","callback","savedCallback","isoDateTime","webUrl","onPermalinkClick","setTimeAgo","setInterval","currentCallback","clearInterval","href","rel","dateTime","toString","commentControlsLink","textSansBold15","spaceBetween","commentCss","textSans15","remSpace","blockedCommentStyles","commentLinkStyling","commentWrapper","selectedStyles","avatarMargin","until","mobileLandscape","colourStyles","boldFont","regularFont","svgReplyArrow","commentDetails","headerStyles","iconWrapper","timestampWrapperStyles","hideBelowMobileLandscape","hideAboveMobileLandscape","from","negativeMargin","cssTextOverflowElip","cssReplyToWrapper","buttonLinkPillarBaseStyles","buttonLinkBaseStyles","subdued","cssReplyAlphaDisplayName","cssReplyBetaDisplayName","spacedColumnStyles","Space","_ref3","amount","Comment","_ref4","comment","isClosedForComments","setCommentBeingRepliedTo","isReply","wasScrolledTo","isMuted","toggleMuteStatus","isExpanded","isHighlighted","setIsHighlighted","showAbuseReportForm","setAbuseReportForm","pickError","setPickError","pick","_ref5","_asyncToGenerator","_regeneratorRuntime","_callee","staffUser","_context","prev","next","onPick","sent","stop","_x","apply","arguments","unPick","_ref6","_callee2","_context2","onUnpick","_x2","showStaffBadge","userProfile","badge","some","obj","showPickBadge","status","showContributorBadge","_Fragment","avatar","responseTo","Link","SvgIndent","numRecommends","profile","userId","priority","dangerouslySetInnerHTML","__html","body","createAuthenticationEventParams","buttonOverrides","PillarButton","_ref$priority","linkName","_ref$size","previewStyle","spout","Preview","previewHtml","showSpout","textStyling","Text","inputLabelStyles","textInputStyles","h3Style","headlineBold20","FirstCommentWelcome","_ref2$error","submitForm","cancelSubmit","previewBody","renderingTarget","useConfig","userName","setUserName","supporting","boldString","str","italicsString","strikethroughString","codeString","quoteString","commentTextArea","greyPlaceholder","blackPlaceholder","headerTextStyles","wrapperHeaderTextStyles","commentAddOns","preModMessage","preModLink","bottomContainer","wide","simulateNewComment","toISOString","apiUrl","responses","simulateNewReply","commentBeingRepliedTo","commentApiUrl","commentWebUrl","CommentForm","_user$profile$private","shortUrl","onAddComment","onPreview","setError","userNameMissing","setUserNameMissing","setPreviewBody","isActive","setIsActive","isDisabled","setIsDisabled","selectionStart","setSelectionStart","_useState7","_useState8","selectionEnd","setSelectionEnd","_useState9","_useState10","textValue","setTextValue","setBody","_document$getElementB","_document$querySelect","getElementById","scrollIntoView","getHighlightedString","startString","substring","highlightedString","endString","length","transformText","transfromFunc","textAreaStrings","fetchShowPreview","preview","abrupt","defaultPreview","handleError","commentError","resetForm","onReply","t0","onComment","submitUserName","_callee3","_context3","addUsername","privateFields","isPremoderated","InfoSummary","message","context","placeholder","onFocus","onSelect","fontWeight","title","fontStyle","textDecoration","fontFamily","url","prompt","highlightedText","linkStringFunc","transformLink","trim","indentStyles","smallFontStyles","replyPreviewHeaderStyle","arrowSize","commentStyles","blueLink","CommentReplyPreview","displayReplyComment","setDisplayReplyComment","nestingStyles","topBorder","commentContainerStyles","removeMargin","CommentContainer","_comment$metaData$res","_comment$metaData","remainingResponses","threads","commentToScrollTo","mutes","expandCommentReplies","totalResponseCount","metaData","responseCount","expanded","loading","setLoading","showResponses","includes","map","responseComment","SvgPlus","getAllReplies","result","console","finally","find","_toConsumableArray","onAddReply","containerStyles","ulStyles","tablet","ulExpanded","firstStyles","activeStyles","expandedStyles","labelStyles","Dropdown","options","setIsExpanded","dismissOnEsc","dismissOnClick","stopPropagation","dropdownID","activeLink","option","index","filterBar","dividerStyles","filterPadding","Filters","filters","onFilterChange","topLevelCommentCount","orderBy","pageSize","parseInt","BACKGROUND_COLOUR","shimmer","keyframes","_templateObject","_taggedTemplateLiteral","shimmerStyles","Grey","spaceBelow","spaceLeft","isUndefined","isNaN","LoadingComments","pageButtonStyles","isSelected","borderTertiary","backgroundTertiaryHover","textTertiary","ellipsisStyles","wrapperStyles","paginationButtons","paginationText","Forward","currentPage","setCurrentPage","SvgChevronRightSingle","Back","SvgChevronLeftSingle","PageButton","getPages","totalPages","filter","page","Pagination","ceil","showBackButton","showForwardButton","startIndex","endIndex","min","pickStyles","userNameStyles","smallFontSize","jumpToLinkStyles","inCommentLinkStyling","titleStyles","inheritColour","wrapStyles","PickBubble","Top","Bottom","PickMeta","TopPick","input","substr","columWrapperStyles","paddingRight","paddingLeft","picksWrapper","twoColCommentsStyles","oneColCommentsStyles","TopPicks","_step","comments","leftColComments","rightColComments","_iterator","_createForOfIteratorHelper","entries","s","n","done","_step$value","push","err","f","footerStyles","commentColumnWrapperStyles","NoComments","dispatchCommentsStateChange","dispatchEvent","CustomEvent","Comments","baseUrl","additionalHeaders","apiKey","idApiUrl","topForm","replyForm","bottomForm","picks","setPicks","_storage$local$get","storage","local","get","Array","isArray","every","isString","readMutes","setMutes","isWeb","dispatch","useContext","handleFilterChange","newFilters","newPage","commentPage","setReplyFormUserMissing","setReplyFormError","setReplyFormPreviewBody","getPicks","newFilterObject","maxPagePossible","element","set","writeMutes","updatedMutes","addComment","addReply","commentElement","onPageChange","pageNumber","initialiseApi","showPagination","slice","overlayStyles","fixHeight","positionRelative","remapToValidFilters","hashCommentId","replaceMatchingCommentResponses","action","initialCommentFormState","showPreview","initialState","isClosedForRecommendation","commentCount","isOneOf","getThreadType","getPageSizeType","reducer","state","_action$commentPage","assertUnreachable","Discussion","discussionApiUrl","shortUrlId","discussionD2Uid","discussionApiClientHeader","enableDiscussionSwitch","reportAbuseUnauthenticated","_useReducer","useReducer","_useReducer2","_useReducer2$","newHashCommentId","hash","window","location","_hash$split","split","commentIdFromUrl","controller","AbortController","getDiscussion","signal","discussion","abort","validFilters","rememberFilters","getCommentContext","Hide","when","breakpoint","SignedInAs","whenToHide","el","Error","object","string","secureAvatarUrl","array","canPostComment","boolean","hasCommented","parseUserProfile","data","safeParse","literal","success","ok","output","baseCommentSchema","transform","union","number","numResponses","key","staffCommenterCount","editorsPickCount","blockedCount","replySchema","merge","undefined_","commentSchema","commentRepliesResponseSchema","variant","parseRepliesResponse","commentResponseSchema","errorCode","picklist","parseCommentResponse","_safeParse","abuseResponseSchema","parseAbuseResponse","_safeParse2","postUsernameResponseSchema","minLength","discussionApiErrorSchema","statusCode","discussionApiSuccessSchema","pages","isThreaded","discussionApiResponseSchema","pickResponseSchema","recommendResponseSchema","parseRecommendResponse","getCommentContextResponseSchema","commentAncestorId","discussionKey","discussionWebUrl","fetchJSON","_args","fetch","json","t1","t2","SyntaxError","headers","defaultParams","objAsParams","Object","keys","join","apiOpts","params","jsonResult","displayThreaded","maxResponses","joinUrl","aborted","URLSearchParams","append","method","isObject","commentBody","authStatus","authOptions","getOptionsHeadersWithOkta","credentials","_x3","_x4","reply","_callee4","parentCommentId","_context4","_x5","_x6","_x7","_ref7","_callee5","_context5","_x8","_ref9","_callee6","_ref8","_context6","_x9","recommend","_ref10","_callee7","_authOptions$headers","_context7","_x10","addUserName","_ref11","_callee8","_context8","JSON","stringify","publicFields","username","_ref12","_x11","pickComment","_ref13","_callee9","_context9","_x12","unPickComment","_ref14","_callee10","_context10","_x13","_ref15","_callee11","_context11","displayResponses","_x14","buildParams","_ref16","_callee12","ajaxUrl","_context12","_x15","_x16","_x17"],"sourceRoot":""}