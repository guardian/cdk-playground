(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[4767],{53579:(e,n,t)=>{"use strict";t.r(n),t.d(n,{EnhancePinnedPost:()=>s});var r=t(22820),o=t(14429),i=t(65656),u=t(67400),c=t(85918),a=t(88528),f=t(7693);var s=function(){var e=(0,u.useState)(null),n=(0,r.A)(e,2),t=n[0],s=n[1],l=(0,u.useState)(null),d=(0,r.A)(l,2),v=d[0],p=d[1],m=(0,u.useState)(null),y=(0,r.A)(m,2),b=y[0],g=y[1];(0,u.useEffect)((function(){s(document.querySelector("[data-gu-marker=pinned-post]")),p(document.querySelector("input[name=pinned-post-checkbox]")),g(document.querySelector("#collapsible-body"))}),[]);var h=(0,u.useState)(!1),E=(0,r.A)(h,2),_=E[0],S=E[1],O=(0,a.E)({threshold:.1,repeat:!0,node:null!=t?t:void 0}),w=(0,r.A)(O,1)[0],I=(0,f.U)().renderingTarget,T=(0,u.useRef)(),L=(0,u.useCallback)((function(){if(b&&v){var e=v.checked;!function(e,n){var t=document.querySelector("#pinned-post-button"),r=document.querySelector("#pinned-post-overlay");t&&(e?t.style.removeProperty("display"):n||(t.style.display="none")),r&&(e?r.style.removeProperty("display"):r.style.display="none")}(!(b.scrollHeight<=b.clientHeight),e)}}),[v,b]);return(0,u.useEffect)((function(){if(t){L();var e=new MutationObserver(L);return e.observe(t,{childList:!0,subtree:!0}),function(){return e.disconnect()}}}),[L,t]),(0,u.useEffect)((function(){if(t&&v){var e=function(){L(),function(e,n,t){e?(0,c.u_)({component:{componentType:"LIVE_BLOG_PINNED_POST",id:n.id},action:"CLICK",value:"show-more"},t):((0,c.u_)({component:{componentType:"LIVE_BLOG_PINNED_POST",id:n.id},action:"CLICK",value:"show-less"},t),function(e){e.getBoundingClientRect().top<0&&e.scrollIntoView({behavior:"smooth"})}(n))}(v.checked,t,I)};return v.addEventListener("change",e),function(){return v.removeEventListener("change",e)}}}),[L,t,v,I]),(0,u.useEffect)((function(){if(t)if(w)S(!0),T.current=(0,o.h)("dotcom","pinned-post-view-duration");else if(_){var e,n=null===(e=T.current)||void 0===e?void 0:e.endPerformanceMeasure();if(!(0,i.b)(n)){var r=n/1e3;(0,c.u_)({component:{componentType:"LIVE_BLOG_PINNED_POST",id:t.id},action:"VIEW",value:r.toString()},I)}}}),[w,_,I,t]),null}},88528:(e,n,t)=>{"use strict";t.d(n,{E:()=>c});var r=t(22820),o=t(44165),i=t.n(o),u=t(67400),c=function(e){var n,t=(0,u.useState)(!1),o=(0,r.A)(t,2),c=o[0],a=o[1],f=(0,u.useState)(null!==(n=e.node)&&void 0!==n?n:null),s=(0,r.A)(f,2),l=s[0],d=s[1],v=(0,u.useRef)(null),p=(0,u.useCallback)((function(n){var t=(0,r.A)(n,1)[0];t&&(t.isIntersecting?a(!0):e.repeat&&a(!1))}),[e.repeat]),m=e.debounce?i()(p,200):p;return(0,u.useEffect)((function(){e.node&&d(e.node)}),[e.node]),(0,u.useEffect)((function(){if(l&&"IntersectionObserver"in window)return v.current=new window.IntersectionObserver(m,e),v.current.observe(l),function(){var e;return null===(e=v.current)||void 0===e?void 0:e.disconnect()}}),[l,e,m]),(0,u.useEffect)((function(){var n;!e.repeat&&c&&(null===(n=v.current)||void 0===n||n.disconnect())}),[c,e.repeat]),[c,d]}},44165:(e,n,t)=>{var r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt,a="object"==typeof t.g&&t.g&&t.g.Object===Object&&t.g,f="object"==typeof self&&self&&self.Object===Object&&self,s=a||f||Function("return this")(),l=Object.prototype.toString,d=Math.max,v=Math.min,p=function(){return s.Date.now()};function m(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}function y(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==l.call(e)}(e))return NaN;if(m(e)){var n="function"==typeof e.valueOf?e.valueOf():e;e=m(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var t=i.test(e);return t||u.test(e)?c(e.slice(2),t?2:8):o.test(e)?NaN:+e}e.exports=function(e,n,t){var r,o,i,u,c,a,f=0,s=!1,l=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(n){var t=r,i=o;return r=o=void 0,f=n,u=e.apply(i,t)}function h(e){var t=e-a;return void 0===a||t>=n||t<0||l&&e-f>=i}function E(){var e=p();if(h(e))return _(e);c=setTimeout(E,function(e){var t=n-(e-a);return l?v(t,i-(e-f)):t}(e))}function _(e){return c=void 0,b&&r?g(e):(r=o=void 0,u)}function S(){var e=p(),t=h(e);if(r=arguments,o=this,a=e,t){if(void 0===c)return function(e){return f=e,c=setTimeout(E,n),s?g(e):u}(a);if(l)return c=setTimeout(E,n),g(a)}return void 0===c&&(c=setTimeout(E,n)),u}return n=y(n)||0,m(t)&&(s=!!t.leading,i=(l="maxWait"in t)?d(y(t.maxWait)||0,n):i,b="trailing"in t?!!t.trailing:b),S.cancel=function(){void 0!==c&&clearTimeout(c),f=0,r=a=o=c=void 0},S.flush=function(){return void 0===c?u:_(p())},S}}}]);
//# sourceMappingURL=EnhancePinnedPost-importable.client.web.legacy.e11aab08eb7ec7a5e690.js.map