"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[4490],{46649:(e,n,t)=>{t.r(n),t.d(n,{TopBarSupport:()=>_});var r=t(50484),o=t(24017),i=t(9474),a=t(18411),c=t(29995),u=t(67400),s=t(50026),l=t(36226),d=t(20522),g=t(14374),m=t(75747),f=t(40901),p=t(15593);function h(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function w(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){h(e,n,t[n])}))}return e}function b(){const e=(n=["\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\toverflow-wrap: nowrap;\n"],t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}})));var n,t;return b=function(){return e},e}const v=(0,o.css)(b()),y=e=>{let{countryCode:n,pageViewId:o,contributionsServiceUrl:m}=e;const[f,h]=(0,u.useState)(null),[b,y]=(0,u.useState)(null),_=(0,g.T)(),{renderingTarget:P}=(0,p.U)();return(0,u.useEffect)((()=>{if((0,i.b)(n)||"Pending"===_)return;const e=(0,l.h3)(_);if("Pending"===e)return;(0,d.q)();const r={tracking:{ophanPageId:o,platformId:"GUARDIAN_WEB",referrerUrl:window.location.origin+window.location.pathname,clientName:"dcr"},targeting:{showSupportMessaging:!e,countryCode:n,mvtId:Number((0,a.R)({name:"GU_mvt_id",shouldMemoize:!0})),purchaseInfo:(0,l.q6)(),isSignedIn:_}};(0,c._b)(m,r).then((e=>{if(!e.data)return null;const{module:n}=e.data;return h(n),("SignInPromptHeader"===n.name?Promise.all([t.e(4684),t.e(9288),t.e(7350)]).then(t.bind(t,77350)):Promise.all([t.e(4684),t.e(9288),t.e(342)]).then(t.bind(t,30342))).then((e=>{y((()=>{var t;return null!==(t=e[n.name])&&void 0!==t?t:null}))}))})).catch((e=>{const n="Error importing RR header links: ".concat(String(e));console.log(n),window.guardian.modules.sentry.reportError(new Error(n),"rr-header-links")}))}),[n,_,m,o]),null!==b&&f?(0,r.jsx)("div",{css:v,children:(0,r.jsx)(b,w({submitComponentEvent:e=>{(0,s.u_)(e,P)}},f.props))}):null},_=e=>{let{contributionsServiceUrl:n}=e;const{renderingTarget:t}=(0,p.U)(),o=(0,m.F)("support-the-Guardian"),a=(0,f.L)(t);return(0,i.b)(o)||(0,i.b)(a)?null:(0,r.jsx)(y,{countryCode:o,pageViewId:a,contributionsServiceUrl:n})}},36226:(e,n,t)=>{t.d(n,{Jj:()=>w,Pp:()=>s,VF:()=>l,Vi:()=>u,Xr:()=>y,_f:()=>P,h3:()=>g,mG:()=>v,mV:()=>h,n8:()=>_,q6:()=>O,tZ:()=>S,yw:()=>b});var r=t(18411),o=t(9474),i=t(61082),a=t(9092),c=t(67400);const u="gu_hide_support_messaging",s="gu_recurring_contributor",l="gu.contributions.contrib-timestamp",d="gu.noRRBanner",g=e=>{const n=(e=>{switch((0,r.R)({name:u})){case"true":return!0;case"false":return!1;default:return!!e&&"Pending"}})(e);return"Pending"===n?"Pending":n||(()=>{const e=(()=>{const e=(0,r.R)({name:l});if(e)return(e?parseInt(e,10):0)||void 0})();return!(0,o.b)(e)&&((e,n)=>{const t=Date.now()-e;return Math.floor(t/864e5)})(e)<=90})()},m=[1,3,7],f=[1,3,5,7],p=()=>null!==(0,r.R)({name:"gu_article_count_opt_out"}),h=()=>new Promise((e=>{(0,r.R)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,a.Ym)((n=>{let{usnat:t,tcfv2:r,aus:o}=n;if(null!=t?t:o)e(!0);else if(r){const n=m.every((e=>r.consents[e]));n||i.I.local.remove("gu.history.weeklyArticleCount"),e(n)}}))})),w=async()=>!await h()||p(),b=async()=>!await h()||p(),v=()=>{const[e,n]=(0,c.useState)("Pending");return(0,c.useEffect)((()=>{w().then(n).catch((()=>n(!0)))}),[]),e},y=()=>new Promise((e=>{(0,r.R)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,a.Ym)((n=>{let{usnat:t,tcfv2:r,aus:o}=n;if(null!=t?t:o)e(!0);else if(r){const n=f.every((e=>r.consents[e]));e(n)}}))})),_=()=>!!i.I.local.get(d),P=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return i.I.local.set(d,!0,e+12e5)},S=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return!!e&&n-new Date(e).getTime()<36e5},O=()=>{const e=(0,r.R)({name:"GU_CO_COMPLETE",shouldMemoize:!0});if(!e)return;let n;try{n=JSON.parse(decodeURIComponent(e))}catch(e){}return n}},20522:(e,n,t)=>{t.d(n,{q:()=>c});var r=t(24017),o=t(50484),i=t(67400);let a=!1;const c=()=>{a||(window.guardian.automat={emotionReact:r,emotionReactJsxRuntime:o,react:i.default},a=!0)}},14374:(e,n,t)=>{t.d(n,{T:()=>i,w:()=>a});var r=t(67400),o=t(97656);const i=()=>{switch(a().kind){case"Pending":return"Pending";case"SignedInWithCookies":case"SignedInWithOkta":return!0;case"SignedOutWithCookies":case"SignedOutWithOkta":return!1}},a=()=>{const[e,n]=(0,r.useState)({kind:"Pending"});return(0,r.useEffect)((()=>{(0,o.kU)((e=>{n((0,o.dx)(e))}),(()=>n((0,o.Hn)()))).catch((e=>{console.error(e)}))}),[]),e}},75747:(e,n,t)=>{t.d(n,{F:()=>a});var r=t(9786),o=t(67400),i=t(2899);const a=e=>{const[n,t]=(0,o.useState)();return(0,o.useEffect)((()=>{(0,i.C)().then((e=>{(0,r.R)(e)&&t(e)})).catch((n=>{const t="Error fetching country code: ".concat(String(n));window.guardian.modules.sentry.reportError(new Error(t),e)}))}),[e]),n}},40901:(e,n,t)=>{t.d(n,{L:()=>i});var r=t(67400),o=t(50026);const i=e=>{const[n,t]=(0,r.useState)();return(0,r.useEffect)((()=>{(0,o.V5)(e).then((e=>{let{pageViewId:n}=e;t(n)})).catch((()=>{t("no-page-view-id-available")}))}),[e]),n}}}]);
//# sourceMappingURL=TopBarSupport-importable.client.web.1b6f212bc80d512131f4.js.map