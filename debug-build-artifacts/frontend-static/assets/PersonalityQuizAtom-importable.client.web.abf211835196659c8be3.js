"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[729],{1413:(t,e,n)=>{n.r(e),n.d(e,{MissingAnswers:()=>N,PersonalityQuizAtom:()=>z,Result:()=>I,findMostReferredToBucketId:()=>C});var s=n(50484),r=n(24017),i=n(9474),o=n(7351),c=n(77907),l=n(96378),u=n(27123),d=n(69913),a=n(90789),f=n(67400),b=n(16632),p=n(73443),m=n(40562);function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function x(){const t=g(["\n\tmargin-bottom: 12px;\n\tborder: 0px;\n\tpadding: 0px;\n\t",";\n\n\tlabel {\n\t\twidth: inherit;\n\t}\n"]);return x=function(){return t},t}function j(){const t=g(["\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\tbutton {\n\t\t\t\t\t\tmargin-right: 10px;\n\t\t\t\t\t}\n\t\t\t\t"]);return j=function(){return t},t}function w(){const t=g(["\n\t\t\t\t\t\tmargin-bottom: 12px;\n\t\t\t\t\t"]);return w=function(){return t},t}function y(){const t=g(["\n\t\t\t\t\t\t\tpadding-right: 12px;\n\t\t\t\t\t\t"]);return y=function(){return t},t}function k(){const t=g(["\n\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t"]);return k=function(){return t},t}function O(){const t=g(["\n\t\t\t\t\tlabel {\n\t\t\t\t\t\t:hover {\n\t\t\t\t\t\t\tbackground-color: ",";\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/* TODO: apply same styles on focus (requires source update) */\n\t\t\t\t\t}\n\t\t\t\t"]);return O=function(){return t},t}function v(){const t=g(["\n\t","\n\tpadding-bottom: ","px;\n\tcolor: ",";\n"]);return v=function(){return t},t}function A(){const t=g(["\n\tbackground-color: ",";\n\tmargin-top: ","px;\n\tmargin-bottom: ","px;\n\tpadding: ","px;\n"]);return A=function(){return t},t}function S(){const t=g(["\n\t","\n\tcolor: ",";\n\tpadding-bottom: ","px;\n"]);return S=function(){return t},t}function q(){const t=g(["\n\t","\n\tcolor: ",";\n"]);return q=function(){return t},t}const P=t=>(0,r.css)(x(),t===b.A$.Labs?o.NA0:o.Ni),C=t=>{let{selectedGlobalAnswers:e,questions:n}=t;const s={},r=Object.keys(e).map((t=>{const s=n.find((e=>e.id===t)),r=e[t];return null==s?void 0:s.answers.find((t=>t.id===r))})).filter((t=>!(0,i.b)(t)));for(const t of r)for(const e of t.answerBuckets)"number"==typeof s[e]?s[e]+=1:s[e]=1;let o;for(const t of Object.keys(s)){if(!o){o=t;continue}const e=s[t],n=s[o];(0,i.b)(e)||(0,i.b)(n)||(o=e>n?t:o)}return o},z=t=>{let{id:e,questions:n,resultBuckets:i,sharingUrls:o,theme:c}=t;const[l,d]=(0,f.useState)({}),[a,b]=(0,f.useState)(!1),[p,m]=(0,f.useState)(!1),[g,x]=(0,f.useState)(),w=t=>{t.preventDefault(),n.some((t=>!(t.id in l)))?m(!0):b(!0)};return(0,f.useEffect)((()=>{if(a&&Object.keys(l).length){const t=C({selectedGlobalAnswers:l,questions:n});x(i.find((e=>e.id===t)))}else x(null)}),[a,l,x,i,n]),(0,s.jsxs)("form",{"data-atom-id":e,"data-atom-type":"personalityquiz",children:[a&&g&&(0,s.jsx)("div",{"data-testid":"quiz-results-block-top",children:(0,s.jsx)(I,{resultBuckets:g,sharingUrls:o})}),(0,s.jsx)("ol",{"data-ignore":"global-ol-styling",children:n.map(((t,e)=>(0,s.jsx)(D,{id:t.id,questionNumber:e+1,text:t.text,imageUrl:t.imageUrl,imageAlt:t.imageAlt,answers:t.answers,updateSelectedAnswer:e=>{var n,s;m(!1),d((n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),s.forEach((function(e){h(t,e,n[e])}))}return t}({},l),s=null!=(s={[t.id]:e})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n.push.apply(n,s)}return n}(Object(s)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(s,t))})),n))},globallySelectedAnswer:t.id in l?l[t.id]:void 0,hasSubmittedAnswers:a,theme:c},t.id)))}),p&&(0,s.jsx)(N,{}),a&&g&&(0,s.jsx)("div",{"data-testid":"quiz-results-block-bottom",children:(0,s.jsx)(I,{resultBuckets:g,sharingUrls:o})}),(0,s.jsxs)("div",{css:(0,r.css)(j()),children:[(0,s.jsx)(u.$,{type:"submit",onClick:w,onKeyDown:t=>{var e;(null!==(e=32===t.keyCode)&&void 0!==e?e:13===t.keyCode)&&w(t)},"data-testid":"submit-quiz",children:"Submit"}),(0,s.jsx)(u.$,{priority:"secondary",onClick:()=>{d({}),b(!1),x(null)},onKeyDown:t=>{var e;(null!==(e=32===t.keyCode)&&void 0!==e?e:13===t.keyCode)&&(d({}),b(!1),x(null))},"data-testid":"reset-quiz",children:"Reset"})]})]})},D=t=>{let{id:e,questionNumber:n,text:i,imageUrl:o,imageAlt:c,answers:l,updateSelectedAnswer:u,globallySelectedAnswer:d,hasSubmittedAnswers:a,theme:b}=t;const[p,m]=(0,f.useState)();return(0,f.useEffect)((()=>{p&&p!==d&&u(p)}),[u,p,d]),(0,f.useEffect)((()=>{d||m(void 0)}),[d,m]),(0,s.jsx)("li",{css:P(b),children:(0,s.jsxs)("fieldset",{children:[(0,s.jsxs)("legend",{css:(0,r.css)(w()),children:[(0,s.jsx)("span",{css:(0,r.css)(y()),children:"".concat(n,".")}),i]}),!!o&&(0,s.jsx)("img",{css:(0,r.css)(k()),src:o,alt:null!=c?c:""}),(0,s.jsx)(M,{hasSubmittedAnswers:a,questionId:e,answers:l,selectedAnswer:p,setSelectedAnswers:m,theme:b})]})})},M=(0,f.memo)((t=>{let{hasSubmittedAnswers:e,questionId:n,answers:i,selectedAnswer:o,setSelectedAnswers:l,theme:u}=t;return(0,s.jsx)("div",{css:[(0,p.bP)(u),(0,r.css)(O(),e?c.M.neutral[97]:c.M.neutral[86])],children:(0,s.jsx)(d.z,{name:n,children:i.map((t=>(0,s.jsx)(a.s,{value:t.text,label:t.text,"data-testid":t.id,"data-answer-type":o===t.id?"selected-enabled-answer":"unselected-enabled-answer",disabled:e,onChange:()=>l(t.id),checked:o===t.id},t.id)))})})}));M.displayName="AnswersGroup";const U=(0,r.css)(v(),o.keT,l.x[3],c.M.error[500]),N=()=>(0,s.jsx)("div",{css:U,children:"You have not answered all the questions."}),B=(0,r.css)(A(),c.M.neutral[93],l.x[3],l.x[3],l.x[2]),_=(0,r.css)(S(),o.keT,c.M.neutral[20],l.x[1]),E=(0,r.css)(q(),o.NA0,c.M.neutral[46]),I=t=>{let{resultBuckets:e,sharingUrls:n}=t;return(0,s.jsxs)("div",{css:B,children:[(0,s.jsx)("div",{css:_,children:e.title}),(0,s.jsx)("div",{css:E,children:e.description}),(0,s.jsx)("hr",{}),(0,s.jsx)("div",{css:_,children:"Challenge your friends"}),(0,s.jsx)(m.N,{sharingUrls:n,displayIcons:["facebook","twitter","email","whatsApp","messenger","linkedIn","pinterest"]})]})}}}]);
//# sourceMappingURL=PersonalityQuizAtom-importable.client.web.abf211835196659c8be3.js.map